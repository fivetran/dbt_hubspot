{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.14", "generated_at": "2024-05-10T02:39:20.633730Z", "invocation_id": "4e29436a-d25d-492e-a967-5e6519fb1478", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:28.734487Z", "completed_at": "2024-05-10T02:38:30.210981Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:30.215207Z", "completed_at": "2024-05-10T02:38:30.215232Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.712494134902954, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"contact_list_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"added_at\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"contact_list_member_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list_member_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:28.722733Z", "completed_at": "2024-05-10T02:38:30.216616Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:30.219904Z", "completed_at": "2024-05-10T02:38:30.219916Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.714555025100708, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"is_deleted\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:28.665812Z", "completed_at": "2024-05-10T02:38:30.217232Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:30.220470Z", "completed_at": "2024-05-10T02:38:30.220479Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7299599647521973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"name\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"company_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:28.739439Z", "completed_at": "2024-05-10T02:38:30.217849Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:30.220978Z", "completed_at": "2024-05-10T02:38:30.220984Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7274670600891113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"deleteable\",\n  \"dynamic\",\n  \"metadata_error\",\n  \"metadata_last_processing_state_change_at\",\n  \"metadata_last_size_change_at\",\n  \"metadata_processing\",\n  \"metadata_size\",\n  \"offset\",\n  \"portal_id\",\n  \"updated_at\",\n  \"name\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"contact_list_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:30.385317Z", "completed_at": "2024-05-10T02:38:31.684544Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:31.685709Z", "completed_at": "2024-05-10T02:38:31.685725Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4788570404052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"value\",\n  \"source_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"contact_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:30.377900Z", "completed_at": "2024-05-10T02:38:31.731723Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:31.733881Z", "completed_at": "2024-05-10T02:38:31.733893Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.518441915512085, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_merge_audit_tmp", "compiled": true, "compiled_code": "\n\nselect \"canonical_vid\",\n  \"contact_id\",\n  \"vid_to_merge\",\n  \"_fivetran_synced\",\n  \"entity_id\",\n  \"first_name\",\n  \"last_name\",\n  \"num_properties_moved\",\n  \"timestamp\",\n  \"user_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"contact_merge_audit_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_merge_audit_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:30.393574Z", "completed_at": "2024-05-10T02:38:31.731196Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:31.732996Z", "completed_at": "2024-05-10T02:38:31.733015Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5036649703979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_email\",\n  \"id\",\n  \"property_company\",\n  \"property_firstname\",\n  \"property_lastname\",\n  \"property_email_1\",\n  \"property_createdate\",\n  \"property_jobtitle\",\n  \"property_annualrevenue\",\n  \"property_hs_calculated_merged_vids\",\n  \"property_created_at\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:30.397969Z", "completed_at": "2024-05-10T02:38:31.885589Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:31.886705Z", "completed_at": "2024-05-10T02:38:31.886720Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6053171157836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"deal_id\",\n  \"type_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"deal_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:31.901681Z", "completed_at": "2024-05-10T02:38:33.401254Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:33.402339Z", "completed_at": "2024-05-10T02:38:33.402343Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6624319553375244, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"closed_won\",\n  \"display_order\",\n  \"probability\",\n  \"stage_id\",\n  \"label\",\n  \"pipeline_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"deal_pipeline_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:31.912290Z", "completed_at": "2024-05-10T02:38:33.399110Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:33.400483Z", "completed_at": "2024-05-10T02:38:33.400494Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6642601490020752, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"deal_pipeline_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:31.863875Z", "completed_at": "2024-05-10T02:38:33.401562Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:33.402622Z", "completed_at": "2024-05-10T02:38:33.402625Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7096681594848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"deal_id\",\n  \"_fivetran_synced\",\n  \"type_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"deal_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:32.001810Z", "completed_at": "2024-05-10T02:38:33.574209Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:33.589519Z", "completed_at": "2024-05-10T02:38:33.589532Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.796645164489746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"deal_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:33.598732Z", "completed_at": "2024-05-10T02:38:35.248781Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:35.250274Z", "completed_at": "2024-05-10T02:38:35.250294Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.767920732498169, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"content_id\",\n  \"num_included\",\n  \"num_queued\",\n  \"sub_type\",\n  \"type\",\n  \"app_name\",\n  \"name\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_campaign_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:33.577859Z", "completed_at": "2024-05-10T02:38:35.361061Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:35.362522Z", "completed_at": "2024-05-10T02:38:35.362530Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.928792953491211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"deal_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"date_entered\",\n  \"source\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"deal_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:33.590093Z", "completed_at": "2024-05-10T02:38:35.360541Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:35.362134Z", "completed_at": "2024-05-10T02:38:35.362147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.9291279315948486, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"owner_id\",\n  \"deal_pipeline_id\",\n  \"deal_pipeline_stage_id\",\n  \"is_deleted\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:33.800899Z", "completed_at": "2024-05-10T02:38:35.506518Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:35.519474Z", "completed_at": "2024-05-10T02:38:35.519487Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.8681297302246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"category\",\n  \"status\",\n  \"response\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_bounce_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_bounce_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:35.346262Z", "completed_at": "2024-05-10T02:38:36.725044Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:36.726316Z", "completed_at": "2024-05-10T02:38:36.726391Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5674219131469727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"referer\",\n  \"browser\",\n  \"location\",\n  \"ip_address\",\n  \"url\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_click_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_click_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:35.509197Z", "completed_at": "2024-05-10T02:38:36.941057Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:36.947743Z", "completed_at": "2024-05-10T02:38:36.947748Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.554206132888794, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"attempt\",\n  \"response\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_deferred_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_deferred_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:35.520006Z", "completed_at": "2024-05-10T02:38:36.940238Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:36.947294Z", "completed_at": "2024-05-10T02:38:36.947311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7397470474243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"response\",\n  \"smtp_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_delivered_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_delivered_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:35.670411Z", "completed_at": "2024-05-10T02:38:37.041991Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:37.043069Z", "completed_at": "2024-05-10T02:38:37.043079Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5830609798431396, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"drop_reason\",\n  \"bcc\",\n  \"cc\",\n  \"drop_message\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_dropped_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_dropped_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:37.069906Z", "completed_at": "2024-05-10T02:38:38.771484Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:38.772310Z", "completed_at": "2024-05-10T02:38:38.772318Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.8514037132263184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"duration\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_open_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_open_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:36.934538Z", "completed_at": "2024-05-10T02:38:38.765057Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:38.766048Z", "completed_at": "2024-05-10T02:38:38.766061Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.9862070083618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_forward_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_forward_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:37.252478Z", "completed_at": "2024-05-10T02:38:38.931077Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:38.941196Z", "completed_at": "2024-05-10T02:38:38.941208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8083410263061523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_print_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_print_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:37.265132Z", "completed_at": "2024-05-10T02:38:39.159232Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:39.159776Z", "completed_at": "2024-05-10T02:38:39.159784Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.0153329372406006, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bcc\",\n  \"cc\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_sent_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_sent_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:38.935071Z", "completed_at": "2024-05-10T02:38:40.258944Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:40.260243Z", "completed_at": "2024-05-10T02:38:40.260259Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.510439157485962, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"ip_address\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_spam_report_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_spam_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:38.941741Z", "completed_at": "2024-05-10T02:38:40.443580Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:40.447483Z", "completed_at": "2024-05-10T02:38:40.447490Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7092270851135254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bounced\",\n  \"portal_subscription_status\",\n  \"requested_by\",\n  \"source\",\n  \"subscriptions\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_status_change_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_status_change_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:39.062962Z", "completed_at": "2024-05-10T02:38:40.442938Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:40.446885Z", "completed_at": "2024-05-10T02:38:40.446899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5822768211364746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"caused_by_created\",\n  \"caused_by_id\",\n  \"created\",\n  \"email_campaign_id\",\n  \"obsoleted_by_created\",\n  \"obsoleted_by_id\",\n  \"portal_id\",\n  \"sent_by_created\",\n  \"sent_by_id\",\n  \"type\",\n  \"filtered_event\",\n  \"recipient\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"email_event_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:39.281116Z", "completed_at": "2024-05-10T02:38:40.839614Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:40.841118Z", "completed_at": "2024-05-10T02:38:40.841139Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6876559257507324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_timestamp\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_call_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_call_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:40.448037Z", "completed_at": "2024-05-10T02:38:42.086176Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:42.086766Z", "completed_at": "2024-05-10T02:38:42.086782Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7824609279632568, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:40.657521Z", "completed_at": "2024-05-10T02:38:42.176204Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:42.177845Z", "completed_at": "2024-05-10T02:38:42.177862Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.764760971069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:40.648573Z", "completed_at": "2024-05-10T02:38:42.248664Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:42.249744Z", "completed_at": "2024-05-10T02:38:42.249765Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7719979286193848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:40.973267Z", "completed_at": "2024-05-10T02:38:42.557102Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:42.558288Z", "completed_at": "2024-05-10T02:38:42.558307Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7597990036010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_all_owner_ids\",\n  \"property_hs_all_team_ids\",\n  \"property_hs_createdate\",\n  \"property_hs_email_subject\",\n  \"property_hs_email_text\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_modified_by\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_email_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_email_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:42.231024Z", "completed_at": "2024-05-10T02:38:44.247319Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:44.248591Z", "completed_at": "2024-05-10T02:38:44.248614Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.2394042015075684, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_synced\",\n  \"created_from_link_id\",\n  \"end_time\",\n  \"pre_meeting_prospect_reminders\",\n  \"source\",\n  \"source_id\",\n  \"start_time\",\n  \"web_conference_meeting_id\",\n  \"meeting_outcome\",\n  \"body\",\n  \"external_url\",\n  \"title\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_meeting_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_meeting_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:42.434794Z", "completed_at": "2024-05-10T02:38:44.471871Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:44.486052Z", "completed_at": "2024-05-10T02:38:44.486064Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.2918338775634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_object_id\",\n  \"property_hs_task_type\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\",\n  \"task_type\",\n  \"property_hs_engagement_source\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_task_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_task_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:42.421525Z", "completed_at": "2024-05-10T02:38:44.473339Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:44.487072Z", "completed_at": "2024-05-10T02:38:44.487078Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.299574851989746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_body_preview\",\n  \"property_hs_createdate\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_note_body\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_note_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_note_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:42.744336Z", "completed_at": "2024-05-10T02:38:44.910947Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:44.912884Z", "completed_at": "2024-05-10T02:38:44.912907Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.379589080810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"type\",\n  \"_fivetran_synced\",\n  \"portal_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"engagement_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:44.474507Z", "completed_at": "2024-05-10T02:38:45.941307Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:45.944025Z", "completed_at": "2024-05-10T02:38:45.944038Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6152300834655762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__merged_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"merged_deal_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"merged_deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__merged_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:44.720114Z", "completed_at": "2024-05-10T02:38:46.101003Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:46.101974Z", "completed_at": "2024-05-10T02:38:46.101985Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5394129753112793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner_tmp", "compiled": true, "compiled_code": "\n\nselect \"owner_id\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"portal_id\",\n  \"type\",\n  \"updated_at\",\n  \"email\",\n  \"first_name\",\n  \"last_name\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"owner_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__owner_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:44.733863Z", "completed_at": "2024-05-10T02:38:46.085494Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:46.087677Z", "completed_at": "2024-05-10T02:38:46.087695Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5271241664886475, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option_tmp", "compiled": true, "compiled_code": "\n\nselect \"label\",\n  \"property_id\",\n  \"_fivetran_synced\",\n  \"display_order\",\n  \"hidden\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"property_option_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property_option_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:45.124660Z", "completed_at": "2024-05-10T02:38:46.406427Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:46.407658Z", "completed_at": "2024-05-10T02:38:46.407677Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.430001974105835, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_id\",\n  \"_fivetran_synced\",\n  \"calculated\",\n  \"created_at\",\n  \"description\",\n  \"field_type\",\n  \"group_name\",\n  \"hubspot_defined\",\n  \"hubspot_object\",\n  \"label\",\n  \"name\",\n  \"show_currency_symbol\",\n  \"type\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"property_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:46.089666Z", "completed_at": "2024-05-10T02:38:47.543543Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:47.545435Z", "completed_at": "2024-05-10T02:38:47.545460Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5992848873138428, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"company_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"ticket_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:46.265961Z", "completed_at": "2024-05-10T02:38:47.708795Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:47.710617Z", "completed_at": "2024-05-10T02:38:47.710629Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.579563856124878, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"contact_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"ticket_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:46.272278Z", "completed_at": "2024-05-10T02:38:47.709273Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:47.711090Z", "completed_at": "2024-05-10T02:38:47.711096Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5864088535308838, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"engagement_id\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"ticket_engagement_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:46.555855Z", "completed_at": "2024-05-10T02:38:48.011215Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.012537Z", "completed_at": "2024-05-10T02:38:48.012560Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5861942768096924, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"stage_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"is_closed\",\n  \"label\",\n  \"pipeline_id\",\n  \"ticket_state\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"ticket_pipeline_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.143113Z", "completed_at": "2024-05-10T02:38:48.145611Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.147116Z", "completed_at": "2024-05-10T02:38:48.147130Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0063817501068115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.151104Z", "completed_at": "2024-05-10T02:38:48.154423Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.155392Z", "completed_at": "2024-05-10T02:38:48.155401Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006478071212768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.158593Z", "completed_at": "2024-05-10T02:38:48.160027Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.160739Z", "completed_at": "2024-05-10T02:38:48.160744Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00409388542175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.163466Z", "completed_at": "2024-05-10T02:38:48.165494Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.166269Z", "completed_at": "2024-05-10T02:38:48.166278Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0046579837799072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.169254Z", "completed_at": "2024-05-10T02:38:48.171094Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.171933Z", "completed_at": "2024-05-10T02:38:48.171941Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004669904708862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_member_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.174600Z", "completed_at": "2024-05-10T02:38:48.176270Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.176995Z", "completed_at": "2024-05-10T02:38:48.177002Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003970146179199219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_merge_audit_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.179359Z", "completed_at": "2024-05-10T02:38:48.181682Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.182311Z", "completed_at": "2024-05-10T02:38:48.182317Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004456043243408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.184703Z", "completed_at": "2024-05-10T02:38:48.186395Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.187189Z", "completed_at": "2024-05-10T02:38:48.187196Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004117012023925781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.189654Z", "completed_at": "2024-05-10T02:38:48.190983Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.191544Z", "completed_at": "2024-05-10T02:38:48.191550Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0034821033477783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.193981Z", "completed_at": "2024-05-10T02:38:48.195438Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.196169Z", "completed_at": "2024-05-10T02:38:48.196177Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003985881805419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.198226Z", "completed_at": "2024-05-10T02:38:48.199518Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.200187Z", "completed_at": "2024-05-10T02:38:48.200199Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0035028457641601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.202645Z", "completed_at": "2024-05-10T02:38:48.203944Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.204526Z", "completed_at": "2024-05-10T02:38:48.204532Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004058837890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.207308Z", "completed_at": "2024-05-10T02:38:48.255783Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.256411Z", "completed_at": "2024-05-10T02:38:48.256417Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05030393600463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.258151Z", "completed_at": "2024-05-10T02:38:48.259269Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.259743Z", "completed_at": "2024-05-10T02:38:48.259748Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0027778148651123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.261199Z", "completed_at": "2024-05-10T02:38:48.262183Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.262597Z", "completed_at": "2024-05-10T02:38:48.262601Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002285003662109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_campaign_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.263974Z", "completed_at": "2024-05-10T02:38:48.264936Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.265381Z", "completed_at": "2024-05-10T02:38:48.265385Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0024271011352539062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_bounce_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.267007Z", "completed_at": "2024-05-10T02:38:48.268097Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.268607Z", "completed_at": "2024-05-10T02:38:48.268612Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0025479793548583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_click_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.270106Z", "completed_at": "2024-05-10T02:38:48.271950Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.272450Z", "completed_at": "2024-05-10T02:38:48.272455Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0033750534057617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.273917Z", "completed_at": "2024-05-10T02:38:48.274955Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.275544Z", "completed_at": "2024-05-10T02:38:48.275550Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002630949020385742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_deferred_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.277215Z", "completed_at": "2024-05-10T02:38:48.278303Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.278746Z", "completed_at": "2024-05-10T02:38:48.278751Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002458810806274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_delivered_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.280365Z", "completed_at": "2024-05-10T02:38:48.281469Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.281967Z", "completed_at": "2024-05-10T02:38:48.281972Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0029332637786865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_dropped_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.283842Z", "completed_at": "2024-05-10T02:38:48.284900Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.285321Z", "completed_at": "2024-05-10T02:38:48.285325Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0024161338806152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_forward_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.286667Z", "completed_at": "2024-05-10T02:38:48.287689Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.288122Z", "completed_at": "2024-05-10T02:38:48.288127Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0023119449615478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_open_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.290484Z", "completed_at": "2024-05-10T02:38:48.291509Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.292015Z", "completed_at": "2024-05-10T02:38:48.292019Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002502918243408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_print_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.293428Z", "completed_at": "2024-05-10T02:38:48.294362Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.294777Z", "completed_at": "2024-05-10T02:38:48.294781Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0022389888763427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_sent_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.296417Z", "completed_at": "2024-05-10T02:38:48.297473Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.297950Z", "completed_at": "2024-05-10T02:38:48.297954Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0025169849395751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_spam_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.299561Z", "completed_at": "2024-05-10T02:38:48.300675Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.301162Z", "completed_at": "2024-05-10T02:38:48.301166Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002630949020385742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_status_change_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.302896Z", "completed_at": "2024-05-10T02:38:48.303918Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.304354Z", "completed_at": "2024-05-10T02:38:48.304358Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002613067626953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_call_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.305787Z", "completed_at": "2024-05-10T02:38:48.307684Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.308166Z", "completed_at": "2024-05-10T02:38:48.308171Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0033380985260009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.309532Z", "completed_at": "2024-05-10T02:38:48.310477Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.310879Z", "completed_at": "2024-05-10T02:38:48.310884Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0022029876708984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.312217Z", "completed_at": "2024-05-10T02:38:48.313168Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.313597Z", "completed_at": "2024-05-10T02:38:48.313601Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0023250579833984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.315172Z", "completed_at": "2024-05-10T02:38:48.316181Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.316601Z", "completed_at": "2024-05-10T02:38:48.316605Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0023071765899658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.317889Z", "completed_at": "2024-05-10T02:38:48.318839Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.319246Z", "completed_at": "2024-05-10T02:38:48.319250Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0022230148315429688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.320669Z", "completed_at": "2024-05-10T02:38:48.322371Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.322798Z", "completed_at": "2024-05-10T02:38:48.322803Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0030281543731689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_meeting_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.324298Z", "completed_at": "2024-05-10T02:38:48.325350Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.325786Z", "completed_at": "2024-05-10T02:38:48.325792Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0024831295013427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_note_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.327115Z", "completed_at": "2024-05-10T02:38:48.328051Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.328457Z", "completed_at": "2024-05-10T02:38:48.328460Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0021789073944091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_task_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.329970Z", "completed_at": "2024-05-10T02:38:48.330915Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.331342Z", "completed_at": "2024-05-10T02:38:48.331346Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0023720264434814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.merged_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.332651Z", "completed_at": "2024-05-10T02:38:48.333586Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.333983Z", "completed_at": "2024-05-10T02:38:48.333986Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0021581649780273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.owner_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.335267Z", "completed_at": "2024-05-10T02:38:48.336216Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.336756Z", "completed_at": "2024-05-10T02:38:48.336760Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0023648738861083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.338123Z", "completed_at": "2024-05-10T02:38:48.339922Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.340365Z", "completed_at": "2024-05-10T02:38:48.340369Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003104686737060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_option_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.341823Z", "completed_at": "2024-05-10T02:38:48.342859Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.343334Z", "completed_at": "2024-05-10T02:38:48.343339Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002398967742919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.344704Z", "completed_at": "2024-05-10T02:38:48.345630Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.346031Z", "completed_at": "2024-05-10T02:38:48.346034Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0021882057189941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.347308Z", "completed_at": "2024-05-10T02:38:48.348223Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.348615Z", "completed_at": "2024-05-10T02:38:48.348619Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002125978469848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.349872Z", "completed_at": "2024-05-10T02:38:48.350790Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.351196Z", "completed_at": "2024-05-10T02:38:48.351200Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0021371841430664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.352469Z", "completed_at": "2024-05-10T02:38:48.354649Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.355323Z", "completed_at": "2024-05-10T02:38:48.355328Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0037660598754882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.356770Z", "completed_at": "2024-05-10T02:38:48.357972Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.358583Z", "completed_at": "2024-05-10T02:38:48.358587Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.002778768539428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.360102Z", "completed_at": "2024-05-10T02:38:48.361127Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.361555Z", "completed_at": "2024-05-10T02:38:48.361559Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0023717880249023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.362864Z", "completed_at": "2024-05-10T02:38:48.363819Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:48.364222Z", "completed_at": "2024-05-10T02:38:48.364226Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0022127628326416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:47.690504Z", "completed_at": "2024-05-10T02:38:49.295154Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:49.296879Z", "completed_at": "2024-05-10T02:38:49.296899Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.8106639385223389, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"object_type_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"ticket_pipeline_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:47.850716Z", "completed_at": "2024-05-10T02:38:49.457223Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:49.458857Z", "completed_at": "2024-05-10T02:38:49.458868Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8189072608947754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"name\",\n  \"ticket_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"timestamp_instant\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"ticket_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:47.866957Z", "completed_at": "2024-05-10T02:38:49.457811Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:49.459204Z", "completed_at": "2024-05-10T02:38:49.459208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8029892444610596, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"id\",\n  \"is_deleted\",\n  \"property_closed_date\",\n  \"property_createdate\",\n  \"property_first_agent_reply_date\",\n  \"property_hs_pipeline\",\n  \"property_hs_pipeline_stage\",\n  \"property_hs_ticket_category\",\n  \"property_hs_ticket_priority\",\n  \"property_hubspot_owner_id\",\n  \"property_subject\",\n  \"property_content\"\nfrom \"postgres\".\"hubspot_integration_tests_56\".\"ticket_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:48.365584Z", "completed_at": "2024-05-10T02:38:49.815309Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:49.816265Z", "completed_at": "2024-05-10T02:38:49.816279Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5413837432861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list_member_tmp\" \n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    added_at\n    \n as \n    \n    added_at\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    contact_list_id\n    \n as \n    \n    contact_list_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_member_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(added_at as timestamp) as added_timestamp,\n        contact_id,\n        contact_list_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list_member\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:49.504051Z", "completed_at": "2024-05-10T02:38:50.962778Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:50.963283Z", "completed_at": "2024-05-10T02:38:50.963296Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.615534782409668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    id\n    \n as company_id , \n    \n    \n    is_deleted\n    \n as is_company_deleted , \n    cast(null as TEXT) as company_name , \n    cast(null as TEXT) as description , \n    cast(null as timestamp) as created_date , \n    cast(null as TEXT) as industry , \n    cast(null as TEXT) as street_address , \n    cast(null as TEXT) as street_address_2 , \n    cast(null as TEXT) as city , \n    cast(null as TEXT) as state , \n    cast(null as TEXT) as country , \n    cast(null as integer) as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_company_columns.sql macro\n        company_id,\n        is_company_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_name,\n        description,\n        created_date,\n        industry,\n        street_address,\n        street_address_2,\n        city,\n        state,\n        country,\n        company_annual_revenue\n        \n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__company_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:49.680701Z", "completed_at": "2024-05-10T02:38:51.056881Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:51.057932Z", "completed_at": "2024-05-10T02:38:51.057945Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.544156789779663, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    deleteable\n    \n as \n    \n    deleteable\n    \n, \n    \n    \n    dynamic\n    \n as \n    \n    dynamic\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metadata_error\n    \n as \n    \n    metadata_error\n    \n, \n    \n    \n    metadata_last_processing_state_change_at\n    \n as \n    \n    metadata_last_processing_state_change_at\n    \n, \n    \n    \n    metadata_last_size_change_at\n    \n as \n    \n    metadata_last_size_change_at\n    \n, \n    \n    \n    metadata_processing\n    \n as \n    \n    metadata_processing\n    \n, \n    \n    \n    metadata_size\n    \n as \n    \n    metadata_size\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        deleteable as is_deletable,\n        dynamic as is_dynamic,\n        id as contact_list_id,\n        metadata_error,\n        cast(metadata_last_processing_state_change_at as timestamp) as metadata_last_processing_state_change_at,\n        cast(metadata_last_size_change_at as timestamp) as metadata_last_size_change_at,\n        metadata_processing,\n        metadata_size,\n        name as contact_list_name,\n        portal_id,\n        cast(updated_at as timestamp) as updated_timestamp\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:49.672637Z", "completed_at": "2024-05-10T02:38:51.144895Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:51.145914Z", "completed_at": "2024-05-10T02:38:51.145926Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5924501419067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_company_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:49.908201Z", "completed_at": "2024-05-10T02:38:51.244133Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:51.244953Z", "completed_at": "2024-05-10T02:38:51.244965Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5168671607971191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        contact_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_contact_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:51.121661Z", "completed_at": "2024-05-10T02:38:52.734276Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:52.735500Z", "completed_at": "2024-05-10T02:38:52.735521Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.8412721157073975, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_merge_audit", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_merge_audit_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    canonical_vid\n    \n as \n    \n    canonical_vid\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    entity_id\n    \n as \n    \n    entity_id\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    num_properties_moved\n    \n as \n    \n    num_properties_moved\n    \n, \n    \n    \n    timestamp\n    \n as \n    \n    timestamp\n    \n, \n    \n    \n    user_id\n    \n as \n    \n    user_id\n    \n, \n    \n    \n    vid_to_merge\n    \n as \n    \n    vid_to_merge\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        canonical_vid,\n        contact_id,\n        entity_id,\n        first_name,\n        last_name,\n        num_properties_moved,\n        cast( \n        timestamp\n        as timestamp) as timestamp_at,\n        user_id,\n        vid_to_merge,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_merge_audit\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:51.427006Z", "completed_at": "2024-05-10T02:38:52.941592Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:52.943472Z", "completed_at": "2024-05-10T02:38:52.943479Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6745052337646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    closed_won\n    \n as \n    \n    closed_won\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    probability\n    \n as \n    \n    probability\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        closed_won as is_closed_won,\n        display_order,\n        label as pipeline_stage_label,\n        pipeline_id as deal_pipeline_id,\n        probability,\n        cast(stage_id as TEXT) as deal_pipeline_stage_id,\n        created_at as deal_pipeline_stage_created_at,\n        updated_at as deal_pipeline_stage_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:51.264724Z", "completed_at": "2024-05-10T02:38:52.940410Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:52.942151Z", "completed_at": "2024-05-10T02:38:52.942167Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8513247966766357, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_company_tmp\"\n\n), macro as (\n\n    select \n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        company_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:51.218639Z", "completed_at": "2024-05-10T02:38:52.969319Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:52.970874Z", "completed_at": "2024-05-10T02:38:52.970883Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.899785041809082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as is_contact_deleted , \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as contact_id , \n    \n    \n    property_hs_calculated_merged_vids\n    \n as calculated_merged_vids , \n    \n    \n    property_email\n    \n as email , \n    \n    \n    property_company\n    \n as contact_company , \n    \n    \n    property_firstname\n    \n as first_name , \n    \n    \n    property_lastname\n    \n as last_name , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_jobtitle\n    \n as job_title , \n    \n    \n    property_annualrevenue\n    \n as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns.\n        -- a few columns below are aliased within the macros/get_contact_columns.sql macro\n        contact_id,\n        is_contact_deleted,\n        calculated_merged_vids, -- will be null for BigQuery users until v3 api is rolled out to them\n        email,\n        contact_company,\n        first_name,\n        last_name,\n        cast(created_date as timestamp) as created_date,\n        job_title,\n        company_annual_revenue,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n\n        --The below macro adds the fields defined within your hubspot__contact_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__contact_calculated_fields variable.\n        \n\n\n\n    from macro\n    \n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:52.963504Z", "completed_at": "2024-05-10T02:38:54.839110Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:54.840455Z", "completed_at": "2024-05-10T02:38:54.840472Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.124481201171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        cast(pipeline_id as TEXT) as deal_pipeline_id,\n        created_at as deal_pipeline_created_at,\n        updated_at as deal_pipeline_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:53.130295Z", "completed_at": "2024-05-10T02:38:55.093826Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:55.095252Z", "completed_at": "2024-05-10T02:38:55.095255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.150716781616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_campaign_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    content_id\n    \n as \n    \n    content_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    num_included\n    \n as \n    \n    num_included\n    \n, \n    \n    \n    num_queued\n    \n as \n    \n    num_queued\n    \n, \n    \n    \n    sub_type\n    \n as \n    \n    sub_type\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        app_name,\n        content_id,\n        id as email_campaign_id,\n        name as email_campaign_name,\n        num_included,\n        num_queued,\n        sub_type as email_campaign_sub_type,\n        subject as email_campaign_subject,\n        type as email_campaign_type\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:53.119984Z", "completed_at": "2024-05-10T02:38:55.093485Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:55.094996Z", "completed_at": "2024-05-10T02:38:55.095004Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.1538171768188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_deal_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:53.103497Z", "completed_at": "2024-05-10T02:38:55.094113Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:55.095514Z", "completed_at": "2024-05-10T02:38:55.095518Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.1699488162994385, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_contact_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        contact_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:55.088484Z", "completed_at": "2024-05-10T02:38:56.428848Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:56.430090Z", "completed_at": "2024-05-10T02:38:56.430111Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5244169235229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_active\n    \n as \n    \n    _fivetran_active\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    date_entered\n    \n as \n    \n    date_entered\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date_entered as timestamp) as date_entered,\n        deal_id,\n        source,\n        source_id,\n        value as deal_stage_name,\n        _fivetran_active,\n        cast(_fivetran_end as timestamp) as _fivetran_end,\n        cast(_fivetran_start as timestamp) as _fivetran_start\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:55.278645Z", "completed_at": "2024-05-10T02:38:57.041407Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:57.043227Z", "completed_at": "2024-05-10T02:38:57.043247Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8627550601959229, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    deal_pipeline_id\n    \n as \n    \n    deal_pipeline_id\n    \n, \n    \n    \n    deal_pipeline_stage_id\n    \n as \n    \n    deal_pipeline_stage_id\n    \n, \n    \n    \n    is_deleted\n    \n as is_deal_deleted , \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    cast(null as integer) as \n    \n    portal_id\n    \n , \n    cast(null as TEXT) as deal_name , \n    cast(null as TEXT) as description , \n    cast(null as integer) as amount , \n    cast(null as timestamp) as closed_date , \n    cast(null as timestamp) as created_date \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_deal_columns.sql macro\n        deal_name,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        is_deal_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        cast(deal_pipeline_id as TEXT) as deal_pipeline_id,\n        cast(deal_pipeline_stage_id as TEXT) as deal_pipeline_stage_id,\n        owner_id,\n        portal_id,\n        description,\n        amount\n\n        --The below macro adds the fields defined within your hubspot__deal_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__deal_calculated_fields variable.\n        \n\n\n\n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:55.298441Z", "completed_at": "2024-05-10T02:38:57.043792Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:57.045675Z", "completed_at": "2024-05-10T02:38:57.045680Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.8769521713256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_click_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    referer\n    \n as \n    \n    referer\n    \n, \n    \n    \n    url\n    \n as \n    \n    url\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        referer as referer_url,\n        url as click_url,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_click\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:55.291168Z", "completed_at": "2024-05-10T02:38:57.041910Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:57.044217Z", "completed_at": "2024-05-10T02:38:57.044224Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8795101642608643, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_bounce_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    category\n    \n as \n    \n    category\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n    from base\n    \n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        category as bounce_category,\n        id as event_id,\n        response as returned_response,\n        status as returned_status\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:56.624513Z", "completed_at": "2024-05-10T02:38:58.353598Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:58.354727Z", "completed_at": "2024-05-10T02:38:58.354748Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.9087200164794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_deferred_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    attempt\n    \n as \n    \n    attempt\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        attempt as attempt_number,\n        id as event_id,\n        response as returned_response\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:57.160181Z", "completed_at": "2024-05-10T02:38:59.121627Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:59.123735Z", "completed_at": "2024-05-10T02:38:59.123751Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.1381959915161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_dropped_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    drop_message\n    \n as \n    \n    drop_message\n    \n, \n    \n    \n    drop_reason\n    \n as \n    \n    drop_reason\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        drop_message,\n        drop_reason,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_dropped_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:57.141627Z", "completed_at": "2024-05-10T02:38:58.909214Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:58.909983Z", "completed_at": "2024-05-10T02:38:58.909999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.1645259857177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_delivered_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    smtp_id\n    \n as \n    \n    smtp_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        response as returned_response,\n        smtp_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:57.168762Z", "completed_at": "2024-05-10T02:38:59.122190Z"}, {"name": "execute", "started_at": "2024-05-10T02:38:59.124263Z", "completed_at": "2024-05-10T02:38:59.124270Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.148129940032959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_open_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    duration\n    \n as \n    \n    duration\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        duration as duration_open,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_open\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:58.538776Z", "completed_at": "2024-05-10T02:39:00.509812Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:00.510822Z", "completed_at": "2024-05-10T02:39:00.510843Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.1103079319000244, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_forward_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:59.322293Z", "completed_at": "2024-05-10T02:39:00.669675Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:00.670454Z", "completed_at": "2024-05-10T02:39:00.670465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5166370868682861, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_sent_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_sent_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:59.309671Z", "completed_at": "2024-05-10T02:39:00.850205Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:00.852098Z", "completed_at": "2024-05-10T02:39:00.852115Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6838977336883545, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_print_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:38:59.331610Z", "completed_at": "2024-05-10T02:39:00.883690Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:00.885050Z", "completed_at": "2024-05-10T02:39:00.885068Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6980810165405273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_spam_report_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        ip_address,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:00.660369Z", "completed_at": "2024-05-10T02:39:02.104191Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:02.105185Z", "completed_at": "2024-05-10T02:39:02.105199Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5996689796447754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_status_change_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bounced\n    \n as \n    \n    bounced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    portal_subscription_status\n    \n as \n    \n    portal_subscription_status\n    \n, \n    \n    \n    requested_by\n    \n as \n    \n    requested_by\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    subscriptions\n    \n as \n    \n    subscriptions\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bounced as is_bounced,\n        id as event_id,\n        portal_subscription_status as subscription_status,\n        requested_by as requested_by_email,\n        source as change_source,\n        subscriptions\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:00.838389Z", "completed_at": "2024-05-10T02:39:02.278128Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:02.279535Z", "completed_at": "2024-05-10T02:39:02.279549Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6911401748657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    caused_by_created\n    \n as \n    \n    caused_by_created\n    \n, \n    \n    \n    caused_by_id\n    \n as \n    \n    caused_by_id\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_campaign_id\n    \n as \n    \n    email_campaign_id\n    \n, \n    \n    \n    filtered_event\n    \n as \n    \n    filtered_event\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    obsoleted_by_created\n    \n as \n    \n    obsoleted_by_created\n    \n, \n    \n    \n    obsoleted_by_id\n    \n as \n    \n    obsoleted_by_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    recipient\n    \n as \n    \n    recipient\n    \n, \n    \n    \n    sent_by_created\n    \n as \n    \n    sent_by_created\n    \n, \n    \n    \n    sent_by_id\n    \n as \n    \n    sent_by_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        cast(caused_by_created as timestamp) as caused_timestamp,\n        caused_by_id as caused_by_event_id,\n        cast(created as timestamp) as created_timestamp,\n        email_campaign_id,\n        filtered_event as is_filtered_event,\n        id as event_id,\n        cast(obsoleted_by_created as timestamp) as obsoleted_timestamp,\n        obsoleted_by_id as obsoleted_by_event_id,\n        portal_id,\n        recipient as recipient_email_address,\n        cast(sent_by_created as timestamp) as sent_timestamp,\n        sent_by_id as sent_by_event_id,\n        type as event_type\n    from macro\n    \n)\n\nselect *\nfrom fields\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:01.021233Z", "completed_at": "2024-05-10T02:39:02.561115Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:02.563083Z", "completed_at": "2024-05-10T02:39:02.563090Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7529208660125732, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_company_tmp\"\n\n), macro as (\n\n    select \n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:00.993193Z", "completed_at": "2024-05-10T02:39:02.558474Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:02.561813Z", "completed_at": "2024-05-10T02:39:02.561824Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7825751304626465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_call_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_call\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:02.268670Z", "completed_at": "2024-05-10T02:39:03.900195Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:03.901710Z", "completed_at": "2024-05-10T02:39:03.901728Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.744446039199829, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_deal_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:02.779329Z", "completed_at": "2024-05-10T02:39:04.756658Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:04.758797Z", "completed_at": "2024-05-10T02:39:04.758809Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.322031021118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_email_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_all_owner_ids\" as all_owner_ids\n        , \"property_hs_all_team_ids\" as all_team_ids\n        , \"property_hs_email_subject\" as email_subject\n        , \"property_hs_email_text\" as email_text\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_modified_by\" as modified_by\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_email\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:02.792367Z", "completed_at": "2024-05-10T02:39:04.757232Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:04.759472Z", "completed_at": "2024-05-10T02:39:04.759477Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.339768171310425, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_meeting_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n , \n    cast(null as TEXT) as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    cast(null as timestamp) as created_timestamp , \n    cast(null as timestamp) as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"created_from_link_id\"\n        , \"end_time\"\n        , \"pre_meeting_prospect_reminders\"\n        , \"source\"\n        , \"source_id\"\n        , \"start_time\"\n        , \"web_conference_meeting_id\"\n        , \"meeting_outcome\"\n        , \"body\"\n        , \"external_url\"\n        , \"title\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_meeting\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:02.552614Z", "completed_at": "2024-05-10T02:39:04.758061Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:04.760155Z", "completed_at": "2024-05-10T02:39:04.760159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5570662021636963, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:04.014504Z", "completed_at": "2024-05-10T02:39:06.589493Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:06.590438Z", "completed_at": "2024-05-10T02:39:06.590449Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.693061113357544, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_task_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        , \"property_hs_task_type\" as task_type\n        \n        \n        \n\n        \n        \n        , \"property_hs_object_id\" as object_id\n        , \"property_hs_engagement_source\" as engagement_source\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_task\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:05.380196Z", "completed_at": "2024-05-10T02:39:07.243468Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:07.244878Z", "completed_at": "2024-05-10T02:39:07.244882Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.103292942047119, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__merged_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__merged_deal_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    merged_deal_id\n    \n as \n    \n    merged_deal_id\n    \n\n\n\n    from base\n\n), fields as (\n    \n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        merged_deal_id\n    from macro\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__merged_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:05.120182Z", "completed_at": "2024-05-10T02:39:07.242960Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:07.244521Z", "completed_at": "2024-05-10T02:39:07.244527Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.2542877197265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_note_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    cast(null as TEXT) as note , \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_body_preview\" as body_preview\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_note_body\" as note_body\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_note\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:05.275589Z", "completed_at": "2024-05-10T02:39:07.241041Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:07.241966Z", "completed_at": "2024-05-10T02:39:07.241988Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.1249098777770996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as is_active , \n    cast(null as timestamp) as created_timestamp , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as integer) as \n    \n    owner_id\n    \n , \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    cast(null as timestamp) as occurred_timestamp , \n    \n    \n    type\n    \n as engagement_type \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as engagement_id,\n        created_timestamp,\n        owner_id,\n        occurred_timestamp,\n        portal_id,\n        engagement_type,\n        is_active\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:06.709414Z", "completed_at": "2024-05-10T02:39:08.190975Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:08.192062Z", "completed_at": "2024-05-10T02:39:08.192076Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7291889190673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__owner_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        email as email_address,\n        first_name,\n        last_name,\n        owner_id,\n        portal_id,\n        type as owner_type,\n        cast(updated_at as timestamp) as updated_timestamp,\n        trim( first_name || ' ' || last_name ) as full_name\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__owner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:07.380054Z", "completed_at": "2024-05-10T02:39:09.134782Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:09.136360Z", "completed_at": "2024-05-10T02:39:09.136381Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.0604162216186523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_company_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:07.367474Z", "completed_at": "2024-05-10T02:39:09.446303Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:09.454295Z", "completed_at": "2024-05-10T02:39:09.454310Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.2243528366088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property_option_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    property_id\n    \n as \n    \n    property_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    hidden\n    \n as \n    \n    hidden\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        label as property_option_label,\t\n        property_id,\n        _fivetran_synced,\n        display_order,\n        hidden,\n        value as property_option_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property_option\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:07.373449Z", "completed_at": "2024-05-10T02:39:09.447000Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:09.455003Z", "completed_at": "2024-05-10T02:39:09.455008Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.2216720581054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    calculated\n    \n as \n    \n    calculated\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    field_type\n    \n as \n    \n    field_type\n    \n, \n    \n    \n    group_name\n    \n as \n    \n    group_name\n    \n, \n    \n    \n    hubspot_defined\n    \n as \n    \n    hubspot_defined\n    \n, \n    \n    \n    hubspot_object\n    \n as \n    \n    hubspot_object\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    show_currency_symbol\n    \n as \n    \n    show_currency_symbol\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_id,\n        _fivetran_synced,\n        calculated,\n        created_at,\n        description,\n        field_type,\n        group_name,\n        hubspot_defined,\n        hubspot_object,\n        label as property_label,\n        name as property_name,\n        type as property_type,\n        updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:08.445620Z", "completed_at": "2024-05-10T02:39:10.250961Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:10.252137Z", "completed_at": "2024-05-10T02:39:10.252153Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.973646879196167, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:09.447628Z", "completed_at": "2024-05-10T02:39:11.303946Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.305257Z", "completed_at": "2024-05-10T02:39:11.305275Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.08115291595459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_engagement_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:09.600626Z", "completed_at": "2024-05-10T02:39:11.437846Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.439830Z", "completed_at": "2024-05-10T02:39:11.439863Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.0465431213378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    object_type_id\n    \n as \n    \n    object_type_id\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        _fivetran_deleted as is_ticket_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        object_type_id,\n        created_at as ticket_pipeline_created_at,\n        updated_at as ticket_pipeline_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:09.590209Z", "completed_at": "2024-05-10T02:39:11.438448Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.440290Z", "completed_at": "2024-05-10T02:39:11.440297Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.0494320392608643, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    is_closed\n    \n as \n    \n    is_closed\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    ticket_state\n    \n as \n    \n    ticket_state\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        _fivetran_deleted as is_ticket_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        is_closed,\n        label as pipeline_stage_label,\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        cast(stage_id as integer ) as ticket_pipeline_stage_id,\n        ticket_state,\n        created_at as ticket_pipeline_stage_created_at,\n        updated_at as ticket_pipeline_stage_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.642530Z", "completed_at": "2024-05-10T02:39:11.667675Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.668763Z", "completed_at": "2024-05-10T02:39:11.668775Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03092503547668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__company_company_id.0d0a080d43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.660083Z", "completed_at": "2024-05-10T02:39:11.669176Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.671422Z", "completed_at": "2024-05-10T02:39:11.671428Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030974864959716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__company_company_id.394a2a4ba0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company\"\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.674112Z", "completed_at": "2024-05-10T02:39:11.684037Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.684718Z", "completed_at": "2024-05-10T02:39:11.684727Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013516902923583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_list_contact_list_id.ff8e4cc29a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.679958Z", "completed_at": "2024-05-10T02:39:11.686673Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.696917Z", "completed_at": "2024-05-10T02:39:11.696926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018703937530517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_list_contact_list_id.036739c1b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.687644Z", "completed_at": "2024-05-10T02:39:11.704286Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.705089Z", "completed_at": "2024-05-10T02:39:11.705097Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019459009170532227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__company_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company_property_history\"\n\n), windows as (\n\n    select\n        company_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by company_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(company_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__company_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.698976Z", "completed_at": "2024-05-10T02:39:11.706253Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.707448Z", "completed_at": "2024-05-10T02:39:11.707456Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012804031372070312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_property_history\"\n\n), windows as (\n\n    select\n        contact_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by contact_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(contact_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contact_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.707686Z", "completed_at": "2024-05-10T02:39:11.712277Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.715374Z", "completed_at": "2024-05-10T02:39:11.715379Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009204864501953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.d53656553e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_stage_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.712518Z", "completed_at": "2024-05-10T02:39:11.716304Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.717313Z", "completed_at": "2024-05-10T02:39:11.717317Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011986017227172852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.ba90fa6113", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is not null\ngroup by deal_pipeline_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.717560Z", "completed_at": "2024-05-10T02:39:11.728540Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.729054Z", "completed_at": "2024-05-10T02:39:11.729059Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01287984848022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_company_company_id__deal_id__type_id.59d48f3923", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, deal_id, type_id\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_company\"\n    group by company_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.724949Z", "completed_at": "2024-05-10T02:39:11.729918Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.730946Z", "completed_at": "2024-05-10T02:39:11.730949Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010374069213867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__contact_merge_adjust", "compiled": true, "compiled_code": "\n\nwith contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact\"\n), contact_merge_audit as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_merge_audit\"\n\n\n), contact_merge_removal as (\n    select \n        contacts.*\n    from contacts\n    \n    left join contact_merge_audit\n        on cast(contacts.contact_id as TEXT) = cast(contact_merge_audit.vid_to_merge as TEXT)\n    \n    where contact_merge_audit.vid_to_merge is null\n)\n\nselect *\nfrom contact_merge_removal", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.731170Z", "completed_at": "2024-05-10T02:39:11.736099Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.739196Z", "completed_at": "2024-05-10T02:39:11.739204Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009454727172851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_contact_id.9f112f8944", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.736340Z", "completed_at": "2024-05-10T02:39:11.740175Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.741190Z", "completed_at": "2024-05-10T02:39:11.741194Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009108781814575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_contact_id.b9135eb03a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact\"\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.741431Z", "completed_at": "2024-05-10T02:39:11.748938Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.749484Z", "completed_at": "2024-05-10T02:39:11.749490Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009483098983764648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_deal_pipeline_id.8a0e3cd7a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.746131Z", "completed_at": "2024-05-10T02:39:11.750374Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.751416Z", "completed_at": "2024-05-10T02:39:11.751420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01025700569152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_deal_pipeline_id.dff6c45403", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is not null\ngroup by deal_pipeline_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.751652Z", "completed_at": "2024-05-10T02:39:11.757166Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.760519Z", "completed_at": "2024-05-10T02:39:11.760525Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010290145874023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_campaign_email_campaign_id.79921899a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.757459Z", "completed_at": "2024-05-10T02:39:11.761611Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.762752Z", "completed_at": "2024-05-10T02:39:11.762756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010352849960327148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_campaign_email_campaign_id.9820d33f2e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.762995Z", "completed_at": "2024-05-10T02:39:11.771105Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.771572Z", "completed_at": "2024-05-10T02:39:11.771577Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0100250244140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_property_history\"\n\n), windows as (\n\n    select\n        deal_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by deal_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(deal_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deal_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.768104Z", "completed_at": "2024-05-10T02:39:11.772432Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.773519Z", "completed_at": "2024-05-10T02:39:11.773523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00894474983215332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_contact_contact_id__deal_id__type_id.37de71798b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, deal_id, type_id\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_contact\"\n    group by contact_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.773745Z", "completed_at": "2024-05-10T02:39:11.781087Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.781661Z", "completed_at": "2024-05-10T02:39:11.781671Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00933074951171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_deal_id.ff48693e20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.777667Z", "completed_at": "2024-05-10T02:39:11.783168Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.786620Z", "completed_at": "2024-05-10T02:39:11.786626Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009970903396606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_deal_id.ac1628ac69", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal\"\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.783457Z", "completed_at": "2024-05-10T02:39:11.787739Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.789065Z", "completed_at": "2024-05-10T02:39:11.789070Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009667158126831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_click_event_id.8a1be931c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_click\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.789318Z", "completed_at": "2024-05-10T02:39:11.793300Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.796796Z", "completed_at": "2024-05-10T02:39:11.796808Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009426116943359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_click_event_id.da8d8487a1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_click\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.793973Z", "completed_at": "2024-05-10T02:39:11.798487Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.802294Z", "completed_at": "2024-05-10T02:39:11.802301Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009849071502685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_bounce_event_id.71b13d26d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.799163Z", "completed_at": "2024-05-10T02:39:11.804054Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.808477Z", "completed_at": "2024-05-10T02:39:11.808483Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010811805725097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_bounce_event_id.0341ffa8e9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.804328Z", "completed_at": "2024-05-10T02:39:11.809486Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.810557Z", "completed_at": "2024-05-10T02:39:11.810562Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05519890785217285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_deferred_event_id.80293078e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.810795Z", "completed_at": "2024-05-10T02:39:11.862923Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.864071Z", "completed_at": "2024-05-10T02:39:11.864079Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.055069923400878906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_deferred_event_id.2f779e2912", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.859839Z", "completed_at": "2024-05-10T02:39:11.863316Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.864346Z", "completed_at": "2024-05-10T02:39:11.864350Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005995035171508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_dropped_event_id.c92d449f52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.870585Z", "completed_at": "2024-05-10T02:39:11.873501Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.874405Z", "completed_at": "2024-05-10T02:39:11.874411Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008445978164672852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_delivered_event_id.87c8eb3f20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.867401Z", "completed_at": "2024-05-10T02:39:11.873745Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.874633Z", "completed_at": "2024-05-10T02:39:11.874637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009361982345581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_dropped_event_id.40706bbf71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.881117Z", "completed_at": "2024-05-10T02:39:11.883983Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.884873Z", "completed_at": "2024-05-10T02:39:11.884879Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008758783340454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_open_event_id.a2e658fe16", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_open\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.877506Z", "completed_at": "2024-05-10T02:39:11.884224Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.885127Z", "completed_at": "2024-05-10T02:39:11.885129Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009591817855834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_delivered_event_id.f818bf03fc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.888412Z", "completed_at": "2024-05-10T02:39:11.894332Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.895039Z", "completed_at": "2024-05-10T02:39:11.895047Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008629083633422852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_open_event_id.3a369549b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_open\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.891535Z", "completed_at": "2024-05-10T02:39:11.894783Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.896174Z", "completed_at": "2024-05-10T02:39:11.896180Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009430170059204102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_forward_event_id.b9a8bf63b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.898602Z", "completed_at": "2024-05-10T02:39:11.906258Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.907145Z", "completed_at": "2024-05-10T02:39:11.907153Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01046609878540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_forward_event_id.7f133d2dd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_forward\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.902007Z", "completed_at": "2024-05-10T02:39:11.906866Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.908125Z", "completed_at": "2024-05-10T02:39:11.908128Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01055598258972168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_sent_event_id.cf77d9f15d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.910218Z", "completed_at": "2024-05-10T02:39:11.916407Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.917136Z", "completed_at": "2024-05-10T02:39:11.917143Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008663177490234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_sent_event_id.122cb22272", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_sent\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.913586Z", "completed_at": "2024-05-10T02:39:11.916883Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.918071Z", "completed_at": "2024-05-10T02:39:11.918074Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008847951889038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_print_event_id.94d4e09b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.920171Z", "completed_at": "2024-05-10T02:39:11.925666Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.926549Z", "completed_at": "2024-05-10T02:39:11.926556Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008215188980102539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_print_event_id.40a8ccd3f3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_print\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.923074Z", "completed_at": "2024-05-10T02:39:11.925899Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.926792Z", "completed_at": "2024-05-10T02:39:11.926796Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007866859436035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_spam_report_event_id.2a56aced8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.933398Z", "completed_at": "2024-05-10T02:39:11.936153Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.936866Z", "completed_at": "2024-05-10T02:39:11.936875Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008483171463012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_status_change_event_id.c5e80297b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.929884Z", "completed_at": "2024-05-10T02:39:11.936604Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.937846Z", "completed_at": "2024-05-10T02:39:11.937850Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009870052337646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_spam_report_event_id.448320447a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.939907Z", "completed_at": "2024-05-10T02:39:11.945848Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.946663Z", "completed_at": "2024-05-10T02:39:11.946670Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008501052856445312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_status_change_event_id.13105203e0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.942961Z", "completed_at": "2024-05-10T02:39:11.946387Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.947589Z", "completed_at": "2024-05-10T02:39:11.947593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008658885955810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__email_event_aggregates", "compiled": true, "compiled_code": "\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_event_aggregates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.949713Z", "completed_at": "2024-05-10T02:39:11.956574Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.957125Z", "completed_at": "2024-05-10T02:39:11.957132Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009305000305175781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_event_id.4f287f3531", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.952710Z", "completed_at": "2024-05-10T02:39:11.957343Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.958609Z", "completed_at": "2024-05-10T02:39:11.958612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009961843490600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_event_id.734683460d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.960066Z", "completed_at": "2024-05-10T02:39:11.966402Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.967074Z", "completed_at": "2024-05-10T02:39:11.967080Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008821964263916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_call_engagement_id.5ceb3917bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.963699Z", "completed_at": "2024-05-10T02:39:11.966830Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.967937Z", "completed_at": "2024-05-10T02:39:11.967941Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005590915679931641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_call_engagement_id.43b4413603", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.970125Z", "completed_at": "2024-05-10T02:39:11.975483Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.976168Z", "completed_at": "2024-05-10T02:39:11.976173Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0077800750732421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_email_engagement_id.175561ecca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.972970Z", "completed_at": "2024-05-10T02:39:11.975915Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.977026Z", "completed_at": "2024-05-10T02:39:11.977029Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007880926132202148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_email_engagement_id.5eeb06dcfc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.979003Z", "completed_at": "2024-05-10T02:39:11.985967Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.986491Z", "completed_at": "2024-05-10T02:39:11.986499Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009234905242919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_meeting_engagement_id.18dd11dc28", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.983046Z", "completed_at": "2024-05-10T02:39:11.986740Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.988041Z", "completed_at": "2024-05-10T02:39:11.988045Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010200977325439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_meeting_engagement_id.70721fb830", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.989618Z", "completed_at": "2024-05-10T02:39:11.995978Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.996754Z", "completed_at": "2024-05-10T02:39:11.996762Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009113311767578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_task_engagement_id.0bbd752d82", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.993100Z", "completed_at": "2024-05-10T02:39:11.996498Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:11.997746Z", "completed_at": "2024-05-10T02:39:11.997751Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005991935729980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_task_engagement_id.0f578bc80c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.000026Z", "completed_at": "2024-05-10T02:39:12.007474Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.007986Z", "completed_at": "2024-05-10T02:39:12.007993Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009796857833862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__merged_deal_deal_id.a843ca0610", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__merged_deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.003506Z", "completed_at": "2024-05-10T02:39:12.008202Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.009399Z", "completed_at": "2024-05-10T02:39:12.009404Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010521173477172852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__merged_deal_merged_deal_id.c2d24039b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect merged_deal_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__merged_deal\"\nwhere merged_deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.011165Z", "completed_at": "2024-05-10T02:39:12.017647Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.018125Z", "completed_at": "2024-05-10T02:39:12.018131Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009076118469238281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_note_engagement_id.244059891e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.014885Z", "completed_at": "2024-05-10T02:39:12.018336Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.019573Z", "completed_at": "2024-05-10T02:39:12.019577Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0061228275299072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_note_engagement_id.e2eaf5256e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.030218Z", "completed_at": "2024-05-10T02:39:12.033210Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.033712Z", "completed_at": "2024-05-10T02:39:12.033719Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004761934280395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_engagement_id.b26f4d328f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.021394Z", "completed_at": "2024-05-10T02:39:12.033941Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.035081Z", "completed_at": "2024-05-10T02:39:12.035084Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015970945358276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagements", "compiled": true, "compiled_code": "\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement\"\n\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), contacts_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(contact_id)\n as contact_ids\n    from contacts\n    group by 1\n\n\n\n\n\n), deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_deal\"\n \n), deals_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(deal_id)\n as deal_ids\n    from deals\n    group by 1\n\n\n\n\n\n), companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_company\"\n\n), companies_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(company_id)\n as company_ids\n    from companies\n    group by 1\n\n\n\n), joined as (\n\n    select \n         contacts_agg.contact_ids, \n         deals_agg.deal_ids, \n         companies_agg.company_ids, \n        engagements.*\n    from engagements\n     left join contacts_agg using (engagement_id) \n     left join deals_agg using (engagement_id) \n     left join companies_agg using (engagement_id) \n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.036462Z", "completed_at": "2024-05-10T02:39:12.046341Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.046877Z", "completed_at": "2024-05-10T02:39:12.046883Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011951208114624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_engagement_id.4f054187b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.049890Z", "completed_at": "2024-05-10T02:39:12.057826Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.058975Z", "completed_at": "2024-05-10T02:39:12.058984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011159181594848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__property_option_property_id__property_option_label.2792c4669b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        property_id, property_option_label\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property_option\"\n    group by property_id, property_option_label\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.053597Z", "completed_at": "2024-05-10T02:39:12.058157Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.059239Z", "completed_at": "2024-05-10T02:39:12.059243Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010683298110961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__property__fivetran_id.37b6ec5db1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property\"\nwhere _fivetran_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.062821Z", "completed_at": "2024-05-10T02:39:12.071497Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.072285Z", "completed_at": "2024-05-10T02:39:12.072293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011594057083129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__property__fivetran_id.1d41a2aa95", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    _fivetran_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__property\"\nwhere _fivetran_id is not null\ngroup by _fivetran_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.066358Z", "completed_at": "2024-05-10T02:39:12.076903Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.077717Z", "completed_at": "2024-05-10T02:39:12.077727Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0168149471282959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__company_history_company_id__field_name__valid_to.654ef778b1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__company_history\"\n    group by company_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.074178Z", "completed_at": "2024-05-10T02:39:12.078030Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.079441Z", "completed_at": "2024-05-10T02:39:12.079445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006658077239990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__company_history_id.33035793ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__company_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.081016Z", "completed_at": "2024-05-10T02:39:12.087549Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.088307Z", "completed_at": "2024-05-10T02:39:12.088315Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00923013687133789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__company_history_id.f1af964b1f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__company_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.084737Z", "completed_at": "2024-05-10T02:39:12.088044Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.089274Z", "completed_at": "2024-05-10T02:39:12.089278Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005934000015258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__contact_history_contact_id__field_name__valid_to.42ccfb8329", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contact_history\"\n    group by contact_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.091464Z", "completed_at": "2024-05-10T02:39:12.098093Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.098579Z", "completed_at": "2024-05-10T02:39:12.098585Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0088958740234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_history_id.eaae22e088", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contact_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.095423Z", "completed_at": "2024-05-10T02:39:12.098798Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.099968Z", "completed_at": "2024-05-10T02:39:12.099972Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009549856185913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_history_id.aef69ae1ec", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contact_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.101420Z", "completed_at": "2024-05-10T02:39:12.110153Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.110668Z", "completed_at": "2024-05-10T02:39:12.110674Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011154890060424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.106849Z", "completed_at": "2024-05-10T02:39:12.110877Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.112301Z", "completed_at": "2024-05-10T02:39:12.112305Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007071971893310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_clicks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_click\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_clicks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.113876Z", "completed_at": "2024-05-10T02:39:12.122015Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.122496Z", "completed_at": "2024-05-10T02:39:12.122503Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01055908203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.117843Z", "completed_at": "2024-05-10T02:39:12.122705Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.123933Z", "completed_at": "2024-05-10T02:39:12.123937Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0074329376220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.125382Z", "completed_at": "2024-05-10T02:39:12.132704Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.133311Z", "completed_at": "2024-05-10T02:39:12.133318Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009591102600097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.129421Z", "completed_at": "2024-05-10T02:39:12.134062Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.135338Z", "completed_at": "2024-05-10T02:39:12.135343Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007392168045043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_forward\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.136369Z", "completed_at": "2024-05-10T02:39:12.143890Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.144463Z", "completed_at": "2024-05-10T02:39:12.144471Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009988069534301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_opens", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_open\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_opens\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.140901Z", "completed_at": "2024-05-10T02:39:12.145239Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.146397Z", "completed_at": "2024-05-10T02:39:12.146402Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006765127182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_print", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_print\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.147396Z", "completed_at": "2024-05-10T02:39:12.155844Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.156621Z", "completed_at": "2024-05-10T02:39:12.156628Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011278629302978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_sent\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.152597Z", "completed_at": "2024-05-10T02:39:12.156364Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.157618Z", "completed_at": "2024-05-10T02:39:12.157622Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00638890266418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.159813Z", "completed_at": "2024-05-10T02:39:12.166669Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.167249Z", "completed_at": "2024-05-10T02:39:12.167257Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009112119674682617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.163853Z", "completed_at": "2024-05-10T02:39:12.168119Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.169468Z", "completed_at": "2024-05-10T02:39:12.169474Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01064300537109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__deal_history_deal_id__field_name__valid_to.f55c724804", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        deal_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deal_history\"\n    group by deal_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.170440Z", "completed_at": "2024-05-10T02:39:12.178071Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.178566Z", "completed_at": "2024-05-10T02:39:12.178573Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009926080703735352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_history_id.a1c6cd6a75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deal_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.174308Z", "completed_at": "2024-05-10T02:39:12.179286Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.180414Z", "completed_at": "2024-05-10T02:39:12.180418Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007279872894287109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_history_id.1cb93fca79", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deal_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.181283Z", "completed_at": "2024-05-10T02:39:12.188080Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.188659Z", "completed_at": "2024-05-10T02:39:12.188665Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00927281379699707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_event_aggregates_email_send_id.ac29e6997a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_send_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_event_aggregates\"\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.185461Z", "completed_at": "2024-05-10T02:39:12.188892Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.190096Z", "completed_at": "2024-05-10T02:39:12.190099Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006055355072021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_event_aggregates_email_send_id.4deec238f9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_event_aggregates\"\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.191684Z", "completed_at": "2024-05-10T02:39:12.205078Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.205556Z", "completed_at": "2024-05-10T02:39:12.205563Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015617132186889648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__companies", "compiled": true, "compiled_code": "\n\nwith companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company\"\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), engagement_companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_company\"\n\n), engagement_companies_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_companies.company_id\n    from engagements\n    inner join engagement_companies\n        using (engagement_id)\n\n), engagement_companies_agg as (\n\n    \n\n    select\n        company_id,\n        count(case when engagement_type = 'NOTE' then company_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then company_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then company_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then company_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then company_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then company_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then company_id end) as count_engagement_forwarded_emails\n    from engagement_companies_joined\n    group by 1\n\n\n\n), joined as (\n\n    select \n        companies.*,\n        \n        coalesce(engagement_companies_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_companies_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_companies_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_companies_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_companies_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from companies\n    left join engagement_companies_agg\n        using (company_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__companies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:10.424130Z", "completed_at": "2024-05-10T02:39:12.833801Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:12.834481Z", "completed_at": "2024-05-10T02:39:12.834494Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.596743106842041, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    name\n    \n as field_name , \n    \n    \n    source\n    \n as change_source , \n    \n    \n    source_id\n    \n as change_source_id , \n    \n    \n    timestamp_instant\n    \n as change_timestamp , \n    \n    \n    value\n    \n as new_value \n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"_fivetran_active\"\n        , \"_fivetran_end\"\n\n \n        \n        from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.207106Z", "completed_at": "2024-05-10T02:39:14.249428Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.251825Z", "completed_at": "2024-05-10T02:39:14.251830Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.421018123626709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_emails", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_email\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"all_owner_ids\",\n  base.\"all_team_ids\",\n  base.\"email_subject\",\n  base.\"email_text\",\n  base.\"lastmodifieddate\",\n  base.\"modified_by\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_emails\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:12.198196Z", "completed_at": "2024-05-10T02:39:14.248960Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.251401Z", "completed_at": "2024-05-10T02:39:14.251409Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.431161880493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_calls", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_call\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_calls\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:11.530620Z", "completed_at": "2024-05-10T02:39:14.248430Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.250942Z", "completed_at": "2024-05-10T02:39:14.250954Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.1013028621673584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as ticket_id , \n    cast(null as boolean) as _fivetran_ticket_deleted , \n    \n    \n    is_deleted\n    \n as is_ticket_deleted , \n    \n    \n    property_closed_date\n    \n as closed_date , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_first_agent_reply_date\n    \n as first_agent_reply_at , \n    \n    \n    property_hs_pipeline\n    \n as ticket_pipeline_id , \n    \n    \n    property_hs_pipeline_stage\n    \n as ticket_pipeline_stage_id , \n    \n    \n    property_hs_ticket_category\n    \n as ticket_category , \n    \n    \n    property_hs_ticket_priority\n    \n as ticket_priority , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_subject\n    \n as ticket_subject , \n    \n    \n    property_content\n    \n as ticket_content \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_ticket_columns.sql macro\n        ticket_id,\n        coalesce(_fivetran_ticket_deleted, is_ticket_deleted) as is_ticket_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        first_agent_reply_at,\n        ticket_pipeline_id,\n        ticket_pipeline_stage_id,\n        ticket_category,\n        ticket_priority,\n        owner_id,\n        ticket_subject,\n        ticket_content\n\n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__ticket_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.657745Z", "completed_at": "2024-05-10T02:39:14.665149Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.665897Z", "completed_at": "2024-05-10T02:39:14.665907Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03237509727478027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__engagement_metrics__by_contact", "compiled": true, "compiled_code": "\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__engagement_metrics__by_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.668540Z", "completed_at": "2024-05-10T02:39:14.672968Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.673627Z", "completed_at": "2024-05-10T02:39:14.673636Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006839752197265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagements_engagement_id.59b32bc0d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.675855Z", "completed_at": "2024-05-10T02:39:14.680374Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.681079Z", "completed_at": "2024-05-10T02:39:14.681085Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006557941436767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagements_engagement_id.01d5c3ee5d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.683018Z", "completed_at": "2024-05-10T02:39:14.699126Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.699647Z", "completed_at": "2024-05-10T02:39:14.699655Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017808914184570312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_stages", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal\"\n\n\n), merged_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__merged_deal\"\n\n), aggregate_merged_deals as (\n\n    select\n        deal_id,\n        \n    array_agg(merged_deal_id)\n as merged_deal_ids\n    from merged_deals\n    group by 1\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n        aggregate_merged_deals.merged_deal_ids,\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n    left join aggregate_merged_deals\n        on deals.deal_id = aggregate_merged_deals.deal_id\n\n    left join merged_deals\n        on deals.deal_id = merged_deals.merged_deal_id\n    where merged_deals.merged_deal_id is null\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n), deal_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_stage\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), final as (\n\n    select\n        deal_stage.deal_id || '-' || row_number() over(partition by deal_stage.deal_id order by deal_stage.date_entered asc) as deal_stage_id,\n        deals_enhanced.deal_id,\n        deals_enhanced.deal_name,\n\n        \n        deals_enhanced.merged_deal_ids,\n        \n        \n        deal_stage._fivetran_start as date_stage_entered,\n        deal_stage._fivetran_end as date_stage_exited,\n        deal_stage._fivetran_active as is_stage_active,\n        deal_stage.deal_stage_name as pipeline_stage_id,\n        pipeline_stage.pipeline_stage_label,\n        pipeline_stage.deal_pipeline_id as pipeline_id,\n        pipeline.pipeline_label,\n        deal_stage.source,\n        deal_stage.source_id,\n        pipeline_stage.is_active as is_pipeline_stage_active,\n        pipeline.is_active as is_pipeline_active,\n        pipeline_stage.is_closed_won as is_pipeline_stage_closed_won,\n        pipeline_stage.display_order as pipeline_stage_display_order,\n        pipeline.display_order as pipeline_display_order,\n        pipeline_stage.probability as pipeline_stage_probability,\n        coalesce(pipeline.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        coalesce(pipeline_stage.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        coalesce(deals_enhanced.is_deal_deleted, false) as is_deal_deleted,\n        pipeline_stage.deal_pipeline_stage_created_at,\n        pipeline_stage.deal_pipeline_stage_updated_at\n\n    from deal_stage\n\n    left join pipeline_stage\n        on deal_stage.deal_stage_name = pipeline_stage.deal_pipeline_stage_id\n    \n    left join pipeline\n        on pipeline_stage.deal_pipeline_id = pipeline.deal_pipeline_id\n\n    left join deals_enhanced\n        on deal_stage.deal_id = deals_enhanced.deal_id\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deal_stages\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.701599Z", "completed_at": "2024-05-10T02:39:14.718080Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.718536Z", "completed_at": "2024-05-10T02:39:14.718544Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018105268478393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deals", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal\"\n\n\n), merged_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__merged_deal\"\n\n), aggregate_merged_deals as (\n\n    select\n        deal_id,\n        \n    array_agg(merged_deal_id)\n as merged_deal_ids\n    from merged_deals\n    group by 1\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n        aggregate_merged_deals.merged_deal_ids,\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n    left join aggregate_merged_deals\n        on deals.deal_id = aggregate_merged_deals.deal_id\n\n    left join merged_deals\n        on deals.deal_id = merged_deals.merged_deal_id\n    where merged_deals.merged_deal_id is null\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), engagement_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_deal\"\n\n), engagement_deal_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_deals.deal_id\n    from engagements\n    inner join engagement_deals\n        on cast(engagements.engagement_id as bigint) = cast(engagement_deals.engagement_id as bigint )\n\n), engagement_deal_agg as (\n\n    \n\n    select\n        deal_id,\n        count(case when engagement_type = 'NOTE' then deal_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then deal_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then deal_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then deal_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then deal_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then deal_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then deal_id end) as count_engagement_forwarded_emails\n    from engagement_deal_joined\n    group by 1\n\n\n\n), engagements_joined as (\n\n    select \n        deals_enhanced.*,\n        \n        coalesce(engagement_deal_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_deal_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_deal_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_deal_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_deal_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from deals_enhanced\n    left join engagement_deal_agg\n        on cast(deals_enhanced.deal_id as bigint) = cast(engagement_deal_agg.deal_id as bigint )\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.720197Z", "completed_at": "2024-05-10T02:39:14.723515Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.724035Z", "completed_at": "2024-05-10T02:39:14.724040Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00484919548034668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_bounce_event_id.39d8daa6f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.725625Z", "completed_at": "2024-05-10T02:39:14.728582Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.729054Z", "completed_at": "2024-05-10T02:39:14.729060Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004477977752685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_bounce_event_id.7a1c6704e1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_bounce\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.730732Z", "completed_at": "2024-05-10T02:39:14.734676Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.735122Z", "completed_at": "2024-05-10T02:39:14.735127Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0053479671478271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_clicks_event_id.f603501ca0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_clicks\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.736539Z", "completed_at": "2024-05-10T02:39:14.739490Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.739960Z", "completed_at": "2024-05-10T02:39:14.739968Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004344940185546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_clicks_event_id.60d3912846", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_clicks\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.741377Z", "completed_at": "2024-05-10T02:39:14.744295Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.744834Z", "completed_at": "2024-05-10T02:39:14.744839Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004345893859863281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_deferred_event_id.2c6decaa91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.746479Z", "completed_at": "2024-05-10T02:39:14.749705Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.750160Z", "completed_at": "2024-05-10T02:39:14.750167Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004816770553588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_deferred_event_id.bb75dcb83a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_deferred\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.751625Z", "completed_at": "2024-05-10T02:39:14.754661Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.755114Z", "completed_at": "2024-05-10T02:39:14.755121Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004383087158203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_delivered_event_id.0609870be3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.756677Z", "completed_at": "2024-05-10T02:39:14.805427Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.805879Z", "completed_at": "2024-05-10T02:39:14.805886Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.050212860107421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_delivered_event_id.242e838cce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_delivered\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.807332Z", "completed_at": "2024-05-10T02:39:14.809957Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.810379Z", "completed_at": "2024-05-10T02:39:14.810384Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003931283950805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_dropped_event_id.5cfe4eeb95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.811719Z", "completed_at": "2024-05-10T02:39:14.814605Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.815105Z", "completed_at": "2024-05-10T02:39:14.815112Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004281759262084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_dropped_event_id.093040860b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_dropped\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.816570Z", "completed_at": "2024-05-10T02:39:14.819422Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.819863Z", "completed_at": "2024-05-10T02:39:14.819869Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004249095916748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_forward_event_id.417a73da08", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.821420Z", "completed_at": "2024-05-10T02:39:14.824673Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.825149Z", "completed_at": "2024-05-10T02:39:14.825156Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004709959030151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_forward_event_id.064956aaa7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_forward\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.826752Z", "completed_at": "2024-05-10T02:39:14.830638Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.831090Z", "completed_at": "2024-05-10T02:39:14.831096Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005341053009033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_opens_event_id.a9fe279ee1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_opens\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.832541Z", "completed_at": "2024-05-10T02:39:14.835536Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.835984Z", "completed_at": "2024-05-10T02:39:14.835990Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004354000091552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_opens_event_id.d7963f4eb0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_opens\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.837485Z", "completed_at": "2024-05-10T02:39:14.840323Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.840771Z", "completed_at": "2024-05-10T02:39:14.840777Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004209995269775391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_print_event_id.9dac8a147e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.842203Z", "completed_at": "2024-05-10T02:39:14.844972Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.845405Z", "completed_at": "2024-05-10T02:39:14.845410Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004052877426147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_print_event_id.548f6cece7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_print\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.846739Z", "completed_at": "2024-05-10T02:39:14.849496Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.849978Z", "completed_at": "2024-05-10T02:39:14.849983Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004144191741943359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_sent_event_id.5507dcc5b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.851441Z", "completed_at": "2024-05-10T02:39:14.855316Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.855739Z", "completed_at": "2024-05-10T02:39:14.855745Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005181074142456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_sent_event_id.68076270f8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_sent\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.857151Z", "completed_at": "2024-05-10T02:39:14.860081Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.860521Z", "completed_at": "2024-05-10T02:39:14.860528Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004370927810668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_spam_report_event_id.5ddca8771a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.862065Z", "completed_at": "2024-05-10T02:39:14.865037Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.865481Z", "completed_at": "2024-05-10T02:39:14.865487Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004355907440185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_spam_report_event_id.20aab81ec6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_spam_report\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.866960Z", "completed_at": "2024-05-10T02:39:14.869241Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.869684Z", "completed_at": "2024-05-10T02:39:14.869689Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003667116165161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__email_aggregate_status_change", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_aggregate_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.871147Z", "completed_at": "2024-05-10T02:39:14.874010Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.874459Z", "completed_at": "2024-05-10T02:39:14.874465Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004209995269775391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_status_change_event_id.a1737e44b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.876078Z", "completed_at": "2024-05-10T02:39:14.880250Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.880697Z", "completed_at": "2024-05-10T02:39:14.880703Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0056209564208984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_status_change_event_id.2e5b2b72e2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_status_change\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.882149Z", "completed_at": "2024-05-10T02:39:14.885345Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.885907Z", "completed_at": "2024-05-10T02:39:14.885914Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004771232604980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__companies_company_id.687ec98e97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__companies\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.887560Z", "completed_at": "2024-05-10T02:39:14.890593Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.891062Z", "completed_at": "2024-05-10T02:39:14.891070Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0044820308685302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__companies_company_id.a58ceac3f2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__companies\" where not coalesce(is_company_deleted, false)) dbt_subquery\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.892653Z", "completed_at": "2024-05-10T02:39:14.902429Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.902908Z", "completed_at": "2024-05-10T02:39:14.902916Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01128387451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__daily_ticket_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_property_history\"\n\n    -- should we include an option pivot out ALL properties? in the same vein as our passthrough-all-columns var\n    where lower(field_name) in \n        ('hs_pipeline', 'hs_pipeline_stage'\n    )\n\n    \n    and change_timestamp >= (select cast(max(date_day) as timestamp) from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__daily_ticket_history\" )\n    \n\n), windows as (\n\n    select\n        cast(date_trunc('day', change_timestamp) as date) as date_day,\n        ticket_id,\n        field_name,\n        new_value,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        _fivetran_end as valid_to\n        -- if it is currently active fivetran_end = 9999-12-31 23:59:59, but the calendar_spine will end at the current_date\n    from history\n\n), order_daily_changes as (\n\n    select \n        *,\n        row_number() over (\n            partition by date_day, ticket_id, field_name\n            order by valid_from desc\n            ) as row_num\n    from windows\n\n), extract_latest as (\n    \n    select \n        date_day,\n        ticket_id,\n        field_name,\n        case when new_value is null then 'is_null' else new_value end as new_value,\n        change_source,\n        change_source_id,\n        valid_from,\n        valid_to\n\n    from order_daily_changes\n    where row_num = 1\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from extract_latest\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.904552Z", "completed_at": "2024-05-10T02:39:14.908574Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.909065Z", "completed_at": "2024-05-10T02:39:14.909070Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005465984344482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_emails_engagement_id.13a39d1e09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_emails\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.910492Z", "completed_at": "2024-05-10T02:39:14.913128Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.913551Z", "completed_at": "2024-05-10T02:39:14.913556Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003922224044799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_emails_engagement_id.b18e2acbde", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_emails\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.914954Z", "completed_at": "2024-05-10T02:39:14.917824Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.918267Z", "completed_at": "2024-05-10T02:39:14.918273Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004212856292724609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_calls_engagement_id.00f8d8357f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_calls\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.919665Z", "completed_at": "2024-05-10T02:39:14.922394Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:14.922834Z", "completed_at": "2024-05-10T02:39:14.922839Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0040361881256103516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_calls_engagement_id.972572ce6c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_calls\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:13.022944Z", "completed_at": "2024-05-10T02:39:15.150490Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.151396Z", "completed_at": "2024-05-10T02:39:15.151412Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.293706178665161, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_meetings", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"created_from_link_id\",\n  base.\"end_time\",\n  base.\"pre_meeting_prospect_reminders\",\n  base.\"source\",\n  base.\"source_id\",\n  base.\"start_time\",\n  base.\"web_conference_meeting_id\",\n  base.\"meeting_outcome\",\n  base.\"body\",\n  base.\"external_url\",\n  base.\"title\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_meetings\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.320892Z", "completed_at": "2024-05-10T02:39:15.339541Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.340660Z", "completed_at": "2024-05-10T02:39:15.340679Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023565053939819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__ticket_ticket_id.299e7c4c53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.345385Z", "completed_at": "2024-05-10T02:39:15.352276Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.353222Z", "completed_at": "2024-05-10T02:39:15.353239Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0107269287109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__ticket_ticket_id.78c6fbfcaf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.356625Z", "completed_at": "2024-05-10T02:39:15.377684Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.378294Z", "completed_at": "2024-05-10T02:39:15.378305Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02334117889404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__tickets", "compiled": true, "compiled_code": "\n\nwith ticket as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket\"\n\n), ticket_pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline\"\n\n), ticket_pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\"\n\n\n\n\n), ticket_company as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_company\"\n\n), company as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__company\"\n\n), join_companies as (\n    \n    select\n        ticket_company.ticket_id,\n        ticket_company.company_id,\n        company.company_name\n\n    from ticket_company\n    left join company \n        on ticket_company.company_id = company.company_id\n\n), agg_companies as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when company_id is null then '' else cast(company_id as TEXT) end)\n as company_ids,\n        \n    array_agg(case when company_name is null then '' else company_name end)\n as company_names\n\n    from join_companies\n    group by 1\n\n\n\n\n), ticket_contact as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_contact\"\n\n), contact as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact\"\n\n), join_contacts as (\n    \n    select\n        ticket_contact.ticket_id,\n        ticket_contact.contact_id,\n        contact.email\n\n    from ticket_contact\n    left join contact \n        on ticket_contact.contact_id = contact.contact_id\n\n), agg_contacts as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when contact_id is null then '' else cast(contact_id as TEXT) end)\n as contact_ids,\n        \n    array_agg(case when email is null then '' else email end)\n as contact_emails\n\n    from join_contacts\n    group by 1\n\n\n\n\n), owner as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n\n\n), engagement as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), ticket_engagement as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_engagement\"\n\n), join_engagements as (\n\n    select \n        engagement.engagement_type,\n        ticket_engagement.ticket_id\n    from engagement\n    inner join ticket_engagement\n        on cast(engagement.engagement_id as bigint) = cast(ticket_engagement.engagement_id as bigint )\n\n), agg_engagements as (\n\n    \n\n    select\n        ticket_id,\n        count(case when engagement_type = 'NOTE' then ticket_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then ticket_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then ticket_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then ticket_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then ticket_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then ticket_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then ticket_id end) as count_engagement_forwarded_emails\n    from join_engagements\n    group by 1\n\n\n\n\n\n), final_join as (\n\n    select\n        ticket.*,\n        ticket_pipeline_stage.ticket_state,\n        ticket_pipeline_stage.is_closed,\n        ticket_pipeline_stage.pipeline_stage_label,\n        ticket_pipeline.pipeline_label,\n        ticket_pipeline_stage.display_order as pipeline_stage_order,\n        ticket_pipeline.is_ticket_pipeline_deleted,\n        ticket_pipeline_stage.is_ticket_pipeline_stage_deleted\n\n    \n        , owner.email_address as owner_email\n        , owner.full_name as owner_full_name\n    \n\n    \n\n    \n        , agg_contacts.contact_ids\n        , agg_contacts.contact_emails\n    \n\n    \n        , agg_companies.company_ids\n        , agg_companies.company_names\n    \n\n    \n        \n        , coalesce(agg_engagements.count_engagement_notes,0) as count_engagement_notes\n        \n        , coalesce(agg_engagements.count_engagement_tasks,0) as count_engagement_tasks\n        \n        , coalesce(agg_engagements.count_engagement_calls,0) as count_engagement_calls\n        \n        , coalesce(agg_engagements.count_engagement_meetings,0) as count_engagement_meetings\n        \n        , coalesce(agg_engagements.count_engagement_emails,0) as count_engagement_emails\n        \n        , coalesce(agg_engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails\n        \n        , coalesce(agg_engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails\n        \n    \n\n    from ticket\n\n    left join ticket_pipeline \n        on ticket.ticket_pipeline_id = ticket_pipeline.ticket_pipeline_id \n    \n    left join ticket_pipeline_stage \n        on ticket.ticket_pipeline_stage_id = ticket_pipeline_stage.ticket_pipeline_stage_id\n        and ticket_pipeline.ticket_pipeline_id = ticket_pipeline_stage.ticket_pipeline_id\n\n    \n    left join owner \n        on ticket.owner_id = owner.owner_id\n    \n\n    \n\n    \n    left join agg_contacts\n        on ticket.ticket_id = agg_contacts.ticket_id \n    \n\n    \n    left join agg_companies\n        on ticket.ticket_id = agg_companies.ticket_id \n    \n\n    \n    left join agg_engagements\n        on ticket.ticket_id = agg_engagements.ticket_id\n    \n)\n\nselect *\nfrom final_join", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.380518Z", "completed_at": "2024-05-10T02:39:15.384510Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.385082Z", "completed_at": "2024-05-10T02:39:15.385089Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005894184112548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__engagement_metrics__by_contact_contact_id.4a800df06b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__engagement_metrics__by_contact\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.387018Z", "completed_at": "2024-05-10T02:39:15.390541Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.391070Z", "completed_at": "2024-05-10T02:39:15.391077Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005270957946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__engagement_metrics__by_contact_contact_id.1c156b64ed", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__engagement_metrics__by_contact\"\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.392765Z", "completed_at": "2024-05-10T02:39:15.397100Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.397592Z", "completed_at": "2024-05-10T02:39:15.397599Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0058476924896240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_stages_deal_stage_id.162d2d204b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_stage_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deal_stages\"\nwhere deal_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.399208Z", "completed_at": "2024-05-10T02:39:15.402293Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.402731Z", "completed_at": "2024-05-10T02:39:15.402736Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0045087337493896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_stages_deal_stage_id.7fd3732373", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_stage_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deal_stages\" where not coalesce(is_deal_pipeline_stage_deleted, false)) dbt_subquery\nwhere deal_stage_id is not null\ngroup by deal_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.404185Z", "completed_at": "2024-05-10T02:39:15.407001Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.407460Z", "completed_at": "2024-05-10T02:39:15.407467Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0041980743408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deals_deal_id.bdbfe47fcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deals\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.409033Z", "completed_at": "2024-05-10T02:39:15.411995Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.412437Z", "completed_at": "2024-05-10T02:39:15.412443Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004427909851074219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deals_deal_id.d728fe5f71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__deals\" where not coalesce(is_deal_deleted, false)) dbt_subquery\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.413852Z", "completed_at": "2024-05-10T02:39:15.416939Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.417363Z", "completed_at": "2024-05-10T02:39:15.417368Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004369020462036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_sends", "compiled": true, "compiled_code": "\n\nwith sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_event_sent\"\n\n), metrics as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_event_aggregates\"\n\n), joined as (\n\n    select\n        sends.*,\n        coalesce(metrics.bounces,0) as bounces,\n        coalesce(metrics.clicks,0) as clicks,\n        coalesce(metrics.deferrals,0) as deferrals,\n        coalesce(metrics.deliveries,0) as deliveries,\n        coalesce(metrics.drops,0) as drops,\n        coalesce(metrics.forwards,0) as forwards,\n        coalesce(metrics.opens,0) as opens,\n        coalesce(metrics.prints,0) as prints,\n        coalesce(metrics.spam_reports,0) as spam_reports\n    from sends\n    left join metrics using (email_send_id)\n\n), booleans as (\n\n    select \n        *,\n        bounces > 0 as was_bounced,\n        clicks > 0 as was_clicked,\n        deferrals > 0 as was_deferred,\n        deliveries > 0 as was_delivered,\n        forwards > 0 as was_forwarded,\n        opens > 0 as was_opened,\n        prints > 0 as was_printed,\n        spam_reports > 0 as was_spam_reported\n    from joined\n\n\n\n), unsubscribes as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_aggregate_status_change\"\n\n), unsubscribes_joined as (\n\n    select \n        booleans.*,\n        coalesce(unsubscribes.unsubscribes,0) as unsubscribes,\n        coalesce(unsubscribes.unsubscribes,0) > 0 as was_unsubcribed\n    from booleans\n    left join unsubscribes using (email_send_id)\n\n)\n\nselect *\nfrom unsubscribes_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_sends\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.419863Z", "completed_at": "2024-05-10T02:39:15.423241Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.423729Z", "completed_at": "2024-05-10T02:39:15.423737Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005836009979248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_aggregate_status_change_email_send_id.16bf74a3bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_send_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_aggregate_status_change\"\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.425325Z", "completed_at": "2024-05-10T02:39:15.428187Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.428666Z", "completed_at": "2024-05-10T02:39:15.428672Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004354715347290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_aggregate_status_change_email_send_id.7c03e87c05", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_aggregate_status_change\"\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.430229Z", "completed_at": "2024-05-10T02:39:15.435774Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.436229Z", "completed_at": "2024-05-10T02:39:15.436235Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0069370269775390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__pivot_daily_ticket_history", "compiled": true, "compiled_code": "\n\n\n\nwith daily_history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__daily_ticket_history\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__pivot_daily_ticket_history\" )\n    \n\n), pivot_out as (\n\n    select \n        date_day, \n        ticket_id\n\n        -- should we remove the `hs_` prefix? could introduce some duplicates if people already have something like `hs_owner` and `owner`\n        , max(case when lower(field_name) = 'hs_pipeline' then new_value end) as hs_pipeline\n        , max(case when lower(field_name) = 'hs_pipeline_stage' then new_value end) as hs_pipeline_stage\n        from daily_history\n\n    group by 1,2\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from pivot_out\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__pivot_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.437772Z", "completed_at": "2024-05-10T02:39:15.440555Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.440990Z", "completed_at": "2024-05-10T02:39:15.440995Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004117012023925781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_meetings_engagement_id.83a791c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_meetings\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.442480Z", "completed_at": "2024-05-10T02:39:15.446063Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.446511Z", "completed_at": "2024-05-10T02:39:15.446516Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004894256591796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_meetings_engagement_id.3098aabcd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_meetings\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.447888Z", "completed_at": "2024-05-10T02:39:15.450541Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.450959Z", "completed_at": "2024-05-10T02:39:15.450963Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003931999206542969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__tickets_ticket_id.259c6846d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.452461Z", "completed_at": "2024-05-10T02:39:15.455386Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:15.455833Z", "completed_at": "2024-05-10T02:39:15.455838Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004374027252197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__tickets_ticket_id.4b54466361", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.647756Z", "completed_at": "2024-05-10T02:39:16.631713Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:16.633468Z", "completed_at": "2024-05-10T02:39:16.633478Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.1644628047943115, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_tasks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_task\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n  base.\"task_type\",\n  base.\"object_id\",\n  base.\"engagement_source\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_tasks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.636852Z", "completed_at": "2024-05-10T02:39:16.629927Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:16.631163Z", "completed_at": "2024-05-10T02:39:16.631185Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.1915316581726074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_notes", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__engagement_note\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"note\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"body_preview\",\n  base.\"lastmodifieddate\",\n  base.\"note_body\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_notes\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:14.924252Z", "completed_at": "2024-05-10T02:39:16.839487Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:16.849549Z", "completed_at": "2024-05-10T02:39:16.849563Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.043804168701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__ticket_calendar_spine", "compiled": true, "compiled_code": "\n\nwith calendar as (\n\n    \n    \n    \n    \n    \n\n    select * \n    from (\n        \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1492\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2020-04-16' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= \n\n    \n    (current_timestamp at time zone 'utc')::timestamp\n + ((interval '1 week') * (1))\n\n\n\n)\n\nselect * from filtered\n\n \n    ) as date_spine\n\n    \n    where date_day >= (select min(date_day) from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__ticket_calendar_spine\" )\n    \n\n), ticket as (\n\n    select \n        *,\n        cast( date_trunc('day', case when closed_date is null then \n    current_timestamp::timestamp\n else closed_date end) as date) as open_until\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket\"\n    where not coalesce(is_ticket_deleted, false)\n\n), joined as (\n\n    select \n        cast(calendar.date_day as date) as date_day,\n        ticket.ticket_id\n    from calendar \n    inner join ticket\n        on cast(calendar.date_day as date) >= cast(ticket.created_date as date)\n        -- use this variable to extend the ticket's history past its close date (for reporting/data viz purposes :-)\n        and cast(calendar.date_day as date) <= \n\n    ticket.open_until + ((interval '1 day') * (0))\n\n\n\n), surrogate as (\n\n    select\n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from joined\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__ticket_calendar_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:16.970368Z", "completed_at": "2024-05-10T02:39:16.977383Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:16.978287Z", "completed_at": "2024-05-10T02:39:16.978300Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010102987289428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_sends_event_id.9fc8a8bef3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_sends\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:16.981472Z", "completed_at": "2024-05-10T02:39:16.987893Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:16.988835Z", "completed_at": "2024-05-10T02:39:16.988848Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009424924850463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_sends_event_id.b01306228f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_sends\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:15.457276Z", "completed_at": "2024-05-10T02:39:17.207709Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:17.208380Z", "completed_at": "2024-05-10T02:39:17.208390Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.8880119323730469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contacts", "compiled": true, "compiled_code": "\n\n\n\nwith contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        recipient_email_address,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), email_joined as (\n\n    select \n        contacts.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contacts\n    left join email_metrics\n        on contacts.email = email_metrics.recipient_email_address\n\n\n\n\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__engagement_metrics__by_contact\"\n\n), engagements_joined as (\n\n    select \n        email_joined.*,\n        \n        coalesce(engagements.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagements.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagements.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagements.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagements.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from email_joined\n    left join engagements\n        using (contact_id)\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contacts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:17.346411Z", "completed_at": "2024-05-10T02:39:17.354142Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:17.355354Z", "completed_at": "2024-05-10T02:39:17.355368Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01071310043334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_tasks_engagement_id.67738794ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_tasks\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:17.358977Z", "completed_at": "2024-05-10T02:39:17.364703Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:17.365587Z", "completed_at": "2024-05-10T02:39:17.365597Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008753061294555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_tasks_engagement_id.754d36b939", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_tasks\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:17.368418Z", "completed_at": "2024-05-10T02:39:17.373367Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:17.374137Z", "completed_at": "2024-05-10T02:39:17.374145Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007409095764160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_notes_engagement_id.76434ac965", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_notes\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:17.376671Z", "completed_at": "2024-05-10T02:39:17.381125Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:17.381803Z", "completed_at": "2024-05-10T02:39:17.381811Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006652116775512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_notes_engagement_id.c9864b5001", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__engagement_notes\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:17.384046Z", "completed_at": "2024-05-10T02:39:17.388337Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:17.388948Z", "completed_at": "2024-05-10T02:39:17.388956Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006239891052246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contacts_contact_id.e28e88dce3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contacts\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:17.390961Z", "completed_at": "2024-05-10T02:39:17.396182Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:17.396735Z", "completed_at": "2024-05-10T02:39:17.396743Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006994009017944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contacts_contact_id.8f627121df", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contacts\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:16.839897Z", "completed_at": "2024-05-10T02:39:18.368084Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:18.369306Z", "completed_at": "2024-05-10T02:39:18.369315Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.829658031463623, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__email_metrics__by_contact_list", "compiled": true, "compiled_code": "\n\nwith email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_sends\"\n\n), contact_list_member as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list_member\"\n\n), joined as (\n\n    select\n        email_sends.*,\n        contact_list_member.contact_list_id\n    from email_sends\n    left join contact_list_member\n        using (contact_id)\n    where contact_list_member.contact_list_id is not null\n\n), email_metrics as (\n    \n    select \n        contact_list_id,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from joined\n    group by 1\n\n)\n\nselect *\nfrom email_metrics", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_metrics__by_contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:16.806221Z", "completed_at": "2024-05-10T02:39:18.365927Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:18.367124Z", "completed_at": "2024-05-10T02:39:18.367150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8677189350128174, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_campaigns", "compiled": true, "compiled_code": "\n\n\nwith campaigns as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__email_campaign\"\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        email_campaign_id,\n        \n        sum(email_sends.bounces) as total_bounces,\n        count(distinct case when email_sends.bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(email_sends.clicks) as total_clicks,\n        count(distinct case when email_sends.clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(email_sends.deferrals) as total_deferrals,\n        count(distinct case when email_sends.deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(email_sends.deliveries) as total_deliveries,\n        count(distinct case when email_sends.deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(email_sends.drops) as total_drops,\n        count(distinct case when email_sends.drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(email_sends.forwards) as total_forwards,\n        count(distinct case when email_sends.forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(email_sends.opens) as total_opens,\n        count(distinct case when email_sends.opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(email_sends.prints) as total_prints,\n        count(distinct case when email_sends.prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(email_sends.spam_reports) as total_spam_reports,\n        count(distinct case when email_sends.spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(email_sends.unsubscribes) as total_unsubscribes,\n        count(distinct case when email_sends.unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), joined as (\n\n    select \n        campaigns.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from campaigns\n    left join email_metrics\n        on campaigns.email_campaign_id = email_metrics.email_campaign_id\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_campaigns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:18.685478Z", "completed_at": "2024-05-10T02:39:18.695381Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:18.697293Z", "completed_at": "2024-05-10T02:39:18.697300Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02572488784790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_metrics__by_contact_list_contact_list_id.1d3cf4caf2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:18.689972Z", "completed_at": "2024-05-10T02:39:18.696074Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:18.697626Z", "completed_at": "2024-05-10T02:39:18.697630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02577996253967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_metrics__by_contact_list_contact_list_id.095d72d5b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:18.706228Z", "completed_at": "2024-05-10T02:39:18.710037Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:18.711221Z", "completed_at": "2024-05-10T02:39:18.711232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011976957321166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_campaigns_email_campaign_id.2470fabe62", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:18.701247Z", "completed_at": "2024-05-10T02:39:18.710442Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:18.711615Z", "completed_at": "2024-05-10T02:39:18.711619Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013062238693237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_campaigns_email_campaign_id.6b2d6f43c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:16.991919Z", "completed_at": "2024-05-10T02:39:18.689549Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:18.695062Z", "completed_at": "2024-05-10T02:39:18.695071Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.8566269874572754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__scd_daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__pivot_daily_ticket_history\"\n\n), set_values as (\n\n    select \n        date_day, \n        ticket_id,\n        id\n\n         \n        , hs_pipeline as hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_field_partition\n\n         \n        , hs_pipeline_stage as hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline_stage is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_stage_field_partition\n\n        \n    \n    from change_data\n\n), fill_values as (\n\n-- each row of the pivoted table includes ticket property values if that property was updated on that day\n-- we need to backfill to persist values that have been previously updated and are still valid \n    select \n        date_day, \n        ticket_id,\n        id\n        \n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n\n        \n\n    from set_values\n\n)\n\nselect *\nfrom fill_values", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__scd_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:18.676038Z", "completed_at": "2024-05-10T02:39:20.280890Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:20.283365Z", "completed_at": "2024-05-10T02:39:20.283400Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7135381698608398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_lists", "compiled": true, "compiled_code": "\n\nwith contact_lists as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__contact_list\"\n\n\n\n), email_metrics as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\n\n), joined as (\n    \n    select \n        contact_lists.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contact_lists\n    left join email_metrics\n        using (contact_list_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contact_lists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:20.393460Z", "completed_at": "2024-05-10T02:39:20.422844Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:20.426344Z", "completed_at": "2024-05-10T02:39:20.426357Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04017496109008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_lists_contact_list_id.3bde1bb891", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contact_lists\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:20.416548Z", "completed_at": "2024-05-10T02:39:20.427256Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:20.429863Z", "completed_at": "2024-05-10T02:39:20.429871Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.025722980499267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_lists_contact_list_id.ea9ef03bac", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__contact_lists\" where not coalesce(is_contact_list_deleted, false)) dbt_subquery\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:18.852408Z", "completed_at": "2024-05-10T02:39:20.425686Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:20.428509Z", "completed_at": "2024-05-10T02:39:20.428515Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7642791271209717, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__scd_daily_ticket_history\"\n\n\n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__daily_ticket_history\")\n\n-- If no issue fields have been updated since the last incremental run, the pivoted_daily_history CTE will return no record/rows.\n-- When this is the case, we need to grab the most recent day's records from the previously built table so that we can persist \n-- those values into the future.\n\n), most_recent_data as ( \n\n    select \n        *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__daily_ticket_history\"\n    where date_day = (select max(date_day) from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__daily_ticket_history\" )\n\n\n), calendar as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"int_hubspot__ticket_calendar_spine\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__daily_ticket_history\")\n    \n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_56_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\"\n\n), joined as (\n\n    select \n        calendar.date_day,\n        calendar.ticket_id\n            \n             \n            , coalesce(change_data.hs_pipeline, most_recent_data.hs_pipeline) as hs_pipeline\n             \n            , coalesce(change_data.hs_pipeline_stage, most_recent_data.hs_pipeline_stage) as hs_pipeline_stage\n            \n        \n        \n\n    from calendar\n    left join change_data\n        on calendar.ticket_id = change_data.ticket_id\n        and calendar.date_day = change_data.date_day\n    \n    \n    left join most_recent_data\n        on calendar.ticket_id = most_recent_data.ticket_id\n        and calendar.date_day = most_recent_data.date_day\n    \n\n), set_values as (\n\n    select \n        date_day,\n        ticket_id\n        \n        \n        , hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_partition\n        \n        , hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline_stage is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_stage_partition\n        \n\n    from joined\n\n), fill_values as (\n\n    select \n        date_day,\n        ticket_id\n\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n        \n\n    from set_values\n\n), fix_null_values as (\n\n    select \n        date_day,\n        ticket_id,\n        pipeline_stage.ticket_state,\n        pipeline.pipeline_label as hs_pipeline_label,\n        pipeline_stage.pipeline_stage_label as hs_pipeline_stage_label\n\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline as TEXT ) = 'is_null' then null else hs_pipeline end as hs_pipeline\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline_stage as TEXT ) = 'is_null' then null else hs_pipeline_stage end as hs_pipeline_stage\n        \n\n    from fill_values\n\n    left join pipeline \n        on cast(fill_values.hs_pipeline as integer) = pipeline.ticket_pipeline_id\n    left join pipeline_stage \n        on cast(fill_values.hs_pipeline_stage as integer) = pipeline_stage.ticket_pipeline_stage_id\n        and pipeline.ticket_pipeline_id = pipeline_stage.ticket_pipeline_id\n\n), surrogate as (\n\n    select\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as ticket_day_id,\n        *\n\n    from fix_null_values\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:20.619634Z", "completed_at": "2024-05-10T02:39:20.628437Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:20.629101Z", "completed_at": "2024-05-10T02:39:20.629110Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01239919662475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__daily_ticket_history_ticket_day_id.087496580e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_day_id\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-10T02:39:20.624354Z", "completed_at": "2024-05-10T02:39:20.630466Z"}, {"name": "execute", "started_at": "2024-05-10T02:39:20.631071Z", "completed_at": "2024-05-10T02:39:20.631076Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013242244720458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__daily_ticket_history_ticket_day_id.294440dc9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_56_hubspot\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is not null\ngroup by ticket_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 56.14516615867615, "args": {"log_format_file": "debug", "strict_mode": false, "cache_selected_only": false, "static_parser": true, "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests/logs", "log_format": "default", "macro_debugging": false, "vars": {}, "introspect": true, "partial_parse_file_diff": true, "write_json": true, "compile": true, "printer_width": 80, "exclude": [], "use_colors": true, "partial_parse": true, "print": true, "profiles_dir": "/Users/avinash.kunnath/.dbt", "use_colors_file": true, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests", "log_level_file": "debug", "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "enable_legacy_logger": false, "target": "postgres", "populate_cache": true, "which": "generate", "defer": false, "static": false, "select": [], "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "show_resource_report": false, "indirect_selection": "eager", "empty_catalog": false, "favor_state": false, "quiet": false, "require_explicit_package_overrides_for_builtin_materializations": false, "invocation_command": "dbt docs generate -t postgres", "version_check": true}}