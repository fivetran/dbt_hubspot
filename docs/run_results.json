{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-24T18:42:29.354109Z", "invocation_id": "51a06dd2-9e7b-4fe5-9b1d-6d2eb7bba819", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.063374Z", "completed_at": "2024-07-24T18:42:17.671583Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:17.672975Z", "completed_at": "2024-07-24T18:42:17.672990Z"}], "thread_id": "Thread-1", "execution_time": 0.6694400310516357, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"name\",\n  \"value\"\nfrom \"postgres\".\"zz_hubspot\".\"company_property_history_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.115913Z", "completed_at": "2024-07-24T18:42:17.672065Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:17.673391Z", "completed_at": "2024-07-24T18:42:17.673397Z"}], "thread_id": "Thread-8", "execution_time": 0.6622540950775146, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"deal_id\",\n  \"type_id\"\nfrom \"postgres\".\"zz_hubspot\".\"deal_company_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.103420Z", "completed_at": "2024-07-24T18:42:17.777748Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:17.778084Z", "completed_at": "2024-07-24T18:42:17.778092Z"}], "thread_id": "Thread-5", "execution_time": 0.8180229663848877, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_merge_audit_tmp", "compiled": true, "compiled_code": "\n\nselect \"canonical_vid\",\n  \"contact_id\",\n  \"vid_to_merge\",\n  \"_fivetran_synced\",\n  \"entity_id\",\n  \"first_name\",\n  \"last_name\",\n  \"num_properties_moved\",\n  \"timestamp\",\n  \"user_id\"\nfrom \"postgres\".\"zz_hubspot\".\"contact_merge_audit_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_merge_audit_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.107493Z", "completed_at": "2024-07-24T18:42:17.808152Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:17.809095Z", "completed_at": "2024-07-24T18:42:17.809099Z"}], "thread_id": "Thread-6", "execution_time": 0.8187289237976074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"value\",\n  \"source_id\"\nfrom \"postgres\".\"zz_hubspot\".\"contact_property_history_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.111681Z", "completed_at": "2024-07-24T18:42:17.807827Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:17.808804Z", "completed_at": "2024-07-24T18:42:17.808808Z"}], "thread_id": "Thread-7", "execution_time": 0.8129448890686035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_email\",\n  \"id\",\n  \"property_company\",\n  \"property_firstname\",\n  \"property_lastname\",\n  \"property_email_1\",\n  \"property_createdate\",\n  \"property_jobtitle\",\n  \"property_annualrevenue\",\n  \"property_hs_calculated_merged_vids\",\n  \"property_created_at\"\nfrom \"postgres\".\"zz_hubspot\".\"contact_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.094535Z", "completed_at": "2024-07-24T18:42:17.809363Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:17.809745Z", "completed_at": "2024-07-24T18:42:17.809749Z"}], "thread_id": "Thread-3", "execution_time": 0.8220400810241699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"contact_list_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"added_at\"\nfrom \"postgres\".\"zz_hubspot\".\"contact_list_member_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list_member_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.090001Z", "completed_at": "2024-07-24T18:42:17.820221Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:17.820552Z", "completed_at": "2024-07-24T18:42:17.820558Z"}], "thread_id": "Thread-2", "execution_time": 0.8230860233306885, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"is_deleted\"\nfrom \"postgres\".\"zz_hubspot\".\"company_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.098950Z", "completed_at": "2024-07-24T18:42:17.807512Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:17.808466Z", "completed_at": "2024-07-24T18:42:17.808472Z"}], "thread_id": "Thread-4", "execution_time": 0.8228929042816162, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"deleteable\",\n  \"dynamic\",\n  \"metadata_error\",\n  \"metadata_last_processing_state_change_at\",\n  \"metadata_last_size_change_at\",\n  \"metadata_processing\",\n  \"metadata_size\",\n  \"offset\",\n  \"portal_id\",\n  \"updated_at\",\n  \"name\"\nfrom \"postgres\".\"zz_hubspot\".\"contact_list_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.732220Z", "completed_at": "2024-07-24T18:42:18.475135Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:18.475565Z", "completed_at": "2024-07-24T18:42:18.475580Z"}], "thread_id": "Thread-1", "execution_time": 0.8224210739135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"deal_id\",\n  \"_fivetran_synced\",\n  \"type_id\"\nfrom \"postgres\".\"zz_hubspot\".\"deal_contact_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.892203Z", "completed_at": "2024-07-24T18:42:18.557956Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:18.559387Z", "completed_at": "2024-07-24T18:42:18.559393Z"}], "thread_id": "Thread-5", "execution_time": 0.7447860240936279, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"zz_hubspot\".\"deal_pipeline_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.753987Z", "completed_at": "2024-07-24T18:42:18.556703Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:18.558970Z", "completed_at": "2024-07-24T18:42:18.558977Z"}], "thread_id": "Thread-8", "execution_time": 0.8841009140014648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"closed_won\",\n  \"display_order\",\n  \"probability\",\n  \"stage_id\",\n  \"label\",\n  \"pipeline_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"zz_hubspot\".\"deal_pipeline_stage_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.905726Z", "completed_at": "2024-07-24T18:42:18.639963Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:18.649171Z", "completed_at": "2024-07-24T18:42:18.649179Z"}], "thread_id": "Thread-7", "execution_time": 0.8183162212371826, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"deal_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"date_entered\",\n  \"source\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"zz_hubspot\".\"deal_stage_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.921681Z", "completed_at": "2024-07-24T18:42:18.666298Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:18.666618Z", "completed_at": "2024-07-24T18:42:18.666624Z"}], "thread_id": "Thread-4", "execution_time": 0.8328831195831299, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"category\",\n  \"status\",\n  \"response\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_bounce_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_bounce_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.899955Z", "completed_at": "2024-07-24T18:42:18.668013Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:18.668296Z", "completed_at": "2024-07-24T18:42:18.668300Z"}], "thread_id": "Thread-6", "execution_time": 0.8353731632232666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"zz_hubspot\".\"deal_property_history_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.911398Z", "completed_at": "2024-07-24T18:42:18.666954Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:18.667215Z", "completed_at": "2024-07-24T18:42:18.667219Z"}], "thread_id": "Thread-3", "execution_time": 0.8358116149902344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"owner_id\",\n  \"deal_pipeline_id\",\n  \"deal_pipeline_stage_id\",\n  \"is_deleted\"\nfrom \"postgres\".\"zz_hubspot\".\"deal_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:17.916460Z", "completed_at": "2024-07-24T18:42:18.667477Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:18.667759Z", "completed_at": "2024-07-24T18:42:18.667763Z"}], "thread_id": "Thread-2", "execution_time": 0.8358898162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"content_id\",\n  \"num_included\",\n  \"num_queued\",\n  \"sub_type\",\n  \"type\",\n  \"app_name\",\n  \"name\",\n  \"subject\"\nfrom \"postgres\".\"zz_hubspot\".\"email_campaign_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:18.560192Z", "completed_at": "2024-07-24T18:42:19.264024Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:19.264453Z", "completed_at": "2024-07-24T18:42:19.264467Z"}], "thread_id": "Thread-1", "execution_time": 0.7560141086578369, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"referer\",\n  \"browser\",\n  \"location\",\n  \"ip_address\",\n  \"url\",\n  \"user_agent\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_click_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_click_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:18.649824Z", "completed_at": "2024-07-24T18:42:19.381659Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:19.382119Z", "completed_at": "2024-07-24T18:42:19.382126Z"}], "thread_id": "Thread-8", "execution_time": 0.8201868534088135, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"response\",\n  \"smtp_id\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_delivered_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_delivered_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:18.728832Z", "completed_at": "2024-07-24T18:42:19.472720Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:19.473262Z", "completed_at": "2024-07-24T18:42:19.473265Z"}], "thread_id": "Thread-4", "execution_time": 0.8788988590240479, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_forward_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_forward_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:18.640312Z", "completed_at": "2024-07-24T18:42:19.484495Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:19.484982Z", "completed_at": "2024-07-24T18:42:19.484987Z"}], "thread_id": "Thread-5", "execution_time": 0.968142032623291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"attempt\",\n  \"response\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_deferred_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_deferred_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:18.709030Z", "completed_at": "2024-07-24T18:42:19.484739Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:19.485431Z", "completed_at": "2024-07-24T18:42:19.485434Z"}], "thread_id": "Thread-7", "execution_time": 0.8986191749572754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"drop_reason\",\n  \"bcc\",\n  \"cc\",\n  \"drop_message\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_dropped_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_dropped_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:18.734176Z", "completed_at": "2024-07-24T18:42:19.485207Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:19.485679Z", "completed_at": "2024-07-24T18:42:19.485683Z"}], "thread_id": "Thread-6", "execution_time": 0.8809800148010254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"duration\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_open_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_open_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:18.745210Z", "completed_at": "2024-07-24T18:42:19.471972Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:19.472482Z", "completed_at": "2024-07-24T18:42:19.472488Z"}], "thread_id": "Thread-2", "execution_time": 0.8796157836914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bcc\",\n  \"cc\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_sent_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_sent_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:18.740571Z", "completed_at": "2024-07-24T18:42:19.472238Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:19.472966Z", "completed_at": "2024-07-24T18:42:19.472970Z"}], "thread_id": "Thread-3", "execution_time": 0.8809380531311035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_print_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_print_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:19.317480Z", "completed_at": "2024-07-24T18:42:20.173108Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.173672Z", "completed_at": "2024-07-24T18:42:20.173690Z"}], "thread_id": "Thread-1", "execution_time": 0.9225258827209473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"ip_address\",\n  \"user_agent\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_spam_report_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_spam_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:19.465053Z", "completed_at": "2024-07-24T18:42:20.251654Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.252244Z", "completed_at": "2024-07-24T18:42:20.252253Z"}], "thread_id": "Thread-8", "execution_time": 0.8388938903808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bounced\",\n  \"portal_subscription_status\",\n  \"requested_by\",\n  \"source\",\n  \"subscriptions\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_status_change_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_status_change_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:19.635825Z", "completed_at": "2024-07-24T18:42:20.367380Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.368124Z", "completed_at": "2024-07-24T18:42:20.368129Z"}], "thread_id": "Thread-6", "execution_time": 0.8045239448547363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_contact_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:19.646703Z", "completed_at": "2024-07-24T18:42:20.366996Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.367738Z", "completed_at": "2024-07-24T18:42:20.367750Z"}], "thread_id": "Thread-3", "execution_time": 0.8157539367675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_all_owner_ids\",\n  \"property_hs_all_team_ids\",\n  \"property_hs_createdate\",\n  \"property_hs_email_subject\",\n  \"property_hs_email_text\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_modified_by\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_email_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_email_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:19.641514Z", "completed_at": "2024-07-24T18:42:20.526038Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.528921Z", "completed_at": "2024-07-24T18:42:20.528934Z"}], "thread_id": "Thread-2", "execution_time": 0.9682779312133789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_deal_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:19.624075Z", "completed_at": "2024-07-24T18:42:20.529708Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.530459Z", "completed_at": "2024-07-24T18:42:20.530465Z"}], "thread_id": "Thread-5", "execution_time": 0.9705548286437988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_timestamp\",\n  \"type\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_call_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_call_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:19.629675Z", "completed_at": "2024-07-24T18:42:20.530100Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.531172Z", "completed_at": "2024-07-24T18:42:20.531178Z"}], "thread_id": "Thread-7", "execution_time": 0.9741859436035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_company_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:19.616351Z", "completed_at": "2024-07-24T18:42:20.530815Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.531570Z", "completed_at": "2024-07-24T18:42:20.531576Z"}], "thread_id": "Thread-4", "execution_time": 0.9825773239135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"caused_by_created\",\n  \"caused_by_id\",\n  \"created\",\n  \"email_campaign_id\",\n  \"obsoleted_by_created\",\n  \"obsoleted_by_id\",\n  \"portal_id\",\n  \"sent_by_created\",\n  \"sent_by_id\",\n  \"type\",\n  \"filtered_event\",\n  \"recipient\"\nfrom \"postgres\".\"zz_hubspot\".\"email_event_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.242104Z", "completed_at": "2024-07-24T18:42:20.929468Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:20.929723Z", "completed_at": "2024-07-24T18:42:20.929731Z"}], "thread_id": "Thread-1", "execution_time": 0.7555460929870605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_synced\",\n  \"created_from_link_id\",\n  \"end_time\",\n  \"pre_meeting_prospect_reminders\",\n  \"source\",\n  \"source_id\",\n  \"start_time\",\n  \"web_conference_meeting_id\",\n  \"meeting_outcome\",\n  \"body\",\n  \"external_url\",\n  \"title\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_meeting_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_meeting_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.420698Z", "completed_at": "2024-07-24T18:42:21.056442Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.056742Z", "completed_at": "2024-07-24T18:42:21.056750Z"}], "thread_id": "Thread-6", "execution_time": 0.7022478580474854, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_object_id\",\n  \"property_hs_task_type\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\",\n  \"task_type\",\n  \"property_hs_engagement_source\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_task_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_task_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.432502Z", "completed_at": "2024-07-24T18:42:21.059137Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.059410Z", "completed_at": "2024-07-24T18:42:21.059415Z"}], "thread_id": "Thread-3", "execution_time": 0.6908690929412842, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"type\",\n  \"_fivetran_synced\",\n  \"portal_id\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.305179Z", "completed_at": "2024-07-24T18:42:21.066599Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.066865Z", "completed_at": "2024-07-24T18:42:21.066870Z"}], "thread_id": "Thread-8", "execution_time": 0.8196282386779785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_body_preview\",\n  \"property_hs_createdate\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_note_body\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"zz_hubspot\".\"engagement_note_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_note_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.598876Z", "completed_at": "2024-07-24T18:42:21.173607Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.173875Z", "completed_at": "2024-07-24T18:42:21.173883Z"}], "thread_id": "Thread-5", "execution_time": 0.6919498443603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner_tmp", "compiled": true, "compiled_code": "\n\nselect \"owner_id\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"portal_id\",\n  \"type\",\n  \"updated_at\",\n  \"email\",\n  \"first_name\",\n  \"last_name\"\nfrom \"postgres\".\"zz_hubspot\".\"owner_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__owner_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.613444Z", "completed_at": "2024-07-24T18:42:21.295087Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.296593Z", "completed_at": "2024-07-24T18:42:21.296601Z"}], "thread_id": "Thread-4", "execution_time": 0.7477169036865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_id\",\n  \"_fivetran_synced\",\n  \"calculated\",\n  \"created_at\",\n  \"description\",\n  \"field_type\",\n  \"group_name\",\n  \"hubspot_defined\",\n  \"hubspot_object\",\n  \"label\",\n  \"name\",\n  \"show_currency_symbol\",\n  \"type\",\n  \"updated_at\"\nfrom \"postgres\".\"zz_hubspot\".\"property_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.588193Z", "completed_at": "2024-07-24T18:42:21.297276Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.298215Z", "completed_at": "2024-07-24T18:42:21.298218Z"}], "thread_id": "Thread-2", "execution_time": 0.7792599201202393, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__merged_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"merged_deal_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"zz_hubspot\".\"merged_deal_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__merged_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.607814Z", "completed_at": "2024-07-24T18:42:21.296943Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.297911Z", "completed_at": "2024-07-24T18:42:21.297916Z"}], "thread_id": "Thread-7", "execution_time": 0.7585139274597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option_tmp", "compiled": true, "compiled_code": "\n\nselect \"label\",\n  \"property_id\",\n  \"_fivetran_synced\",\n  \"display_order\",\n  \"hidden\",\n  \"value\"\nfrom \"postgres\".\"zz_hubspot\".\"property_option_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property_option_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.372447Z", "completed_at": "2024-07-24T18:42:21.374636Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.375272Z", "completed_at": "2024-07-24T18:42:21.375278Z"}], "thread_id": "Thread-7", "execution_time": 0.009501934051513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.377036Z", "completed_at": "2024-07-24T18:42:21.378751Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.379042Z", "completed_at": "2024-07-24T18:42:21.379047Z"}], "thread_id": "Thread-7", "execution_time": 0.002653837203979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.380392Z", "completed_at": "2024-07-24T18:42:21.382045Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.382364Z", "completed_at": "2024-07-24T18:42:21.382369Z"}], "thread_id": "Thread-7", "execution_time": 0.002686023712158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.383607Z", "completed_at": "2024-07-24T18:42:21.385188Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.385492Z", "completed_at": "2024-07-24T18:42:21.385496Z"}], "thread_id": "Thread-7", "execution_time": 0.0024809837341308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.386721Z", "completed_at": "2024-07-24T18:42:21.388265Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.388496Z", "completed_at": "2024-07-24T18:42:21.388499Z"}], "thread_id": "Thread-7", "execution_time": 0.0023360252380371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_member_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.389626Z", "completed_at": "2024-07-24T18:42:21.434969Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.435303Z", "completed_at": "2024-07-24T18:42:21.435309Z"}], "thread_id": "Thread-7", "execution_time": 0.046276092529296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_merge_audit_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.436312Z", "completed_at": "2024-07-24T18:42:21.437559Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.437803Z", "completed_at": "2024-07-24T18:42:21.437807Z"}], "thread_id": "Thread-7", "execution_time": 0.001981019973754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.438807Z", "completed_at": "2024-07-24T18:42:21.440000Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.440209Z", "completed_at": "2024-07-24T18:42:21.440213Z"}], "thread_id": "Thread-7", "execution_time": 0.0018680095672607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.441177Z", "completed_at": "2024-07-24T18:42:21.442437Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.442712Z", "completed_at": "2024-07-24T18:42:21.442717Z"}], "thread_id": "Thread-7", "execution_time": 0.0020427703857421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.444033Z", "completed_at": "2024-07-24T18:42:21.445389Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.445599Z", "completed_at": "2024-07-24T18:42:21.445604Z"}], "thread_id": "Thread-7", "execution_time": 0.002313852310180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.446586Z", "completed_at": "2024-07-24T18:42:21.448480Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.448683Z", "completed_at": "2024-07-24T18:42:21.448687Z"}], "thread_id": "Thread-7", "execution_time": 0.0025451183319091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.449627Z", "completed_at": "2024-07-24T18:42:21.450784Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.450981Z", "completed_at": "2024-07-24T18:42:21.450983Z"}], "thread_id": "Thread-7", "execution_time": 0.001790761947631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.451871Z", "completed_at": "2024-07-24T18:42:21.453117Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.453514Z", "completed_at": "2024-07-24T18:42:21.453520Z"}], "thread_id": "Thread-7", "execution_time": 0.002123117446899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.454726Z", "completed_at": "2024-07-24T18:42:21.456192Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.456426Z", "completed_at": "2024-07-24T18:42:21.456431Z"}], "thread_id": "Thread-7", "execution_time": 0.002229928970336914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.457390Z", "completed_at": "2024-07-24T18:42:21.458603Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.458814Z", "completed_at": "2024-07-24T18:42:21.458817Z"}], "thread_id": "Thread-7", "execution_time": 0.0018608570098876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_campaign_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.459738Z", "completed_at": "2024-07-24T18:42:21.460939Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.461131Z", "completed_at": "2024-07-24T18:42:21.461134Z"}], "thread_id": "Thread-7", "execution_time": 0.001833200454711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_bounce_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.462031Z", "completed_at": "2024-07-24T18:42:21.464050Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.464244Z", "completed_at": "2024-07-24T18:42:21.464248Z"}], "thread_id": "Thread-7", "execution_time": 0.0026438236236572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_click_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.465172Z", "completed_at": "2024-07-24T18:42:21.466318Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.466508Z", "completed_at": "2024-07-24T18:42:21.466511Z"}], "thread_id": "Thread-7", "execution_time": 0.0018041133880615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.467402Z", "completed_at": "2024-07-24T18:42:21.468550Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.468739Z", "completed_at": "2024-07-24T18:42:21.468742Z"}], "thread_id": "Thread-7", "execution_time": 0.0017650127410888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_deferred_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.469643Z", "completed_at": "2024-07-24T18:42:21.470788Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.470993Z", "completed_at": "2024-07-24T18:42:21.470996Z"}], "thread_id": "Thread-7", "execution_time": 0.0017821788787841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_delivered_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.471893Z", "completed_at": "2024-07-24T18:42:21.473066Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.473265Z", "completed_at": "2024-07-24T18:42:21.473268Z"}], "thread_id": "Thread-7", "execution_time": 0.0018002986907958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_dropped_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.474156Z", "completed_at": "2024-07-24T18:42:21.475992Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.476195Z", "completed_at": "2024-07-24T18:42:21.476202Z"}], "thread_id": "Thread-7", "execution_time": 0.0024688243865966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_forward_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.477093Z", "completed_at": "2024-07-24T18:42:21.478242Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.478425Z", "completed_at": "2024-07-24T18:42:21.478428Z"}], "thread_id": "Thread-7", "execution_time": 0.0017621517181396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_open_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.479305Z", "completed_at": "2024-07-24T18:42:21.480466Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.480654Z", "completed_at": "2024-07-24T18:42:21.480657Z"}], "thread_id": "Thread-7", "execution_time": 0.001766204833984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_print_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.481543Z", "completed_at": "2024-07-24T18:42:21.482668Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.482866Z", "completed_at": "2024-07-24T18:42:21.482869Z"}], "thread_id": "Thread-7", "execution_time": 0.0017468929290771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_sent_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.483759Z", "completed_at": "2024-07-24T18:42:21.484930Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.485120Z", "completed_at": "2024-07-24T18:42:21.485123Z"}], "thread_id": "Thread-7", "execution_time": 0.0017910003662109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_spam_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.486002Z", "completed_at": "2024-07-24T18:42:21.487885Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.488080Z", "completed_at": "2024-07-24T18:42:21.488084Z"}], "thread_id": "Thread-7", "execution_time": 0.0025038719177246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_status_change_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.488974Z", "completed_at": "2024-07-24T18:42:21.490139Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.490332Z", "completed_at": "2024-07-24T18:42:21.490335Z"}], "thread_id": "Thread-7", "execution_time": 0.0017859935760498047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_call_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.491231Z", "completed_at": "2024-07-24T18:42:21.492448Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.492668Z", "completed_at": "2024-07-24T18:42:21.492671Z"}], "thread_id": "Thread-7", "execution_time": 0.0018780231475830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.493993Z", "completed_at": "2024-07-24T18:42:21.495352Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.495570Z", "completed_at": "2024-07-24T18:42:21.495577Z"}], "thread_id": "Thread-7", "execution_time": 0.002131938934326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.496521Z", "completed_at": "2024-07-24T18:42:21.497792Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.498015Z", "completed_at": "2024-07-24T18:42:21.498021Z"}], "thread_id": "Thread-7", "execution_time": 0.0019452571868896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.498932Z", "completed_at": "2024-07-24T18:42:21.500900Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.501103Z", "completed_at": "2024-07-24T18:42:21.501107Z"}], "thread_id": "Thread-7", "execution_time": 0.002609729766845703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.502023Z", "completed_at": "2024-07-24T18:42:21.503189Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.503377Z", "completed_at": "2024-07-24T18:42:21.503380Z"}], "thread_id": "Thread-7", "execution_time": 0.0017910003662109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.504265Z", "completed_at": "2024-07-24T18:42:21.505422Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.505611Z", "completed_at": "2024-07-24T18:42:21.505614Z"}], "thread_id": "Thread-7", "execution_time": 0.0017652511596679688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_meeting_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.506486Z", "completed_at": "2024-07-24T18:42:21.507628Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.507812Z", "completed_at": "2024-07-24T18:42:21.507820Z"}], "thread_id": "Thread-7", "execution_time": 0.0017468929290771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_note_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.508756Z", "completed_at": "2024-07-24T18:42:21.509899Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.510085Z", "completed_at": "2024-07-24T18:42:21.510088Z"}], "thread_id": "Thread-7", "execution_time": 0.001753091812133789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_task_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.510974Z", "completed_at": "2024-07-24T18:42:21.512117Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.512301Z", "completed_at": "2024-07-24T18:42:21.512304Z"}], "thread_id": "Thread-7", "execution_time": 0.0017578601837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.merged_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.513180Z", "completed_at": "2024-07-24T18:42:21.515081Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.515268Z", "completed_at": "2024-07-24T18:42:21.515271Z"}], "thread_id": "Thread-7", "execution_time": 0.0025107860565185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.owner_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.516159Z", "completed_at": "2024-07-24T18:42:21.517327Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.517512Z", "completed_at": "2024-07-24T18:42:21.517516Z"}], "thread_id": "Thread-7", "execution_time": 0.0017871856689453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.518410Z", "completed_at": "2024-07-24T18:42:21.519541Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.519726Z", "completed_at": "2024-07-24T18:42:21.519729Z"}], "thread_id": "Thread-7", "execution_time": 0.0017387866973876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_option_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.520642Z", "completed_at": "2024-07-24T18:42:21.521779Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.521970Z", "completed_at": "2024-07-24T18:42:21.521973Z"}], "thread_id": "Thread-7", "execution_time": 0.001783609390258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.522841Z", "completed_at": "2024-07-24T18:42:21.524045Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.524233Z", "completed_at": "2024-07-24T18:42:21.524236Z"}], "thread_id": "Thread-7", "execution_time": 0.0018129348754882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.525114Z", "completed_at": "2024-07-24T18:42:21.526955Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.527138Z", "completed_at": "2024-07-24T18:42:21.527141Z"}], "thread_id": "Thread-7", "execution_time": 0.0024421215057373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.528016Z", "completed_at": "2024-07-24T18:42:21.529159Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.529344Z", "completed_at": "2024-07-24T18:42:21.529347Z"}], "thread_id": "Thread-7", "execution_time": 0.0017540454864501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.530227Z", "completed_at": "2024-07-24T18:42:21.531380Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.531565Z", "completed_at": "2024-07-24T18:42:21.531568Z"}], "thread_id": "Thread-7", "execution_time": 0.0017499923706054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.532468Z", "completed_at": "2024-07-24T18:42:21.533590Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.533775Z", "completed_at": "2024-07-24T18:42:21.533778Z"}], "thread_id": "Thread-7", "execution_time": 0.0017619132995605469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.534786Z", "completed_at": "2024-07-24T18:42:21.535946Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.536153Z", "completed_at": "2024-07-24T18:42:21.536156Z"}], "thread_id": "Thread-7", "execution_time": 0.0019230842590332031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.537087Z", "completed_at": "2024-07-24T18:42:21.538971Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.539176Z", "completed_at": "2024-07-24T18:42:21.539180Z"}], "thread_id": "Thread-7", "execution_time": 0.0025353431701660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:20.998750Z", "completed_at": "2024-07-24T18:42:21.878060Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.878486Z", "completed_at": "2024-07-24T18:42:21.878498Z"}], "thread_id": "Thread-1", "execution_time": 0.9427080154418945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"company_id\"\nfrom \"postgres\".\"zz_hubspot\".\"ticket_company_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.126704Z", "completed_at": "2024-07-24T18:42:21.958338Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:21.958724Z", "completed_at": "2024-07-24T18:42:21.958733Z"}], "thread_id": "Thread-6", "execution_time": 0.9011499881744385, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"contact_id\"\nfrom \"postgres\".\"zz_hubspot\".\"ticket_contact_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.139327Z", "completed_at": "2024-07-24T18:42:22.008641Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.009161Z", "completed_at": "2024-07-24T18:42:22.009173Z"}], "thread_id": "Thread-8", "execution_time": 0.9469687938690186, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"stage_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"is_closed\",\n  \"label\",\n  \"pipeline_id\",\n  \"ticket_state\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"zz_hubspot\".\"ticket_pipeline_stage_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.132747Z", "completed_at": "2024-07-24T18:42:22.083756Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.084224Z", "completed_at": "2024-07-24T18:42:22.084232Z"}], "thread_id": "Thread-3", "execution_time": 1.018667221069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"engagement_id\"\nfrom \"postgres\".\"zz_hubspot\".\"ticket_engagement_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.288818Z", "completed_at": "2024-07-24T18:42:22.145504Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.146552Z", "completed_at": "2024-07-24T18:42:22.146559Z"}], "thread_id": "Thread-5", "execution_time": 0.9162731170654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"object_type_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"zz_hubspot\".\"ticket_pipeline_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.540136Z", "completed_at": "2024-07-24T18:42:22.247104Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.247674Z", "completed_at": "2024-07-24T18:42:22.247681Z"}], "thread_id": "Thread-7", "execution_time": 0.7586932182312012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_company_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.366737Z", "completed_at": "2024-07-24T18:42:22.247931Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.248460Z", "completed_at": "2024-07-24T18:42:22.248464Z"}], "thread_id": "Thread-2", "execution_time": 0.933506965637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"id\",\n  \"is_deleted\",\n  \"property_closed_date\",\n  \"property_createdate\",\n  \"property_first_agent_reply_date\",\n  \"property_hs_pipeline\",\n  \"property_hs_pipeline_stage\",\n  \"property_hs_ticket_category\",\n  \"property_hs_ticket_priority\",\n  \"property_hubspot_owner_id\",\n  \"property_subject\",\n  \"property_content\"\nfrom \"postgres\".\"zz_hubspot\".\"ticket_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.355628Z", "completed_at": "2024-07-24T18:42:22.247410Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.248177Z", "completed_at": "2024-07-24T18:42:22.248180Z"}], "thread_id": "Thread-4", "execution_time": 0.9451301097869873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"name\",\n  \"ticket_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"timestamp_instant\",\n  \"value\"\nfrom \"postgres\".\"zz_hubspot\".\"ticket_property_history_data\"", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:21.943402Z", "completed_at": "2024-07-24T18:42:22.658835Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.659382Z", "completed_at": "2024-07-24T18:42:22.659399Z"}], "thread_id": "Thread-1", "execution_time": 0.7752840518951416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_company_tmp\"\n\n), macro as (\n\n    select \n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        company_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.075337Z", "completed_at": "2024-07-24T18:42:22.791388Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.791832Z", "completed_at": "2024-07-24T18:42:22.791835Z"}], "thread_id": "Thread-8", "execution_time": 0.7748537063598633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        contact_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_contact_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.028707Z", "completed_at": "2024-07-24T18:42:22.791169Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.791606Z", "completed_at": "2024-07-24T18:42:22.791612Z"}], "thread_id": "Thread-6", "execution_time": 0.8224539756774902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_merge_audit", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_merge_audit_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    canonical_vid\n    \n as \n    \n    canonical_vid\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    entity_id\n    \n as \n    \n    entity_id\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    num_properties_moved\n    \n as \n    \n    num_properties_moved\n    \n, \n    \n    \n    timestamp\n    \n as \n    \n    timestamp\n    \n, \n    \n    \n    user_id\n    \n as \n    \n    user_id\n    \n, \n    \n    \n    vid_to_merge\n    \n as \n    \n    vid_to_merge\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        canonical_vid,\n        contact_id,\n        entity_id,\n        first_name,\n        last_name,\n        num_properties_moved,\n        cast( \n        timestamp\n        as timestamp) as timestamp_at,\n        user_id,\n        vid_to_merge,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_merge_audit\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.147721Z", "completed_at": "2024-07-24T18:42:22.882433Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.883054Z", "completed_at": "2024-07-24T18:42:22.883060Z"}], "thread_id": "Thread-3", "execution_time": 0.7870452404022217, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as is_contact_deleted , \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as contact_id , \n    \n    \n    property_hs_calculated_merged_vids\n    \n as calculated_merged_vids , \n    \n    \n    property_email\n    \n as email , \n    \n    \n    property_company\n    \n as contact_company , \n    \n    \n    property_firstname\n    \n as first_name , \n    \n    \n    property_lastname\n    \n as last_name , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_jobtitle\n    \n as job_title , \n    \n    \n    property_annualrevenue\n    \n as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns.\n        -- a few columns below are aliased within the macros/get_contact_columns.sql macro\n        contact_id,\n        is_contact_deleted,\n        calculated_merged_vids, -- will be null for BigQuery users until v3 api is rolled out to them\n        email,\n        contact_company,\n        first_name,\n        last_name,\n        cast(created_date as timestamp) as created_date,\n        job_title,\n        company_annual_revenue,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n\n        --The below macro adds the fields defined within your hubspot__contact_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__contact_calculated_fields variable.\n        \n\n\n\n    from macro\n    \n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.206303Z", "completed_at": "2024-07-24T18:42:22.915867Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:22.916129Z", "completed_at": "2024-07-24T18:42:22.916135Z"}], "thread_id": "Thread-5", "execution_time": 0.7968339920043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list_member_tmp\" \n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    added_at\n    \n as \n    \n    added_at\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    contact_list_id\n    \n as \n    \n    contact_list_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_member_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(added_at as timestamp) as added_timestamp,\n        contact_id,\n        contact_list_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list_member\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.312643Z", "completed_at": "2024-07-24T18:42:23.033545Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:23.033817Z", "completed_at": "2024-07-24T18:42:23.033824Z"}], "thread_id": "Thread-2", "execution_time": 0.8181881904602051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    deleteable\n    \n as \n    \n    deleteable\n    \n, \n    \n    \n    dynamic\n    \n as \n    \n    dynamic\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metadata_error\n    \n as \n    \n    metadata_error\n    \n, \n    \n    \n    metadata_last_processing_state_change_at\n    \n as \n    \n    metadata_last_processing_state_change_at\n    \n, \n    \n    \n    metadata_last_size_change_at\n    \n as \n    \n    metadata_last_size_change_at\n    \n, \n    \n    \n    metadata_processing\n    \n as \n    \n    metadata_processing\n    \n, \n    \n    \n    metadata_size\n    \n as \n    \n    metadata_size\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        deleteable as is_deletable,\n        dynamic as is_dynamic,\n        id as contact_list_id,\n        metadata_error,\n        cast(metadata_last_processing_state_change_at as timestamp) as metadata_last_processing_state_change_at,\n        cast(metadata_last_size_change_at as timestamp) as metadata_last_size_change_at,\n        metadata_processing,\n        metadata_size,\n        name as contact_list_name,\n        portal_id,\n        cast(updated_at as timestamp) as updated_timestamp\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.318757Z", "completed_at": "2024-07-24T18:42:23.127833Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:23.131156Z", "completed_at": "2024-07-24T18:42:23.131163Z"}], "thread_id": "Thread-4", "execution_time": 0.8795630931854248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_contact_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        contact_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.302822Z", "completed_at": "2024-07-24T18:42:23.128153Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:23.131452Z", "completed_at": "2024-07-24T18:42:23.131457Z"}], "thread_id": "Thread-7", "execution_time": 0.9538500308990479, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    id\n    \n as company_id , \n    \n    \n    is_deleted\n    \n as is_company_deleted , \n    cast(null as TEXT) as company_name , \n    cast(null as TEXT) as description , \n    cast(null as timestamp) as created_date , \n    cast(null as TEXT) as industry , \n    cast(null as TEXT) as street_address , \n    cast(null as TEXT) as street_address_2 , \n    cast(null as TEXT) as city , \n    cast(null as TEXT) as state , \n    cast(null as TEXT) as country , \n    cast(null as integer) as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_company_columns.sql macro\n        company_id,\n        is_company_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_name,\n        description,\n        created_date,\n        industry,\n        street_address,\n        street_address_2,\n        city,\n        state,\n        country,\n        company_annual_revenue\n        \n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__company_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.720468Z", "completed_at": "2024-07-24T18:42:23.529277Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:23.529681Z", "completed_at": "2024-07-24T18:42:23.529692Z"}], "thread_id": "Thread-1", "execution_time": 0.9209818840026855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        cast(pipeline_id as TEXT) as deal_pipeline_id,\n        created_at as deal_pipeline_created_at,\n        updated_at as deal_pipeline_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.872124Z", "completed_at": "2024-07-24T18:42:23.656365Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:23.656674Z", "completed_at": "2024-07-24T18:42:23.656679Z"}], "thread_id": "Thread-8", "execution_time": 0.9051530361175537, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    closed_won\n    \n as \n    \n    closed_won\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    probability\n    \n as \n    \n    probability\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        closed_won as is_closed_won,\n        display_order,\n        label as pipeline_stage_label,\n        pipeline_id as deal_pipeline_id,\n        probability,\n        cast(stage_id as TEXT) as deal_pipeline_stage_id,\n        created_at as deal_pipeline_stage_created_at,\n        updated_at as deal_pipeline_stage_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.877391Z", "completed_at": "2024-07-24T18:42:23.655630Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:23.656077Z", "completed_at": "2024-07-24T18:42:23.656084Z"}], "thread_id": "Thread-6", "execution_time": 0.9065871238708496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_active\n    \n as \n    \n    _fivetran_active\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    date_entered\n    \n as \n    \n    date_entered\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date_entered as timestamp) as date_entered,\n        deal_id,\n        source,\n        source_id,\n        value as deal_stage_name,\n        _fivetran_active,\n        cast(_fivetran_end as timestamp) as _fivetran_end,\n        cast(_fivetran_start as timestamp) as _fivetran_start\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:22.935265Z", "completed_at": "2024-07-24T18:42:23.780276Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:23.789690Z", "completed_at": "2024-07-24T18:42:23.789699Z"}], "thread_id": "Thread-3", "execution_time": 0.9385221004486084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_bounce_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    category\n    \n as \n    \n    category\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n    from base\n    \n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        category as bounce_category,\n        id as event_id,\n        response as returned_response,\n        status as returned_status\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:23.004585Z", "completed_at": "2024-07-24T18:42:23.887386Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:23.887883Z", "completed_at": "2024-07-24T18:42:23.887891Z"}], "thread_id": "Thread-5", "execution_time": 1.0272440910339355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_deal_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:23.121289Z", "completed_at": "2024-07-24T18:42:24.049599Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:24.050258Z", "completed_at": "2024-07-24T18:42:24.050266Z"}], "thread_id": "Thread-2", "execution_time": 1.0077171325683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    deal_pipeline_id\n    \n as \n    \n    deal_pipeline_id\n    \n, \n    \n    \n    deal_pipeline_stage_id\n    \n as \n    \n    deal_pipeline_stage_id\n    \n, \n    \n    \n    is_deleted\n    \n as is_deal_deleted , \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    cast(null as integer) as \n    \n    portal_id\n    \n , \n    cast(null as TEXT) as deal_name , \n    cast(null as TEXT) as description , \n    cast(null as integer) as amount , \n    cast(null as timestamp) as closed_date , \n    cast(null as timestamp) as created_date \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_deal_columns.sql macro\n        deal_name,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        is_deal_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        cast(deal_pipeline_id as TEXT) as deal_pipeline_id,\n        cast(deal_pipeline_stage_id as TEXT) as deal_pipeline_stage_id,\n        owner_id,\n        portal_id,\n        description,\n        amount\n\n        --The below macro adds the fields defined within your hubspot__deal_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__deal_calculated_fields variable.\n        \n\n\n\n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:23.183749Z", "completed_at": "2024-07-24T18:42:24.142768Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:24.143148Z", "completed_at": "2024-07-24T18:42:24.143160Z"}], "thread_id": "Thread-4", "execution_time": 1.1042990684509277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_campaign_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    content_id\n    \n as \n    \n    content_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    num_included\n    \n as \n    \n    num_included\n    \n, \n    \n    \n    num_queued\n    \n as \n    \n    num_queued\n    \n, \n    \n    \n    sub_type\n    \n as \n    \n    sub_type\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        app_name,\n        content_id,\n        id as email_campaign_id,\n        name as email_campaign_name,\n        num_included,\n        num_queued,\n        sub_type as email_campaign_sub_type,\n        subject as email_campaign_subject,\n        type as email_campaign_type\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:23.256983Z", "completed_at": "2024-07-24T18:42:24.297549Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:24.298258Z", "completed_at": "2024-07-24T18:42:24.298266Z"}], "thread_id": "Thread-7", "execution_time": 1.1728980541229248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_click_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    referer\n    \n as \n    \n    referer\n    \n, \n    \n    \n    url\n    \n as \n    \n    url\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        referer as referer_url,\n        url as click_url,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_click\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:23.647829Z", "completed_at": "2024-07-24T18:42:24.650098Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:24.650494Z", "completed_at": "2024-07-24T18:42:24.650506Z"}], "thread_id": "Thread-1", "execution_time": 1.0908398628234863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_delivered_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    smtp_id\n    \n as \n    \n    smtp_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        response as returned_response,\n        smtp_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:23.878796Z", "completed_at": "2024-07-24T18:42:24.909732Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:24.910105Z", "completed_at": "2024-07-24T18:42:24.910117Z"}], "thread_id": "Thread-3", "execution_time": 1.1051411628723145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_dropped_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    drop_message\n    \n as \n    \n    drop_message\n    \n, \n    \n    \n    drop_reason\n    \n as \n    \n    drop_reason\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        drop_message,\n        drop_reason,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_dropped_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:23.790690Z", "completed_at": "2024-07-24T18:42:24.910990Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:24.911597Z", "completed_at": "2024-07-24T18:42:24.911601Z"}], "thread_id": "Thread-6", "execution_time": 1.2041730880737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_deferred_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    attempt\n    \n as \n    \n    attempt\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        attempt as attempt_number,\n        id as event_id,\n        response as returned_response\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:23.781016Z", "completed_at": "2024-07-24T18:42:24.910636Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:24.911287Z", "completed_at": "2024-07-24T18:42:24.911291Z"}], "thread_id": "Thread-8", "execution_time": 1.2068142890930176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_forward_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:24.134249Z", "completed_at": "2024-07-24T18:42:25.155534Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.155916Z", "completed_at": "2024-07-24T18:42:25.155921Z"}], "thread_id": "Thread-2", "execution_time": 1.1038682460784912, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_sent_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_sent_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:24.041420Z", "completed_at": "2024-07-24T18:42:25.154820Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.155188Z", "completed_at": "2024-07-24T18:42:25.155202Z"}], "thread_id": "Thread-5", "execution_time": 1.2058749198913574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_open_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    duration\n    \n as \n    \n    duration\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        duration as duration_open,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_open\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:24.289298Z", "completed_at": "2024-07-24T18:42:25.249741Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.250927Z", "completed_at": "2024-07-24T18:42:25.250935Z"}], "thread_id": "Thread-4", "execution_time": 1.1056928634643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_print_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:24.431683Z", "completed_at": "2024-07-24T18:42:25.395020Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.395508Z", "completed_at": "2024-07-24T18:42:25.395512Z"}], "thread_id": "Thread-7", "execution_time": 1.0166897773742676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_spam_report_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        ip_address,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:24.741181Z", "completed_at": "2024-07-24T18:42:25.643319Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.643799Z", "completed_at": "2024-07-24T18:42:25.643824Z"}], "thread_id": "Thread-1", "execution_time": 0.96409010887146, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_status_change_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bounced\n    \n as \n    \n    bounced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    portal_subscription_status\n    \n as \n    \n    portal_subscription_status\n    \n, \n    \n    \n    requested_by\n    \n as \n    \n    requested_by\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    subscriptions\n    \n as \n    \n    subscriptions\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bounced as is_bounced,\n        id as event_id,\n        portal_subscription_status as subscription_status,\n        requested_by as requested_by_email,\n        source as change_source,\n        subscriptions\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:24.989424Z", "completed_at": "2024-07-24T18:42:25.903839Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.904116Z", "completed_at": "2024-07-24T18:42:25.904124Z"}], "thread_id": "Thread-3", "execution_time": 0.9712011814117432, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.000726Z", "completed_at": "2024-07-24T18:42:25.904862Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.905598Z", "completed_at": "2024-07-24T18:42:25.905601Z"}], "thread_id": "Thread-6", "execution_time": 0.9744749069213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_email_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_all_owner_ids\" as all_owner_ids\n        , \"property_hs_all_team_ids\" as all_team_ids\n        , \"property_hs_email_subject\" as email_subject\n        , \"property_hs_email_text\" as email_text\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_modified_by\" as modified_by\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_email\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.006685Z", "completed_at": "2024-07-24T18:42:25.904607Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.905370Z", "completed_at": "2024-07-24T18:42:25.905373Z"}], "thread_id": "Thread-8", "execution_time": 0.9744489192962646, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_deal_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.251279Z", "completed_at": "2024-07-24T18:42:25.904367Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.905125Z", "completed_at": "2024-07-24T18:42:25.905128Z"}], "thread_id": "Thread-2", "execution_time": 0.7154080867767334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_call_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_call\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.260213Z", "completed_at": "2024-07-24T18:42:25.966366Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:25.967725Z", "completed_at": "2024-07-24T18:42:25.967730Z"}], "thread_id": "Thread-5", "execution_time": 0.8539609909057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_company_tmp\"\n\n), macro as (\n\n    select \n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.395743Z", "completed_at": "2024-07-24T18:42:26.116770Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.117184Z", "completed_at": "2024-07-24T18:42:26.117191Z"}], "thread_id": "Thread-4", "execution_time": 0.7776260375976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    caused_by_created\n    \n as \n    \n    caused_by_created\n    \n, \n    \n    \n    caused_by_id\n    \n as \n    \n    caused_by_id\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_campaign_id\n    \n as \n    \n    email_campaign_id\n    \n, \n    \n    \n    filtered_event\n    \n as \n    \n    filtered_event\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    obsoleted_by_created\n    \n as \n    \n    obsoleted_by_created\n    \n, \n    \n    \n    obsoleted_by_id\n    \n as \n    \n    obsoleted_by_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    recipient\n    \n as \n    \n    recipient\n    \n, \n    \n    \n    sent_by_created\n    \n as \n    \n    sent_by_created\n    \n, \n    \n    \n    sent_by_id\n    \n as \n    \n    sent_by_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        cast(caused_by_created as timestamp) as caused_timestamp,\n        caused_by_id as caused_by_event_id,\n        cast(created as timestamp) as created_timestamp,\n        email_campaign_id,\n        filtered_event as is_filtered_event,\n        id as event_id,\n        cast(obsoleted_by_created as timestamp) as obsoleted_timestamp,\n        obsoleted_by_id as obsoleted_by_event_id,\n        portal_id,\n        recipient as recipient_email_address,\n        cast(sent_by_created as timestamp) as sent_timestamp,\n        sent_by_id as sent_by_event_id,\n        type as event_type\n    from macro\n    \n)\n\nselect *\nfrom fields\n", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.448725Z", "completed_at": "2024-07-24T18:42:26.276284Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.276692Z", "completed_at": "2024-07-24T18:42:26.276704Z"}], "thread_id": "Thread-7", "execution_time": 0.9024429321289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_meeting_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n , \n    cast(null as TEXT) as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    cast(null as timestamp) as created_timestamp , \n    cast(null as timestamp) as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"created_from_link_id\"\n        , \"end_time\"\n        , \"pre_meeting_prospect_reminders\"\n        , \"source\"\n        , \"source_id\"\n        , \"start_time\"\n        , \"web_conference_meeting_id\"\n        , \"meeting_outcome\"\n        , \"body\"\n        , \"external_url\"\n        , \"title\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_meeting\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.709909Z", "completed_at": "2024-07-24T18:42:26.561608Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.562062Z", "completed_at": "2024-07-24T18:42:26.562080Z"}], "thread_id": "Thread-1", "execution_time": 0.8970098495483398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_task_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        , \"property_hs_task_type\" as task_type\n        \n        \n        \n\n        \n        \n        , \"property_hs_object_id\" as object_id\n        , \"property_hs_engagement_source\" as engagement_source\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_task\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.968436Z", "completed_at": "2024-07-24T18:42:26.626900Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.627238Z", "completed_at": "2024-07-24T18:42:26.627247Z"}], "thread_id": "Thread-3", "execution_time": 0.7138707637786865, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as is_active , \n    cast(null as timestamp) as created_timestamp , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as integer) as \n    \n    owner_id\n    \n , \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    cast(null as timestamp) as occurred_timestamp , \n    \n    \n    type\n    \n as engagement_type \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as engagement_id,\n        created_timestamp,\n        owner_id,\n        occurred_timestamp,\n        portal_id,\n        engagement_type,\n        is_active\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.974459Z", "completed_at": "2024-07-24T18:42:26.646996Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.647509Z", "completed_at": "2024-07-24T18:42:26.647514Z"}], "thread_id": "Thread-6", "execution_time": 0.7298629283905029, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_note_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    cast(null as TEXT) as note , \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_body_preview\" as body_preview\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_note_body\" as note_body\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_note\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.985907Z", "completed_at": "2024-07-24T18:42:26.647267Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.647771Z", "completed_at": "2024-07-24T18:42:26.647774Z"}], "thread_id": "Thread-2", "execution_time": 0.7294609546661377, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    calculated\n    \n as \n    \n    calculated\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    field_type\n    \n as \n    \n    field_type\n    \n, \n    \n    \n    group_name\n    \n as \n    \n    group_name\n    \n, \n    \n    \n    hubspot_defined\n    \n as \n    \n    hubspot_defined\n    \n, \n    \n    \n    hubspot_object\n    \n as \n    \n    hubspot_object\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    show_currency_symbol\n    \n as \n    \n    show_currency_symbol\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_id,\n        _fivetran_synced,\n        calculated,\n        created_at,\n        description,\n        field_type,\n        group_name,\n        hubspot_defined,\n        hubspot_object,\n        label as property_label,\n        name as property_name,\n        type as property_type,\n        updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:25.980205Z", "completed_at": "2024-07-24T18:42:26.662279Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.662524Z", "completed_at": "2024-07-24T18:42:26.662530Z"}], "thread_id": "Thread-8", "execution_time": 0.7488532066345215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__owner_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        email as email_address,\n        first_name,\n        last_name,\n        owner_id,\n        portal_id,\n        type as owner_type,\n        cast(updated_at as timestamp) as updated_timestamp,\n        trim( first_name || ' ' || last_name ) as full_name\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__owner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.716641Z", "completed_at": "2024-07-24T18:42:26.725077Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.725295Z", "completed_at": "2024-07-24T18:42:26.725298Z"}], "thread_id": "Thread-8", "execution_time": 0.009216785430908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__company_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company_property_history\"\n\n), windows as (\n\n    select\n        company_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by company_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(company_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__company_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.109171Z", "completed_at": "2024-07-24T18:42:26.724417Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.724670Z", "completed_at": "2024-07-24T18:42:26.724677Z"}], "thread_id": "Thread-5", "execution_time": 0.7031521797180176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__merged_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__merged_deal_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    merged_deal_id\n    \n as \n    \n    merged_deal_id\n    \n\n\n\n    from base\n\n), fields as (\n    \n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        merged_deal_id\n    from macro\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__merged_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.174185Z", "completed_at": "2024-07-24T18:42:26.813134Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.819739Z", "completed_at": "2024-07-24T18:42:26.819745Z"}], "thread_id": "Thread-4", "execution_time": 0.6855108737945557, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property_option_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    property_id\n    \n as \n    \n    property_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    hidden\n    \n as \n    \n    hidden\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        label as property_option_label,\t\n        property_id,\n        _fivetran_synced,\n        display_order,\n        hidden,\n        value as property_option_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property_option\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.860236Z", "completed_at": "2024-07-24T18:42:26.871978Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.872264Z", "completed_at": "2024-07-24T18:42:26.872270Z"}], "thread_id": "Thread-4", "execution_time": 0.01275491714477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_company_company_id__deal_id__type_id.59d48f3923", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, deal_id, type_id\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_company\"\n    group by company_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.873606Z", "completed_at": "2024-07-24T18:42:26.878458Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.878725Z", "completed_at": "2024-07-24T18:42:26.878731Z"}], "thread_id": "Thread-4", "execution_time": 0.005747079849243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_property_history\"\n\n), windows as (\n\n    select\n        contact_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by contact_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(contact_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contact_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.880067Z", "completed_at": "2024-07-24T18:42:26.884776Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.885018Z", "completed_at": "2024-07-24T18:42:26.885024Z"}], "thread_id": "Thread-4", "execution_time": 0.005611896514892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__contact_merge_adjust", "compiled": true, "compiled_code": "\n\nwith contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact\"\n), contact_merge_audit as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_merge_audit\"\n\n\n), contact_merge_removal as (\n    select \n        contacts.*\n    from contacts\n    \n    left join contact_merge_audit\n        on cast(contacts.contact_id as TEXT) = cast(contact_merge_audit.vid_to_merge as TEXT)\n    \n    where contact_merge_audit.vid_to_merge is null\n)\n\nselect *\nfrom contact_merge_removal", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.886244Z", "completed_at": "2024-07-24T18:42:26.892174Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.892398Z", "completed_at": "2024-07-24T18:42:26.892403Z"}], "thread_id": "Thread-4", "execution_time": 0.006758928298950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_contact_id.9f112f8944", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.893451Z", "completed_at": "2024-07-24T18:42:26.897749Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.897955Z", "completed_at": "2024-07-24T18:42:26.897960Z"}], "thread_id": "Thread-4", "execution_time": 0.004989147186279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_contact_id.b9135eb03a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact\"\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.898955Z", "completed_at": "2024-07-24T18:42:26.902455Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.902661Z", "completed_at": "2024-07-24T18:42:26.902665Z"}], "thread_id": "Thread-4", "execution_time": 0.004168987274169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_list_contact_list_id.ff8e4cc29a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.903629Z", "completed_at": "2024-07-24T18:42:26.906366Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.906567Z", "completed_at": "2024-07-24T18:42:26.906571Z"}], "thread_id": "Thread-4", "execution_time": 0.003381013870239258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_list_contact_list_id.036739c1b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.907530Z", "completed_at": "2024-07-24T18:42:26.910710Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.910926Z", "completed_at": "2024-07-24T18:42:26.910931Z"}], "thread_id": "Thread-4", "execution_time": 0.0038499832153320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_contact_contact_id__deal_id__type_id.37de71798b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, deal_id, type_id\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_contact\"\n    group by contact_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.911895Z", "completed_at": "2024-07-24T18:42:26.914725Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.914928Z", "completed_at": "2024-07-24T18:42:26.914932Z"}], "thread_id": "Thread-4", "execution_time": 0.0034809112548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__company_company_id.0d0a080d43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.915880Z", "completed_at": "2024-07-24T18:42:26.918572Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.918773Z", "completed_at": "2024-07-24T18:42:26.918777Z"}], "thread_id": "Thread-4", "execution_time": 0.003339052200317383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__company_company_id.394a2a4ba0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company\"\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.919715Z", "completed_at": "2024-07-24T18:42:26.923120Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.923329Z", "completed_at": "2024-07-24T18:42:26.923333Z"}], "thread_id": "Thread-4", "execution_time": 0.004058122634887695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_deal_pipeline_id.8a0e3cd7a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.924307Z", "completed_at": "2024-07-24T18:42:26.976309Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.976523Z", "completed_at": "2024-07-24T18:42:26.976530Z"}], "thread_id": "Thread-4", "execution_time": 0.05268406867980957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_deal_pipeline_id.dff6c45403", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is not null\ngroup by deal_pipeline_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.977537Z", "completed_at": "2024-07-24T18:42:26.980906Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.981118Z", "completed_at": "2024-07-24T18:42:26.981122Z"}], "thread_id": "Thread-4", "execution_time": 0.004051923751831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.d53656553e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_stage_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.982162Z", "completed_at": "2024-07-24T18:42:26.984955Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.985158Z", "completed_at": "2024-07-24T18:42:26.985162Z"}], "thread_id": "Thread-4", "execution_time": 0.003484010696411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.ba90fa6113", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is not null\ngroup by deal_pipeline_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.986138Z", "completed_at": "2024-07-24T18:42:26.988988Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.989196Z", "completed_at": "2024-07-24T18:42:26.989200Z"}], "thread_id": "Thread-4", "execution_time": 0.003505706787109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_bounce_event_id.71b13d26d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.990177Z", "completed_at": "2024-07-24T18:42:26.993545Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.993742Z", "completed_at": "2024-07-24T18:42:26.993747Z"}], "thread_id": "Thread-4", "execution_time": 0.004014015197753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_bounce_event_id.0341ffa8e9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.994777Z", "completed_at": "2024-07-24T18:42:26.998301Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.998497Z", "completed_at": "2024-07-24T18:42:26.998501Z"}], "thread_id": "Thread-4", "execution_time": 0.0041768550872802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_property_history\"\n\n), windows as (\n\n    select\n        deal_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by deal_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(deal_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deal_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.999510Z", "completed_at": "2024-07-24T18:42:27.002267Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.002464Z", "completed_at": "2024-07-24T18:42:27.002468Z"}], "thread_id": "Thread-4", "execution_time": 0.0034477710723876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_deal_id.ff48693e20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.003425Z", "completed_at": "2024-07-24T18:42:27.006189Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.006382Z", "completed_at": "2024-07-24T18:42:27.006386Z"}], "thread_id": "Thread-4", "execution_time": 0.003428936004638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_deal_id.ac1628ac69", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal\"\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.007339Z", "completed_at": "2024-07-24T18:42:27.010064Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.010266Z", "completed_at": "2024-07-24T18:42:27.010270Z"}], "thread_id": "Thread-4", "execution_time": 0.0033740997314453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_campaign_email_campaign_id.79921899a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.011236Z", "completed_at": "2024-07-24T18:42:27.014967Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.015175Z", "completed_at": "2024-07-24T18:42:27.015180Z"}], "thread_id": "Thread-4", "execution_time": 0.0043981075286865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_campaign_email_campaign_id.9820d33f2e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.353542Z", "completed_at": "2024-07-24T18:42:26.980360Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:26.980633Z", "completed_at": "2024-07-24T18:42:26.980637Z"}], "thread_id": "Thread-7", "execution_time": 0.6670701503753662, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_company_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.016159Z", "completed_at": "2024-07-24T18:42:27.019453Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.019898Z", "completed_at": "2024-07-24T18:42:27.019902Z"}], "thread_id": "Thread-4", "execution_time": 0.004185914993286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_click_event_id.8a1be931c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_click\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.021114Z", "completed_at": "2024-07-24T18:42:27.026689Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.026916Z", "completed_at": "2024-07-24T18:42:27.026920Z"}], "thread_id": "Thread-7", "execution_time": 0.006741046905517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_click_event_id.da8d8487a1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_click\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.024068Z", "completed_at": "2024-07-24T18:42:27.027556Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.028035Z", "completed_at": "2024-07-24T18:42:27.028039Z"}], "thread_id": "Thread-4", "execution_time": 0.007188081741333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_delivered_event_id.87c8eb3f20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.028803Z", "completed_at": "2024-07-24T18:42:27.035337Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.035556Z", "completed_at": "2024-07-24T18:42:27.035560Z"}], "thread_id": "Thread-7", "execution_time": 0.007834196090698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_delivered_event_id.f818bf03fc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.032605Z", "completed_at": "2024-07-24T18:42:27.036364Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.036800Z", "completed_at": "2024-07-24T18:42:27.036804Z"}], "thread_id": "Thread-4", "execution_time": 0.004717111587524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_dropped_event_id.c92d449f52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.037129Z", "completed_at": "2024-07-24T18:42:27.043167Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.043390Z", "completed_at": "2024-07-24T18:42:27.043394Z"}], "thread_id": "Thread-7", "execution_time": 0.007297992706298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_dropped_event_id.40706bbf71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.040561Z", "completed_at": "2024-07-24T18:42:27.043957Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.044431Z", "completed_at": "2024-07-24T18:42:27.044435Z"}], "thread_id": "Thread-4", "execution_time": 0.004375934600830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_deferred_event_id.80293078e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.045188Z", "completed_at": "2024-07-24T18:42:27.051842Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.052060Z", "completed_at": "2024-07-24T18:42:27.052064Z"}], "thread_id": "Thread-7", "execution_time": 0.007939815521240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_deferred_event_id.2f779e2912", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.048326Z", "completed_at": "2024-07-24T18:42:27.052898Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.053291Z", "completed_at": "2024-07-24T18:42:27.053294Z"}], "thread_id": "Thread-4", "execution_time": 0.005491971969604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_forward_event_id.b9a8bf63b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.053633Z", "completed_at": "2024-07-24T18:42:27.059745Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.059962Z", "completed_at": "2024-07-24T18:42:27.059967Z"}], "thread_id": "Thread-7", "execution_time": 0.007345914840698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_forward_event_id.7f133d2dd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_forward\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.057081Z", "completed_at": "2024-07-24T18:42:27.063671Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.063882Z", "completed_at": "2024-07-24T18:42:27.063886Z"}], "thread_id": "Thread-4", "execution_time": 0.007306814193725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_sent_event_id.cf77d9f15d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.060992Z", "completed_at": "2024-07-24T18:42:27.064812Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.065214Z", "completed_at": "2024-07-24T18:42:27.065218Z"}], "thread_id": "Thread-7", "execution_time": 0.004717826843261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_sent_event_id.122cb22272", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_sent\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.065563Z", "completed_at": "2024-07-24T18:42:27.072623Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.072844Z", "completed_at": "2024-07-24T18:42:27.072849Z"}], "thread_id": "Thread-4", "execution_time": 0.00841212272644043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_open_event_id.a2e658fe16", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_open\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.069064Z", "completed_at": "2024-07-24T18:42:27.073422Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.073866Z", "completed_at": "2024-07-24T18:42:27.073869Z"}], "thread_id": "Thread-7", "execution_time": 0.005322933197021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_open_event_id.3a369549b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_open\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.074608Z", "completed_at": "2024-07-24T18:42:27.080365Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.080573Z", "completed_at": "2024-07-24T18:42:27.080577Z"}], "thread_id": "Thread-4", "execution_time": 0.006989955902099609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_print_event_id.94d4e09b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.077813Z", "completed_at": "2024-07-24T18:42:27.081375Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.081785Z", "completed_at": "2024-07-24T18:42:27.081788Z"}], "thread_id": "Thread-7", "execution_time": 0.004501819610595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_print_event_id.40a8ccd3f3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_print\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.082107Z", "completed_at": "2024-07-24T18:42:27.088078Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.088299Z", "completed_at": "2024-07-24T18:42:27.088303Z"}], "thread_id": "Thread-4", "execution_time": 0.007206916809082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_spam_report_event_id.2a56aced8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.085454Z", "completed_at": "2024-07-24T18:42:27.088876Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.089288Z", "completed_at": "2024-07-24T18:42:27.089291Z"}], "thread_id": "Thread-7", "execution_time": 0.004306793212890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_spam_report_event_id.448320447a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.090028Z", "completed_at": "2024-07-24T18:42:27.096584Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.096804Z", "completed_at": "2024-07-24T18:42:27.096808Z"}], "thread_id": "Thread-4", "execution_time": 0.007805824279785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_status_change_event_id.c5e80297b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.093996Z", "completed_at": "2024-07-24T18:42:27.097379Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.097795Z", "completed_at": "2024-07-24T18:42:27.097799Z"}], "thread_id": "Thread-7", "execution_time": 0.004319906234741211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_status_change_event_id.13105203e0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.101721Z", "completed_at": "2024-07-24T18:42:27.104477Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.104880Z", "completed_at": "2024-07-24T18:42:27.104885Z"}], "thread_id": "Thread-7", "execution_time": 0.0037059783935546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_email_engagement_id.5eeb06dcfc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.098561Z", "completed_at": "2024-07-24T18:42:27.104673Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.105229Z", "completed_at": "2024-07-24T18:42:27.105232Z"}], "thread_id": "Thread-4", "execution_time": 0.0077021121978759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_email_engagement_id.175561ecca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.106855Z", "completed_at": "2024-07-24T18:42:27.113224Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.113640Z", "completed_at": "2024-07-24T18:42:27.113644Z"}], "thread_id": "Thread-7", "execution_time": 0.007661104202270508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_call_engagement_id.5ceb3917bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.109636Z", "completed_at": "2024-07-24T18:42:27.113444Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.113996Z", "completed_at": "2024-07-24T18:42:27.113999Z"}], "thread_id": "Thread-4", "execution_time": 0.007791042327880859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_call_engagement_id.43b4413603", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.118174Z", "completed_at": "2024-07-24T18:42:27.120908Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.121442Z", "completed_at": "2024-07-24T18:42:27.121445Z"}], "thread_id": "Thread-4", "execution_time": 0.006468057632446289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_event_id.4f287f3531", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.123173Z", "completed_at": "2024-07-24T18:42:27.128786Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.129196Z", "completed_at": "2024-07-24T18:42:27.129200Z"}], "thread_id": "Thread-7", "execution_time": 0.006947994232177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_event_id.734683460d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.125924Z", "completed_at": "2024-07-24T18:42:27.128998Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.129571Z", "completed_at": "2024-07-24T18:42:27.129575Z"}], "thread_id": "Thread-4", "execution_time": 0.007089853286743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_meeting_engagement_id.18dd11dc28", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.131283Z", "completed_at": "2024-07-24T18:42:27.137660Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.138070Z", "completed_at": "2024-07-24T18:42:27.138075Z"}], "thread_id": "Thread-7", "execution_time": 0.0076751708984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_meeting_engagement_id.70721fb830", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.134892Z", "completed_at": "2024-07-24T18:42:27.137876Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.138429Z", "completed_at": "2024-07-24T18:42:27.138432Z"}], "thread_id": "Thread-4", "execution_time": 0.00779414176940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_task_engagement_id.0bbd752d82", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.142743Z", "completed_at": "2024-07-24T18:42:27.150425Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.150654Z", "completed_at": "2024-07-24T18:42:27.150660Z"}], "thread_id": "Thread-4", "execution_time": 0.01126408576965332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagements", "compiled": true, "compiled_code": "\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement\"\n\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), contacts_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(contact_id)\n as contact_ids\n    from contacts\n    group by 1\n\n\n\n\n\n), deals as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_deal\"\n \n), deals_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(deal_id)\n as deal_ids\n    from deals\n    group by 1\n\n\n\n\n\n), companies as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_company\"\n\n), companies_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(company_id)\n as company_ids\n    from companies\n    group by 1\n\n\n\n), joined as (\n\n    select \n         contacts_agg.contact_ids, \n         deals_agg.deal_ids, \n         companies_agg.company_ids, \n        engagements.*\n    from engagements\n     left join contacts_agg using (engagement_id) \n     left join deals_agg using (engagement_id) \n     left join companies_agg using (engagement_id) \n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.140043Z", "completed_at": "2024-07-24T18:42:27.155241Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.155763Z", "completed_at": "2024-07-24T18:42:27.155767Z"}], "thread_id": "Thread-7", "execution_time": 0.016587018966674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_task_engagement_id.0f578bc80c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.151633Z", "completed_at": "2024-07-24T18:42:27.156377Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.156838Z", "completed_at": "2024-07-24T18:42:27.156841Z"}], "thread_id": "Thread-4", "execution_time": 0.0056569576263427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_engagement_id.b26f4d328f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.160959Z", "completed_at": "2024-07-24T18:42:27.163792Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.164187Z", "completed_at": "2024-07-24T18:42:27.164192Z"}], "thread_id": "Thread-4", "execution_time": 0.006414890289306641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_note_engagement_id.244059891e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.158059Z", "completed_at": "2024-07-24T18:42:27.163993Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.164536Z", "completed_at": "2024-07-24T18:42:27.164539Z"}], "thread_id": "Thread-7", "execution_time": 0.007405281066894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_engagement_id.4f054187b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.166162Z", "completed_at": "2024-07-24T18:42:27.171534Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.171754Z", "completed_at": "2024-07-24T18:42:27.171764Z"}], "thread_id": "Thread-4", "execution_time": 0.0064601898193359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_note_engagement_id.e2eaf5256e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.168814Z", "completed_at": "2024-07-24T18:42:27.172327Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.172770Z", "completed_at": "2024-07-24T18:42:27.172773Z"}], "thread_id": "Thread-7", "execution_time": 0.007241964340209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__property__fivetran_id.37b6ec5db1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property\"\nwhere _fivetran_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.173533Z", "completed_at": "2024-07-24T18:42:27.180760Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.180977Z", "completed_at": "2024-07-24T18:42:27.180982Z"}], "thread_id": "Thread-4", "execution_time": 0.00849008560180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__property__fivetran_id.1d41a2aa95", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    _fivetran_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property\"\nwhere _fivetran_id is not null\ngroup by _fivetran_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.177507Z", "completed_at": "2024-07-24T18:42:27.184692Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.184903Z", "completed_at": "2024-07-24T18:42:27.184907Z"}], "thread_id": "Thread-7", "execution_time": 0.007952213287353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__company_history_company_id__field_name__valid_to.654ef778b1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, field_name, valid_to\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__company_history\"\n    group by company_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.182009Z", "completed_at": "2024-07-24T18:42:27.188510Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.188742Z", "completed_at": "2024-07-24T18:42:27.188747Z"}], "thread_id": "Thread-4", "execution_time": 0.0072612762451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__company_history_id.33035793ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__company_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.185936Z", "completed_at": "2024-07-24T18:42:27.195450Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.195730Z", "completed_at": "2024-07-24T18:42:27.195735Z"}], "thread_id": "Thread-7", "execution_time": 0.010324954986572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__company_history_id.f1af964b1f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__company_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.197110Z", "completed_at": "2024-07-24T18:42:27.204163Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.204404Z", "completed_at": "2024-07-24T18:42:27.204408Z"}], "thread_id": "Thread-7", "execution_time": 0.008099794387817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__merged_deal_deal_id.a843ca0610", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__merged_deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.201462Z", "completed_at": "2024-07-24T18:42:27.208759Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.208975Z", "completed_at": "2024-07-24T18:42:27.208979Z"}], "thread_id": "Thread-4", "execution_time": 0.008026123046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__merged_deal_merged_deal_id.c2d24039b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect merged_deal_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__merged_deal\"\nwhere merged_deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.205461Z", "completed_at": "2024-07-24T18:42:27.209864Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.210248Z", "completed_at": "2024-07-24T18:42:27.210251Z"}], "thread_id": "Thread-7", "execution_time": 0.005300998687744141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__property_option_property_id__property_option_label.2792c4669b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        property_id, property_option_label\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__property_option\"\n    group by property_id, property_option_label\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.210589Z", "completed_at": "2024-07-24T18:42:27.221040Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.221477Z", "completed_at": "2024-07-24T18:42:27.221483Z"}], "thread_id": "Thread-4", "execution_time": 0.011941194534301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__contact_history_contact_id__field_name__valid_to.42ccfb8329", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, field_name, valid_to\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contact_history\"\n    group by contact_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.217440Z", "completed_at": "2024-07-24T18:42:27.222287Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.222746Z", "completed_at": "2024-07-24T18:42:27.222750Z"}], "thread_id": "Thread-7", "execution_time": 0.008893013000488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_history_id.eaae22e088", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contact_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.223512Z", "completed_at": "2024-07-24T18:42:27.230797Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.231023Z", "completed_at": "2024-07-24T18:42:27.231028Z"}], "thread_id": "Thread-4", "execution_time": 0.008584976196289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_history_id.aef69ae1ec", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contact_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.226588Z", "completed_at": "2024-07-24T18:42:27.231864Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.232241Z", "completed_at": "2024-07-24T18:42:27.232245Z"}], "thread_id": "Thread-7", "execution_time": 0.0061779022216796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.232595Z", "completed_at": "2024-07-24T18:42:27.239425Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.239648Z", "completed_at": "2024-07-24T18:42:27.239652Z"}], "thread_id": "Thread-4", "execution_time": 0.008080005645751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_clicks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_click\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_clicks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.236414Z", "completed_at": "2024-07-24T18:42:27.240519Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.240912Z", "completed_at": "2024-07-24T18:42:27.240915Z"}], "thread_id": "Thread-7", "execution_time": 0.005011796951293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.241252Z", "completed_at": "2024-07-24T18:42:27.249036Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.249247Z", "completed_at": "2024-07-24T18:42:27.249252Z"}], "thread_id": "Thread-4", "execution_time": 0.009048223495483398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.245890Z", "completed_at": "2024-07-24T18:42:27.249821Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.250306Z", "completed_at": "2024-07-24T18:42:27.250309Z"}], "thread_id": "Thread-7", "execution_time": 0.004901885986328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.251070Z", "completed_at": "2024-07-24T18:42:27.257618Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.257848Z", "completed_at": "2024-07-24T18:42:27.257852Z"}], "thread_id": "Thread-4", "execution_time": 0.007856130599975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_forward\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.254607Z", "completed_at": "2024-07-24T18:42:27.258490Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.258910Z", "completed_at": "2024-07-24T18:42:27.258913Z"}], "thread_id": "Thread-7", "execution_time": 0.004884004592895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_opens", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_open\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_opens\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.259759Z", "completed_at": "2024-07-24T18:42:27.267027Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.267249Z", "completed_at": "2024-07-24T18:42:27.267253Z"}], "thread_id": "Thread-4", "execution_time": 0.008621931076049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_print", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_print\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.263186Z", "completed_at": "2024-07-24T18:42:27.267821Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.268316Z", "completed_at": "2024-07-24T18:42:27.268319Z"}], "thread_id": "Thread-7", "execution_time": 0.005691051483154297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_sent\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.269101Z", "completed_at": "2024-07-24T18:42:27.275573Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.275785Z", "completed_at": "2024-07-24T18:42:27.275791Z"}], "thread_id": "Thread-4", "execution_time": 0.0077860355377197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.272489Z", "completed_at": "2024-07-24T18:42:27.276352Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.276853Z", "completed_at": "2024-07-24T18:42:27.276857Z"}], "thread_id": "Thread-7", "execution_time": 0.004858732223510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.277642Z", "completed_at": "2024-07-24T18:42:27.284377Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.284623Z", "completed_at": "2024-07-24T18:42:27.284628Z"}], "thread_id": "Thread-4", "execution_time": 0.008097648620605469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__deal_history_deal_id__field_name__valid_to.f55c724804", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        deal_id, field_name, valid_to\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deal_history\"\n    group by deal_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.280918Z", "completed_at": "2024-07-24T18:42:27.285461Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.285845Z", "completed_at": "2024-07-24T18:42:27.285849Z"}], "thread_id": "Thread-7", "execution_time": 0.0054509639739990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_history_id.a1c6cd6a75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deal_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.286175Z", "completed_at": "2024-07-24T18:42:27.292636Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.292852Z", "completed_at": "2024-07-24T18:42:27.292856Z"}], "thread_id": "Thread-4", "execution_time": 0.007683992385864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_history_id.1cb93fca79", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deal_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.289463Z", "completed_at": "2024-07-24T18:42:27.297607Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.297804Z", "completed_at": "2024-07-24T18:42:27.297807Z"}], "thread_id": "Thread-7", "execution_time": 0.008919000625610352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_event_aggregates_email_send_id.ac29e6997a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n) select email_send_id\nfrom __dbt__cte__int_hubspot__email_event_aggregates\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.293901Z", "completed_at": "2024-07-24T18:42:27.304326Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.304523Z", "completed_at": "2024-07-24T18:42:27.304528Z"}], "thread_id": "Thread-4", "execution_time": 0.011149883270263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_event_aggregates_email_send_id.4deec238f9", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n) select\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__email_event_aggregates\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.298927Z", "completed_at": "2024-07-24T18:42:27.310642Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.312337Z", "completed_at": "2024-07-24T18:42:27.312343Z"}], "thread_id": "Thread-7", "execution_time": 0.013940095901489258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__companies", "compiled": true, "compiled_code": "\n\nwith companies as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company\"\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), engagement_companies as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_company\"\n\n), engagement_companies_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_companies.company_id\n    from engagements\n    inner join engagement_companies\n        using (engagement_id)\n\n), engagement_companies_agg as (\n\n    \n\n    select\n        company_id,\n        count(case when engagement_type = 'NOTE' then company_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then company_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then company_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then company_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then company_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then company_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then company_id end) as count_engagement_forwarded_emails\n    from engagement_companies_joined\n    group by 1\n\n\n\n), joined as (\n\n    select \n        companies.*,\n        \n        coalesce(engagement_companies_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_companies_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_companies_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_companies_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_companies_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from companies\n    left join engagement_companies_agg\n        using (company_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__companies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.607580Z", "completed_at": "2024-07-24T18:42:27.221265Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.221856Z", "completed_at": "2024-07-24T18:42:27.221859Z"}], "thread_id": "Thread-1", "execution_time": 0.7080657482147217, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.726403Z", "completed_at": "2024-07-24T18:42:27.388006Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.388266Z", "completed_at": "2024-07-24T18:42:27.388274Z"}], "thread_id": "Thread-8", "execution_time": 0.7085120677947998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as ticket_id , \n    cast(null as boolean) as _fivetran_ticket_deleted , \n    \n    \n    is_deleted\n    \n as is_ticket_deleted , \n    \n    \n    property_closed_date\n    \n as closed_date , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_first_agent_reply_date\n    \n as first_agent_reply_at , \n    \n    \n    property_hs_pipeline\n    \n as ticket_pipeline_id , \n    \n    \n    property_hs_pipeline_stage\n    \n as ticket_pipeline_stage_id , \n    \n    \n    property_hs_ticket_category\n    \n as ticket_category , \n    \n    \n    property_hs_ticket_priority\n    \n as ticket_priority , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_subject\n    \n as ticket_subject , \n    \n    \n    property_content\n    \n as ticket_content \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_ticket_columns.sql macro\n        ticket_id,\n        coalesce(_fivetran_ticket_deleted, is_ticket_deleted) as is_ticket_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        first_agent_reply_at,\n        ticket_pipeline_id,\n        ticket_pipeline_stage_id,\n        ticket_category,\n        ticket_priority,\n        owner_id,\n        ticket_subject,\n        ticket_content\n\n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__ticket_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.698545Z", "completed_at": "2024-07-24T18:42:27.410292Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.410935Z", "completed_at": "2024-07-24T18:42:27.410938Z"}], "thread_id": "Thread-6", "execution_time": 0.7637739181518555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_engagement_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.680909Z", "completed_at": "2024-07-24T18:42:27.410012Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.410709Z", "completed_at": "2024-07-24T18:42:27.410714Z"}], "thread_id": "Thread-3", "execution_time": 0.781486988067627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    is_closed\n    \n as \n    \n    is_closed\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    ticket_state\n    \n as \n    \n    ticket_state\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        _fivetran_deleted as is_ticket_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        is_closed,\n        label as pipeline_stage_label,\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        cast(stage_id as integer ) as ticket_pipeline_stage_id,\n        ticket_state,\n        created_at as ticket_pipeline_stage_created_at,\n        updated_at as ticket_pipeline_stage_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.704680Z", "completed_at": "2024-07-24T18:42:27.410511Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.411142Z", "completed_at": "2024-07-24T18:42:27.411145Z"}], "thread_id": "Thread-2", "execution_time": 0.764833927154541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    object_type_id\n    \n as \n    \n    object_type_id\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        _fivetran_deleted as is_ticket_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        object_type_id,\n        created_at as ticket_pipeline_created_at,\n        updated_at as ticket_pipeline_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.472674Z", "completed_at": "2024-07-24T18:42:27.524235Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.524478Z", "completed_at": "2024-07-24T18:42:27.524483Z"}], "thread_id": "Thread-2", "execution_time": 0.059844017028808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagements_engagement_id.59b32bc0d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.521402Z", "completed_at": "2024-07-24T18:42:27.525325Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.525711Z", "completed_at": "2024-07-24T18:42:27.525714Z"}], "thread_id": "Thread-3", "execution_time": 0.004785299301147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagements_engagement_id.01d5c3ee5d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.526045Z", "completed_at": "2024-07-24T18:42:27.557264Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.557495Z", "completed_at": "2024-07-24T18:42:27.557501Z"}], "thread_id": "Thread-2", "execution_time": 0.03249406814575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_stages", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal\"\n\n\n), merged_deals as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__merged_deal\"\n\n), aggregate_merged_deals as (\n\n    select\n        deal_id,\n        \n    array_agg(merged_deal_id)\n as merged_deal_ids\n    from merged_deals\n    group by 1\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n        aggregate_merged_deals.merged_deal_ids,\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n    left join aggregate_merged_deals\n        on deals.deal_id = aggregate_merged_deals.deal_id\n\n    left join merged_deals\n        on deals.deal_id = merged_deals.merged_deal_id\n    where merged_deals.merged_deal_id is null\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n), deal_stage as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_stage\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), final as (\n\n    select\n        deal_stage.deal_id || '-' || row_number() over(partition by deal_stage.deal_id order by deal_stage.date_entered asc) as deal_stage_id,\n        deals_enhanced.deal_id,\n        deals_enhanced.deal_name,\n\n        \n        deals_enhanced.merged_deal_ids,\n        \n        \n        deal_stage._fivetran_start as date_stage_entered,\n        deal_stage._fivetran_end as date_stage_exited,\n        deal_stage._fivetran_active as is_stage_active,\n        deal_stage.deal_stage_name as pipeline_stage_id,\n        pipeline_stage.pipeline_stage_label,\n        pipeline_stage.deal_pipeline_id as pipeline_id,\n        pipeline.pipeline_label,\n        deal_stage.source,\n        deal_stage.source_id,\n        pipeline_stage.is_active as is_pipeline_stage_active,\n        pipeline.is_active as is_pipeline_active,\n        pipeline_stage.is_closed_won as is_pipeline_stage_closed_won,\n        pipeline_stage.display_order as pipeline_stage_display_order,\n        pipeline.display_order as pipeline_display_order,\n        pipeline_stage.probability as pipeline_stage_probability,\n        coalesce(pipeline.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        coalesce(pipeline_stage.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        coalesce(deals_enhanced.is_deal_deleted, false) as is_deal_deleted,\n        pipeline_stage.deal_pipeline_stage_created_at,\n        pipeline_stage.deal_pipeline_stage_updated_at\n\n    from deal_stage\n\n    left join pipeline_stage\n        on deal_stage.deal_stage_name = pipeline_stage.deal_pipeline_stage_id\n    \n    left join pipeline\n        on pipeline_stage.deal_pipeline_id = pipeline.deal_pipeline_id\n\n    left join deals_enhanced\n        on deal_stage.deal_id = deals_enhanced.deal_id\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deal_stages\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.539298Z", "completed_at": "2024-07-24T18:42:27.561242Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.561515Z", "completed_at": "2024-07-24T18:42:27.561520Z"}], "thread_id": "Thread-3", "execution_time": 0.022686243057250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deals", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal\"\n\n\n), merged_deals as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__merged_deal\"\n\n), aggregate_merged_deals as (\n\n    select\n        deal_id,\n        \n    array_agg(merged_deal_id)\n as merged_deal_ids\n    from merged_deals\n    group by 1\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n        aggregate_merged_deals.merged_deal_ids,\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n    left join aggregate_merged_deals\n        on deals.deal_id = aggregate_merged_deals.deal_id\n\n    left join merged_deals\n        on deals.deal_id = merged_deals.merged_deal_id\n    where merged_deals.merged_deal_id is null\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), engagement_deals as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_deal\"\n\n), engagement_deal_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_deals.deal_id\n    from engagements\n    inner join engagement_deals\n        on cast(engagements.engagement_id as bigint) = cast(engagement_deals.engagement_id as bigint )\n\n), engagement_deal_agg as (\n\n    \n\n    select\n        deal_id,\n        count(case when engagement_type = 'NOTE' then deal_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then deal_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then deal_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then deal_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then deal_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then deal_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then deal_id end) as count_engagement_forwarded_emails\n    from engagement_deal_joined\n    group by 1\n\n\n\n), engagements_joined as (\n\n    select \n        deals_enhanced.*,\n        \n        coalesce(engagement_deal_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_deal_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_deal_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_deal_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_deal_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from deals_enhanced\n    left join engagement_deal_agg\n        on cast(deals_enhanced.deal_id as bigint) = cast(engagement_deal_agg.deal_id as bigint )\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.558495Z", "completed_at": "2024-07-24T18:42:27.565603Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.565835Z", "completed_at": "2024-07-24T18:42:27.565840Z"}], "thread_id": "Thread-2", "execution_time": 0.007802248001098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_bounce_event_id.39d8daa6f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.562708Z", "completed_at": "2024-07-24T18:42:27.566658Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.567116Z", "completed_at": "2024-07-24T18:42:27.567120Z"}], "thread_id": "Thread-3", "execution_time": 0.0050470829010009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_bounce_event_id.7a1c6704e1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_bounce\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:26.813380Z", "completed_at": "2024-07-24T18:42:27.463543Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.464493Z", "completed_at": "2024-07-24T18:42:27.464497Z"}], "thread_id": "Thread-5", "execution_time": 0.7550280094146729, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    name\n    \n as field_name , \n    \n    \n    source\n    \n as change_source , \n    \n    \n    source_id\n    \n as change_source_id , \n    \n    \n    timestamp_instant\n    \n as change_timestamp , \n    \n    \n    value\n    \n as new_value \n\n\n         \n            \n        \n        \n        \n\n        \n        \n        , \"_fivetran_active\"\n\n \n        \n        from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.568431Z", "completed_at": "2024-07-24T18:42:27.578220Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.578530Z", "completed_at": "2024-07-24T18:42:27.578536Z"}], "thread_id": "Thread-2", "execution_time": 0.011758804321289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_clicks_event_id.f603501ca0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_clicks\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.572149Z", "completed_at": "2024-07-24T18:42:27.582528Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.582963Z", "completed_at": "2024-07-24T18:42:27.582967Z"}], "thread_id": "Thread-3", "execution_time": 0.011806249618530273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_clicks_event_id.60d3912846", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_clicks\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.574898Z", "completed_at": "2024-07-24T18:42:27.582754Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.583363Z", "completed_at": "2024-07-24T18:42:27.583367Z"}], "thread_id": "Thread-5", "execution_time": 0.01195383071899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_deferred_event_id.2c6decaa91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.579695Z", "completed_at": "2024-07-24T18:42:27.583699Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.584370Z", "completed_at": "2024-07-24T18:42:27.584373Z"}], "thread_id": "Thread-2", "execution_time": 0.005206108093261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_deferred_event_id.bb75dcb83a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_deferred\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.588568Z", "completed_at": "2024-07-24T18:42:27.594264Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.594677Z", "completed_at": "2024-07-24T18:42:27.594682Z"}], "thread_id": "Thread-5", "execution_time": 0.00981593132019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_delivered_event_id.242e838cce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_delivered\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.585959Z", "completed_at": "2024-07-24T18:42:27.594472Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.595225Z", "completed_at": "2024-07-24T18:42:27.595229Z"}], "thread_id": "Thread-3", "execution_time": 0.010577917098999023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_delivered_event_id.0609870be3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.591525Z", "completed_at": "2024-07-24T18:42:27.595031Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.595830Z", "completed_at": "2024-07-24T18:42:27.595833Z"}], "thread_id": "Thread-2", "execution_time": 0.01012873649597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_dropped_event_id.5cfe4eeb95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.597649Z", "completed_at": "2024-07-24T18:42:27.607022Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.607260Z", "completed_at": "2024-07-24T18:42:27.607266Z"}], "thread_id": "Thread-5", "execution_time": 0.010934114456176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_dropped_event_id.093040860b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_dropped\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.601425Z", "completed_at": "2024-07-24T18:42:27.607889Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.608512Z", "completed_at": "2024-07-24T18:42:27.608516Z"}], "thread_id": "Thread-3", "execution_time": 0.011777877807617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_forward_event_id.417a73da08", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.604146Z", "completed_at": "2024-07-24T18:42:27.608330Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.609135Z", "completed_at": "2024-07-24T18:42:27.609139Z"}], "thread_id": "Thread-2", "execution_time": 0.01192784309387207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_forward_event_id.064956aaa7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_forward\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.609788Z", "completed_at": "2024-07-24T18:42:27.620074Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.620360Z", "completed_at": "2024-07-24T18:42:27.620369Z"}], "thread_id": "Thread-5", "execution_time": 0.012341022491455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_opens_event_id.a9fe279ee1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_opens\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.613562Z", "completed_at": "2024-07-24T18:42:27.621073Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.621518Z", "completed_at": "2024-07-24T18:42:27.621521Z"}], "thread_id": "Thread-3", "execution_time": 0.008908987045288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_opens_event_id.d7963f4eb0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_opens\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.616439Z", "completed_at": "2024-07-24T18:42:27.621859Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.622472Z", "completed_at": "2024-07-24T18:42:27.622476Z"}], "thread_id": "Thread-2", "execution_time": 0.009598255157470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_print_event_id.9dac8a147e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.622822Z", "completed_at": "2024-07-24T18:42:27.629111Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.629527Z", "completed_at": "2024-07-24T18:42:27.629531Z"}], "thread_id": "Thread-5", "execution_time": 0.008306741714477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_print_event_id.548f6cece7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_print\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.626513Z", "completed_at": "2024-07-24T18:42:27.633119Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.633600Z", "completed_at": "2024-07-24T18:42:27.633604Z"}], "thread_id": "Thread-3", "execution_time": 0.008091211318969727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_sent_event_id.5507dcc5b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.629878Z", "completed_at": "2024-07-24T18:42:27.634176Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.637392Z", "completed_at": "2024-07-24T18:42:27.637397Z"}], "thread_id": "Thread-2", "execution_time": 0.011165857315063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_sent_event_id.68076270f8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_sent\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.634600Z", "completed_at": "2024-07-24T18:42:27.642512Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.645007Z", "completed_at": "2024-07-24T18:42:27.645012Z"}], "thread_id": "Thread-5", "execution_time": 0.011742115020751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_spam_report_event_id.5ddca8771a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.638729Z", "completed_at": "2024-07-24T18:42:27.645943Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.646367Z", "completed_at": "2024-07-24T18:42:27.646371Z"}], "thread_id": "Thread-3", "execution_time": 0.008671045303344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_spam_report_event_id.20aab81ec6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_spam_report\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.647024Z", "completed_at": "2024-07-24T18:42:27.650885Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.654051Z", "completed_at": "2024-07-24T18:42:27.654056Z"}], "thread_id": "Thread-5", "execution_time": 0.008414030075073242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_status_change_event_id.a1737e44b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.654413Z", "completed_at": "2024-07-24T18:42:27.661440Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.661858Z", "completed_at": "2024-07-24T18:42:27.661863Z"}], "thread_id": "Thread-2", "execution_time": 0.011466026306152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__companies_company_id.687ec98e97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__companies\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.651251Z", "completed_at": "2024-07-24T18:42:27.661646Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.662244Z", "completed_at": "2024-07-24T18:42:27.662247Z"}], "thread_id": "Thread-3", "execution_time": 0.012093305587768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_status_change_event_id.2e5b2b72e2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_status_change\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.657746Z", "completed_at": "2024-07-24T18:42:27.662895Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.663565Z", "completed_at": "2024-07-24T18:42:27.663568Z"}], "thread_id": "Thread-5", "execution_time": 0.006350040435791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__companies_company_id.a58ceac3f2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__companies\" where not coalesce(is_company_deleted, false)) dbt_subquery\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.673973Z", "completed_at": "2024-07-24T18:42:27.680315Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.680536Z", "completed_at": "2024-07-24T18:42:27.680542Z"}], "thread_id": "Thread-3", "execution_time": 0.016704082489013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__ticket_ticket_id.299e7c4c53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.677318Z", "completed_at": "2024-07-24T18:42:27.687832Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.694327Z", "completed_at": "2024-07-24T18:42:27.694333Z"}], "thread_id": "Thread-5", "execution_time": 0.020661592483520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__ticket_ticket_id.78c6fbfcaf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.695344Z", "completed_at": "2024-07-24T18:42:27.701161Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.701393Z", "completed_at": "2024-07-24T18:42:27.701397Z"}], "thread_id": "Thread-5", "execution_time": 0.006514072418212891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__engagement_metrics__by_contact_contact_id.4a800df06b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n) select contact_id\nfrom __dbt__cte__int_hubspot__engagement_metrics__by_contact\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.681503Z", "completed_at": "2024-07-24T18:42:27.706115Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.706363Z", "completed_at": "2024-07-24T18:42:27.706368Z"}], "thread_id": "Thread-3", "execution_time": 0.02531290054321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__tickets", "compiled": true, "compiled_code": "\n\nwith ticket as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket\"\n\n), ticket_pipeline as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline\"\n\n), ticket_pipeline_stage as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\"\n\n\n\n\n), ticket_company as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_company\"\n\n), company as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__company\"\n\n), join_companies as (\n    \n    select\n        ticket_company.ticket_id,\n        ticket_company.company_id,\n        company.company_name\n\n    from ticket_company\n    left join company \n        on ticket_company.company_id = company.company_id\n\n), agg_companies as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when company_id is null then '' else cast(company_id as TEXT) end)\n as company_ids,\n        \n    array_agg(case when company_name is null then '' else company_name end)\n as company_names\n\n    from join_companies\n    group by 1\n\n\n\n\n), ticket_contact as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_contact\"\n\n), contact as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact\"\n\n), join_contacts as (\n    \n    select\n        ticket_contact.ticket_id,\n        ticket_contact.contact_id,\n        contact.email\n\n    from ticket_contact\n    left join contact \n        on ticket_contact.contact_id = contact.contact_id\n\n), agg_contacts as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when contact_id is null then '' else cast(contact_id as TEXT) end)\n as contact_ids,\n        \n    array_agg(case when email is null then '' else email end)\n as contact_emails\n\n    from join_contacts\n    group by 1\n\n\n\n\n), owner as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n\n\n), engagement as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), ticket_engagement as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_engagement\"\n\n), join_engagements as (\n\n    select \n        engagement.engagement_type,\n        ticket_engagement.ticket_id\n    from engagement\n    inner join ticket_engagement\n        on cast(engagement.engagement_id as bigint) = cast(ticket_engagement.engagement_id as bigint )\n\n), agg_engagements as (\n\n    \n\n    select\n        ticket_id,\n        count(case when engagement_type = 'NOTE' then ticket_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then ticket_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then ticket_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then ticket_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then ticket_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then ticket_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then ticket_id end) as count_engagement_forwarded_emails\n    from join_engagements\n    group by 1\n\n\n\n\n\n), final_join as (\n\n    select\n        ticket.*,\n        ticket_pipeline_stage.ticket_state,\n        ticket_pipeline_stage.is_closed,\n        ticket_pipeline_stage.pipeline_stage_label,\n        ticket_pipeline.pipeline_label,\n        ticket_pipeline_stage.display_order as pipeline_stage_order,\n        ticket_pipeline.is_ticket_pipeline_deleted,\n        ticket_pipeline_stage.is_ticket_pipeline_stage_deleted\n\n    \n        , owner.email_address as owner_email\n        , owner.full_name as owner_full_name\n    \n\n    \n\n    \n        , agg_contacts.contact_ids\n        , agg_contacts.contact_emails\n    \n\n    \n        , agg_companies.company_ids\n        , agg_companies.company_names\n    \n\n    \n        \n        , coalesce(agg_engagements.count_engagement_notes,0) as count_engagement_notes\n        \n        , coalesce(agg_engagements.count_engagement_tasks,0) as count_engagement_tasks\n        \n        , coalesce(agg_engagements.count_engagement_calls,0) as count_engagement_calls\n        \n        , coalesce(agg_engagements.count_engagement_meetings,0) as count_engagement_meetings\n        \n        , coalesce(agg_engagements.count_engagement_emails,0) as count_engagement_emails\n        \n        , coalesce(agg_engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails\n        \n        , coalesce(agg_engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails\n        \n    \n\n    from ticket\n\n    left join ticket_pipeline \n        on ticket.ticket_pipeline_id = ticket_pipeline.ticket_pipeline_id \n    \n    left join ticket_pipeline_stage \n        on ticket.ticket_pipeline_stage_id = ticket_pipeline_stage.ticket_pipeline_stage_id\n        and ticket_pipeline.ticket_pipeline_id = ticket_pipeline_stage.ticket_pipeline_id\n\n    \n    left join owner \n        on ticket.owner_id = owner.owner_id\n    \n\n    \n\n    \n    left join agg_contacts\n        on ticket.ticket_id = agg_contacts.ticket_id \n    \n\n    \n    left join agg_companies\n        on ticket.ticket_id = agg_companies.ticket_id \n    \n\n    \n    left join agg_engagements\n        on ticket.ticket_id = agg_engagements.ticket_id\n    \n)\n\nselect *\nfrom final_join", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.702374Z", "completed_at": "2024-07-24T18:42:27.707259Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.707705Z", "completed_at": "2024-07-24T18:42:27.707708Z"}], "thread_id": "Thread-5", "execution_time": 0.005789041519165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__engagement_metrics__by_contact_contact_id.1c156b64ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n) select\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__engagement_metrics__by_contact\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.708043Z", "completed_at": "2024-07-24T18:42:27.715024Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.715272Z", "completed_at": "2024-07-24T18:42:27.715277Z"}], "thread_id": "Thread-3", "execution_time": 0.008351802825927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_stages_deal_stage_id.162d2d204b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_stage_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deal_stages\"\nwhere deal_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.711455Z", "completed_at": "2024-07-24T18:42:27.715901Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.716365Z", "completed_at": "2024-07-24T18:42:27.716369Z"}], "thread_id": "Thread-5", "execution_time": 0.0054247379302978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_stages_deal_stage_id.7fd3732373", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_stage_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deal_stages\" where not coalesce(is_deal_pipeline_stage_deleted, false)) dbt_subquery\nwhere deal_stage_id is not null\ngroup by deal_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.717153Z", "completed_at": "2024-07-24T18:42:27.723040Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.723246Z", "completed_at": "2024-07-24T18:42:27.723250Z"}], "thread_id": "Thread-3", "execution_time": 0.007170915603637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deals_deal_id.bdbfe47fcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deals\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.720275Z", "completed_at": "2024-07-24T18:42:27.724248Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.734301Z", "completed_at": "2024-07-24T18:42:27.734306Z"}], "thread_id": "Thread-5", "execution_time": 0.014561176300048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deals_deal_id.d728fe5f71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__deals\" where not coalesce(is_deal_deleted, false)) dbt_subquery\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.724442Z", "completed_at": "2024-07-24T18:42:27.741075Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.747614Z", "completed_at": "2024-07-24T18:42:27.747622Z"}], "thread_id": "Thread-3", "execution_time": 0.02389812469482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__daily_ticket_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_property_history\"\n\n    -- should we include an option pivot out ALL properties? in the same vein as our passthrough-all-columns var\n    where lower(field_name) in \n        ('hs_pipeline', 'hs_pipeline_stage'\n    )\n\n    \n    and change_timestamp >= (select cast(max(date_day) as timestamp) from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__daily_ticket_history\" )\n    \n\n), windows as (\n\n    select\n        cast(date_trunc('day', change_timestamp) as date) as date_day,\n        ticket_id,\n        field_name,\n        new_value,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        _fivetran_end as valid_to\n        -- if it is currently active fivetran_end = 9999-12-31 23:59:59, but the calendar_spine will end at the current_date\n    from history\n\n), order_daily_changes as (\n\n    select \n        *,\n        row_number() over (\n            partition by date_day, ticket_id, field_name\n            order by valid_from desc\n            ) as row_num\n    from windows\n\n), extract_latest as (\n    \n    select \n        date_day,\n        ticket_id,\n        field_name,\n        case when new_value is null then 'is_null' else new_value end as new_value,\n        change_source,\n        change_source_id,\n        valid_from,\n        valid_to\n\n    from order_daily_changes\n    where row_num = 1\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from extract_latest\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.748731Z", "completed_at": "2024-07-24T18:42:27.753170Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.753427Z", "completed_at": "2024-07-24T18:42:27.753431Z"}], "thread_id": "Thread-3", "execution_time": 0.005172014236450195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_aggregate_status_change_email_send_id.16bf74a3bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n) select email_send_id\nfrom __dbt__cte__int_hubspot__email_aggregate_status_change\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.735452Z", "completed_at": "2024-07-24T18:42:27.758078Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.758320Z", "completed_at": "2024-07-24T18:42:27.758324Z"}], "thread_id": "Thread-5", "execution_time": 0.02337026596069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_sends", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n),  __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n), sends as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_sent\"\n\n), metrics as (\n\n    select *\n    from __dbt__cte__int_hubspot__email_event_aggregates\n\n), joined as (\n\n    select\n        sends.*,\n        coalesce(metrics.bounces,0) as bounces,\n        coalesce(metrics.clicks,0) as clicks,\n        coalesce(metrics.deferrals,0) as deferrals,\n        coalesce(metrics.deliveries,0) as deliveries,\n        coalesce(metrics.drops,0) as drops,\n        coalesce(metrics.forwards,0) as forwards,\n        coalesce(metrics.opens,0) as opens,\n        coalesce(metrics.prints,0) as prints,\n        coalesce(metrics.spam_reports,0) as spam_reports\n    from sends\n    left join metrics using (email_send_id)\n\n), booleans as (\n\n    select \n        *,\n        bounces > 0 as was_bounced,\n        clicks > 0 as was_clicked,\n        deferrals > 0 as was_deferred,\n        deliveries > 0 as was_delivered,\n        forwards > 0 as was_forwarded,\n        opens > 0 as was_opened,\n        prints > 0 as was_printed,\n        spam_reports > 0 as was_spam_reported\n    from joined\n\n\n\n), unsubscribes as (\n\n    select *\n    from __dbt__cte__int_hubspot__email_aggregate_status_change\n\n), unsubscribes_joined as (\n\n    select \n        booleans.*,\n        coalesce(unsubscribes.unsubscribes,0) as unsubscribes,\n        coalesce(unsubscribes.unsubscribes,0) > 0 as was_unsubcribed\n    from booleans\n    left join unsubscribes using (email_send_id)\n\n)\n\nselect *\nfrom unsubscribes_joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_sends\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.754399Z", "completed_at": "2024-07-24T18:42:27.759298Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.759696Z", "completed_at": "2024-07-24T18:42:27.759699Z"}], "thread_id": "Thread-3", "execution_time": 0.005747795104980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_aggregate_status_change_email_send_id.7c03e87c05", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n) select\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__email_aggregate_status_change\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.760034Z", "completed_at": "2024-07-24T18:42:27.766147Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.766531Z", "completed_at": "2024-07-24T18:42:27.766536Z"}], "thread_id": "Thread-5", "execution_time": 0.007595062255859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__tickets_ticket_id.259c6846d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.763381Z", "completed_at": "2024-07-24T18:42:27.766357Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.766885Z", "completed_at": "2024-07-24T18:42:27.766888Z"}], "thread_id": "Thread-3", "execution_time": 0.003993988037109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__tickets_ticket_id.4b54466361", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.768526Z", "completed_at": "2024-07-24T18:42:27.784994Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.785695Z", "completed_at": "2024-07-24T18:42:27.785702Z"}], "thread_id": "Thread-5", "execution_time": 0.018047809600830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__pivot_daily_ticket_history", "compiled": true, "compiled_code": "\n\n\n\nwith daily_history as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__daily_ticket_history\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__pivot_daily_ticket_history\" )\n    \n\n), pivot_out as (\n\n    select \n        date_day, \n        ticket_id\n\n        -- should we remove the `hs_` prefix? could introduce some duplicates if people already have something like `hs_owner` and `owner`\n        , max(case when lower(field_name) = 'hs_pipeline' then new_value end) as hs_pipeline\n        , max(case when lower(field_name) = 'hs_pipeline_stage' then new_value end) as hs_pipeline_stage\n        from daily_history\n\n    group by 1,2\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from pivot_out\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__pivot_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.305540Z", "completed_at": "2024-07-24T18:42:27.870639Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.870927Z", "completed_at": "2024-07-24T18:42:27.870936Z"}], "thread_id": "Thread-4", "execution_time": 0.6350781917572021, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_calls", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_call\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_calls\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.321677Z", "completed_at": "2024-07-24T18:42:27.893805Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.894113Z", "completed_at": "2024-07-24T18:42:27.894119Z"}], "thread_id": "Thread-1", "execution_time": 0.623633861541748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_meetings", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"created_from_link_id\",\n  base.\"end_time\",\n  base.\"pre_meeting_prospect_reminders\",\n  base.\"source\",\n  base.\"source_id\",\n  base.\"start_time\",\n  base.\"web_conference_meeting_id\",\n  base.\"meeting_outcome\",\n  base.\"body\",\n  base.\"external_url\",\n  base.\"title\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_meetings\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.950504Z", "completed_at": "2024-07-24T18:42:27.954730Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.954999Z", "completed_at": "2024-07-24T18:42:27.955006Z"}], "thread_id": "Thread-1", "execution_time": 0.012667179107666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_sends_event_id.9fc8a8bef3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_sends\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.956202Z", "completed_at": "2024-07-24T18:42:27.959696Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.959942Z", "completed_at": "2024-07-24T18:42:27.959948Z"}], "thread_id": "Thread-1", "execution_time": 0.0043315887451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_sends_event_id.b01306228f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_sends\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.317336Z", "completed_at": "2024-07-24T18:42:27.919289Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.919587Z", "completed_at": "2024-07-24T18:42:27.919593Z"}], "thread_id": "Thread-7", "execution_time": 0.6622440814971924, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_emails", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_email\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"all_owner_ids\",\n  base.\"all_team_ids\",\n  base.\"email_subject\",\n  base.\"email_text\",\n  base.\"lastmodifieddate\",\n  base.\"modified_by\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_emails\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.978882Z", "completed_at": "2024-07-24T18:42:27.982254Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.982483Z", "completed_at": "2024-07-24T18:42:27.982488Z"}], "thread_id": "Thread-7", "execution_time": 0.004221916198730469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_calls_engagement_id.00f8d8357f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_calls\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.983551Z", "completed_at": "2024-07-24T18:42:27.986668Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.986891Z", "completed_at": "2024-07-24T18:42:27.986895Z"}], "thread_id": "Thread-7", "execution_time": 0.003832101821899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_calls_engagement_id.972572ce6c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_calls\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.987967Z", "completed_at": "2024-07-24T18:42:27.990945Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.991158Z", "completed_at": "2024-07-24T18:42:27.991162Z"}], "thread_id": "Thread-7", "execution_time": 0.0037069320678710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_meetings_engagement_id.83a791c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_meetings\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.992187Z", "completed_at": "2024-07-24T18:42:27.995955Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:27.996169Z", "completed_at": "2024-07-24T18:42:27.996174Z"}], "thread_id": "Thread-7", "execution_time": 0.004456758499145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_meetings_engagement_id.3098aabcd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_meetings\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.997167Z", "completed_at": "2024-07-24T18:42:27.999946Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.000145Z", "completed_at": "2024-07-24T18:42:28.000150Z"}], "thread_id": "Thread-7", "execution_time": 0.003431081771850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_emails_engagement_id.13a39d1e09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_emails\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.001127Z", "completed_at": "2024-07-24T18:42:28.004517Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.004751Z", "completed_at": "2024-07-24T18:42:28.004758Z"}], "thread_id": "Thread-7", "execution_time": 0.004136085510253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_emails_engagement_id.b18e2acbde", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_emails\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.435754Z", "completed_at": "2024-07-24T18:42:28.043195Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.043437Z", "completed_at": "2024-07-24T18:42:28.043443Z"}], "thread_id": "Thread-8", "execution_time": 0.6566498279571533, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_notes", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_note\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"note\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"body_preview\",\n  base.\"lastmodifieddate\",\n  base.\"note_body\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_notes\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.094159Z", "completed_at": "2024-07-24T18:42:28.102750Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.103264Z", "completed_at": "2024-07-24T18:42:28.103269Z"}], "thread_id": "Thread-7", "execution_time": 0.010341882705688477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_notes_engagement_id.76434ac965", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_notes\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.098180Z", "completed_at": "2024-07-24T18:42:28.103017Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.103717Z", "completed_at": "2024-07-24T18:42:28.103721Z"}], "thread_id": "Thread-8", "execution_time": 0.010446786880493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_notes_engagement_id.c9864b5001", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_notes\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.464925Z", "completed_at": "2024-07-24T18:42:28.199539Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.199844Z", "completed_at": "2024-07-24T18:42:28.199851Z"}], "thread_id": "Thread-6", "execution_time": 0.8199090957641602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_tasks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_task\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n  base.\"task_type\",\n  base.\"object_id\",\n  base.\"engagement_source\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_tasks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.286993Z", "completed_at": "2024-07-24T18:42:28.296535Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.297184Z", "completed_at": "2024-07-24T18:42:28.297191Z"}], "thread_id": "Thread-7", "execution_time": 0.01181793212890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_tasks_engagement_id.67738794ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_tasks\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.292062Z", "completed_at": "2024-07-24T18:42:28.296872Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.297748Z", "completed_at": "2024-07-24T18:42:28.297753Z"}], "thread_id": "Thread-8", "execution_time": 0.011944293975830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_tasks_engagement_id.754d36b939", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagement_tasks\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.786979Z", "completed_at": "2024-07-24T18:42:28.382162Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.382385Z", "completed_at": "2024-07-24T18:42:28.382390Z"}], "thread_id": "Thread-5", "execution_time": 0.6547751426696777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_campaigns", "compiled": true, "compiled_code": "\n\n\nwith campaigns as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__email_campaign\"\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        email_campaign_id,\n        \n        sum(email_sends.bounces) as total_bounces,\n        count(distinct case when email_sends.bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(email_sends.clicks) as total_clicks,\n        count(distinct case when email_sends.clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(email_sends.deferrals) as total_deferrals,\n        count(distinct case when email_sends.deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(email_sends.deliveries) as total_deliveries,\n        count(distinct case when email_sends.deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(email_sends.drops) as total_drops,\n        count(distinct case when email_sends.drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(email_sends.forwards) as total_forwards,\n        count(distinct case when email_sends.forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(email_sends.opens) as total_opens,\n        count(distinct case when email_sends.opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(email_sends.prints) as total_prints,\n        count(distinct case when email_sends.prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(email_sends.spam_reports) as total_spam_reports,\n        count(distinct case when email_sends.spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(email_sends.unsubscribes) as total_unsubscribes,\n        count(distinct case when email_sends.unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), joined as (\n\n    select \n        campaigns.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from campaigns\n    left join email_metrics\n        on campaigns.email_campaign_id = email_metrics.email_campaign_id\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_campaigns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.664728Z", "completed_at": "2024-07-24T18:42:28.377220Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.377496Z", "completed_at": "2024-07-24T18:42:28.377505Z"}], "thread_id": "Thread-2", "execution_time": 0.7785959243774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__ticket_calendar_spine", "compiled": true, "compiled_code": "\n\nwith calendar as (\n\n    \n    \n    \n    \n    \n\n    select * \n    from (\n        \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1567\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2020-04-16' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= \n\n    \n    (current_timestamp at time zone 'utc')::timestamp\n + ((interval '1 week') * (1))\n\n\n\n)\n\nselect * from filtered\n\n \n    ) as date_spine\n\n    \n    where date_day >= (select min(date_day) from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__ticket_calendar_spine\" )\n    \n\n), ticket as (\n\n    select \n        *,\n        cast( date_trunc('day', case when closed_date is null then \n    current_timestamp::timestamp\n else closed_date end) as date) as open_until\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket\"\n    where not coalesce(is_ticket_deleted, false)\n\n), joined as (\n\n    select \n        cast(calendar.date_day as date) as date_day,\n        ticket.ticket_id\n    from calendar \n    inner join ticket\n        on cast(calendar.date_day as date) >= cast(ticket.created_date as date)\n        -- use this variable to extend the ticket's history past its close date (for reporting/data viz purposes :-)\n        and cast(calendar.date_day as date) <= \n\n    ticket.open_until + ((interval '1 day') * (0))\n\n\n\n), surrogate as (\n\n    select\n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from joined\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__ticket_calendar_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.775056Z", "completed_at": "2024-07-24T18:42:28.377933Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.378143Z", "completed_at": "2024-07-24T18:42:28.378146Z"}], "thread_id": "Thread-3", "execution_time": 0.6744017601013184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contacts", "compiled": true, "compiled_code": "\n\n\n\nwith  __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n), contacts as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        recipient_email_address,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), email_joined as (\n\n    select \n        contacts.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contacts\n    left join email_metrics\n        on contacts.email = email_metrics.recipient_email_address\n\n\n\n\n\n\n\n), engagements as (\n\n    select *\n    from __dbt__cte__int_hubspot__engagement_metrics__by_contact\n\n), engagements_joined as (\n\n    select \n        email_joined.*,\n        \n        coalesce(engagements.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagements.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagements.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagements.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagements.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from email_joined\n    left join engagements\n        using (contact_id)\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contacts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.451973Z", "completed_at": "2024-07-24T18:42:28.461731Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.462202Z", "completed_at": "2024-07-24T18:42:28.462207Z"}], "thread_id": "Thread-2", "execution_time": 0.017077922821044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_campaigns_email_campaign_id.2470fabe62", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.447015Z", "completed_at": "2024-07-24T18:42:28.461986Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.463000Z", "completed_at": "2024-07-24T18:42:28.463003Z"}], "thread_id": "Thread-6", "execution_time": 0.01818227767944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_campaigns_email_campaign_id.6b2d6f43c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.455115Z", "completed_at": "2024-07-24T18:42:28.462573Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.463421Z", "completed_at": "2024-07-24T18:42:28.463424Z"}], "thread_id": "Thread-8", "execution_time": 0.01799607276916504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contacts_contact_id.e28e88dce3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contacts\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.458102Z", "completed_at": "2024-07-24T18:42:28.462812Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.463773Z", "completed_at": "2024-07-24T18:42:28.463776Z"}], "thread_id": "Thread-5", "execution_time": 0.018067121505737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contacts_contact_id.8f627121df", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contacts\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.961097Z", "completed_at": "2024-07-24T18:42:28.589309Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.590085Z", "completed_at": "2024-07-24T18:42:28.590094Z"}], "thread_id": "Thread-1", "execution_time": 0.677839994430542, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__scd_daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__pivot_daily_ticket_history\"\n\n), set_values as (\n\n    select \n        date_day, \n        ticket_id,\n        id\n\n         \n        , hs_pipeline as hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_field_partition\n\n         \n        , hs_pipeline_stage as hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline_stage is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_stage_field_partition\n\n        \n    \n    from change_data\n\n), fill_values as (\n\n-- each row of the pivoted table includes ticket property values if that property was updated on that day\n-- we need to backfill to persist values that have been previously updated and are still valid \n    select \n        date_day, \n        ticket_id,\n        id\n        \n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n\n        \n\n    from set_values\n\n)\n\nselect *\nfrom fill_values", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__scd_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:27.943264Z", "completed_at": "2024-07-24T18:42:28.589704Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.590481Z", "completed_at": "2024-07-24T18:42:28.590486Z"}], "thread_id": "Thread-4", "execution_time": 0.697160005569458, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__email_metrics__by_contact_list", "compiled": true, "compiled_code": "\n\nwith email_sends as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__email_sends\"\n\n), contact_list_member as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list_member\"\n\n), joined as (\n\n    select\n        email_sends.*,\n        contact_list_member.contact_list_id\n    from email_sends\n    left join contact_list_member\n        using (contact_id)\n    where contact_list_member.contact_list_id is not null\n\n), email_metrics as (\n    \n    select \n        contact_list_id,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from joined\n    group by 1\n\n)\n\nselect *\nfrom email_metrics", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__email_metrics__by_contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.671580Z", "completed_at": "2024-07-24T18:42:28.680298Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.680553Z", "completed_at": "2024-07-24T18:42:28.680559Z"}], "thread_id": "Thread-2", "execution_time": 0.02361321449279785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_metrics__by_contact_list_contact_list_id.1d3cf4caf2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.675382Z", "completed_at": "2024-07-24T18:42:28.680972Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:28.681311Z", "completed_at": "2024-07-24T18:42:28.681316Z"}], "thread_id": "Thread-6", "execution_time": 0.018647193908691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_metrics__by_contact_list_contact_list_id.095d72d5b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.664169Z", "completed_at": "2024-07-24T18:42:29.256092Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:29.256562Z", "completed_at": "2024-07-24T18:42:29.256569Z"}], "thread_id": "Thread-7", "execution_time": 0.6548149585723877, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_lists", "compiled": true, "compiled_code": "\n\nwith contact_lists as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__contact_list\"\n\n\n\n), email_metrics as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\n\n), joined as (\n    \n    select \n        contact_lists.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contact_lists\n    left join email_metrics\n        using (contact_list_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contact_lists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:29.303740Z", "completed_at": "2024-07-24T18:42:29.307411Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:29.307898Z", "completed_at": "2024-07-24T18:42:29.307903Z"}], "thread_id": "Thread-1", "execution_time": 0.008831977844238281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_lists_contact_list_id.ea9ef03bac", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contact_lists\" where not coalesce(is_contact_list_deleted, false)) dbt_subquery\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:29.299891Z", "completed_at": "2024-07-24T18:42:29.307659Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:29.308314Z", "completed_at": "2024-07-24T18:42:29.308318Z"}], "thread_id": "Thread-5", "execution_time": 0.009532928466796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_lists_contact_list_id.3bde1bb891", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__contact_lists\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:28.643378Z", "completed_at": "2024-07-24T18:42:29.256336Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:29.256811Z", "completed_at": "2024-07-24T18:42:29.256814Z"}], "thread_id": "Thread-3", "execution_time": 0.6997661590576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__scd_daily_ticket_history\"\n\n\n    where date_day >= (select max(date_day) from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__daily_ticket_history\")\n\n-- If no issue fields have been updated since the last incremental run, the pivoted_daily_history CTE will return no record/rows.\n-- When this is the case, we need to grab the most recent day's records from the previously built table so that we can persist \n-- those values into the future.\n\n), most_recent_data as ( \n\n    select \n        *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__daily_ticket_history\"\n    where date_day = (select max(date_day) from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__daily_ticket_history\" )\n\n\n), calendar as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_hubspot\".\"int_hubspot__ticket_calendar_spine\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__daily_ticket_history\")\n    \n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"zz_hubspot_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\"\n\n), joined as (\n\n    select \n        calendar.date_day,\n        calendar.ticket_id\n            \n             \n            , coalesce(change_data.hs_pipeline, most_recent_data.hs_pipeline) as hs_pipeline\n             \n            , coalesce(change_data.hs_pipeline_stage, most_recent_data.hs_pipeline_stage) as hs_pipeline_stage\n            \n        \n        \n\n    from calendar\n    left join change_data\n        on calendar.ticket_id = change_data.ticket_id\n        and calendar.date_day = change_data.date_day\n    \n    \n    left join most_recent_data\n        on calendar.ticket_id = most_recent_data.ticket_id\n        and calendar.date_day = most_recent_data.date_day\n    \n\n), set_values as (\n\n    select \n        date_day,\n        ticket_id\n        \n        \n        , hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_partition\n        \n        , hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline_stage is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_stage_partition\n        \n\n    from joined\n\n), fill_values as (\n\n    select \n        date_day,\n        ticket_id\n\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n        \n\n    from set_values\n\n), fix_null_values as (\n\n    select \n        date_day,\n        ticket_id,\n        pipeline_stage.ticket_state,\n        pipeline.pipeline_label as hs_pipeline_label,\n        pipeline_stage.pipeline_stage_label as hs_pipeline_stage_label\n\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline as TEXT ) = 'is_null' then null else hs_pipeline end as hs_pipeline\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline_stage as TEXT ) = 'is_null' then null else hs_pipeline_stage end as hs_pipeline_stage\n        \n\n    from fill_values\n\n    left join pipeline \n        on cast(fill_values.hs_pipeline as integer) = pipeline.ticket_pipeline_id\n    left join pipeline_stage \n        on cast(fill_values.hs_pipeline_stage as integer) = pipeline_stage.ticket_pipeline_stage_id\n        and pipeline.ticket_pipeline_id = pipeline_stage.ticket_pipeline_id\n\n), surrogate as (\n\n    select\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as ticket_day_id,\n        *\n\n    from fix_null_values\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"zz_hubspot_hubspot\".\"hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:29.343014Z", "completed_at": "2024-07-24T18:42:29.350453Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:29.350982Z", "completed_at": "2024-07-24T18:42:29.350987Z"}], "thread_id": "Thread-8", "execution_time": 0.009227991104125977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__daily_ticket_history_ticket_day_id.087496580e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_day_id\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-24T18:42:29.346637Z", "completed_at": "2024-07-24T18:42:29.350738Z"}, {"name": "execute", "started_at": "2024-07-24T18:42:29.351426Z", "completed_at": "2024-07-24T18:42:29.351430Z"}], "thread_id": "Thread-2", "execution_time": 0.009341001510620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__daily_ticket_history_ticket_day_id.294440dc9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"zz_hubspot_hubspot\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is not null\ngroup by ticket_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 14.552547931671143, "args": {"exclude": [], "macro_debugging": false, "static": false, "vars": {}, "which": "generate", "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "static_parser": true, "invocation_command": "dbt docs generate", "use_colors": true, "log_format_file": "debug", "partial_parse_file_diff": true, "profiles_dir": "/Users/catherinefritz/.dbt", "empty_catalog": false, "print": true, "printer_width": 80, "partial_parse": true, "log_format": "default", "select": [], "compile": true, "log_path": "/Users/catherinefritz/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests/logs", "cache_selected_only": false, "send_anonymous_usage_stats": true, "log_level": "info", "write_json": true, "strict_mode": false, "populate_cache": true, "show_resource_report": false, "introspect": true, "warn_error_options": {"include": [], "exclude": []}, "version_check": true, "use_colors_file": true, "project_dir": "/Users/catherinefritz/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests", "enable_legacy_logger": false, "favor_state": false, "log_level_file": "debug", "require_resource_names_without_spaces": false, "source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "quiet": false, "indirect_selection": "eager"}}