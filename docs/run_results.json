{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-08-30T11:45:17.416025Z", "invocation_id": "2419e2bf-3594-4b5b-bc78-66c02e32ed94", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:46.129963Z", "completed_at": "2024-08-30T11:44:47.152757Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:47.153719Z", "completed_at": "2024-08-30T11:44:47.153722Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2398641109466553, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"deleteable\",\n  \"dynamic\",\n  \"metadata_error\",\n  \"metadata_last_processing_state_change_at\",\n  \"metadata_last_size_change_at\",\n  \"metadata_processing\",\n  \"metadata_size\",\n  \"offset\",\n  \"portal_id\",\n  \"updated_at\",\n  \"name\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_list_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:46.014673Z", "completed_at": "2024-08-30T11:44:47.152229Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:47.153025Z", "completed_at": "2024-08-30T11:44:47.153033Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2495019435882568, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"name\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"company_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:46.041677Z", "completed_at": "2024-08-30T11:44:47.228340Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:47.228906Z", "completed_at": "2024-08-30T11:44:47.228911Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3291640281677246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"is_deleted\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:46.125630Z", "completed_at": "2024-08-30T11:44:47.224278Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:47.224759Z", "completed_at": "2024-08-30T11:44:47.224766Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.3350141048431396, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"contact_list_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"added_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_list_member_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_member_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:47.342709Z", "completed_at": "2024-08-30T11:44:48.289264Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:48.289749Z", "completed_at": "2024-08-30T11:44:48.289755Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0518841743469238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_email\",\n  \"id\",\n  \"property_company\",\n  \"property_firstname\",\n  \"property_lastname\",\n  \"property_email_1\",\n  \"property_createdate\",\n  \"property_jobtitle\",\n  \"property_annualrevenue\",\n  \"property_hs_calculated_merged_vids\",\n  \"property_created_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:47.350020Z", "completed_at": "2024-08-30T11:44:48.300589Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:48.301060Z", "completed_at": "2024-08-30T11:44:48.301064Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0561418533325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"deal_id\",\n  \"type_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:47.262360Z", "completed_at": "2024-08-30T11:44:48.306406Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:48.306862Z", "completed_at": "2024-08-30T11:44:48.306866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1552660465240479, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"value\",\n  \"source_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:47.254793Z", "completed_at": "2024-08-30T11:44:48.312480Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:48.312977Z", "completed_at": "2024-08-30T11:44:48.312983Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1637308597564697, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_merge_audit_tmp", "compiled": true, "compiled_code": "\n\nselect \"canonical_vid\",\n  \"contact_id\",\n  \"vid_to_merge\",\n  \"_fivetran_synced\",\n  \"entity_id\",\n  \"first_name\",\n  \"last_name\",\n  \"num_properties_moved\",\n  \"timestamp\",\n  \"user_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_merge_audit_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_merge_audit_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:48.395327Z", "completed_at": "2024-08-30T11:44:49.404598Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:49.405088Z", "completed_at": "2024-08-30T11:44:49.405094Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.098844051361084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"deal_id\",\n  \"_fivetran_synced\",\n  \"type_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:48.425357Z", "completed_at": "2024-08-30T11:44:49.426666Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:49.427247Z", "completed_at": "2024-08-30T11:44:49.427251Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.121502161026001, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:48.420242Z", "completed_at": "2024-08-30T11:44:49.470281Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:49.470749Z", "completed_at": "2024-08-30T11:44:49.470753Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1653571128845215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_pipeline_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:48.406836Z", "completed_at": "2024-08-30T11:44:49.471174Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:49.471686Z", "completed_at": "2024-08-30T11:44:49.471689Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1798679828643799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"closed_won\",\n  \"display_order\",\n  \"probability\",\n  \"stage_id\",\n  \"label\",\n  \"pipeline_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_pipeline_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:49.494788Z", "completed_at": "2024-08-30T11:44:50.578067Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:50.578593Z", "completed_at": "2024-08-30T11:44:50.578601Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1918151378631592, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"deal_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"date_entered\",\n  \"source\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:49.543143Z", "completed_at": "2024-08-30T11:44:50.595193Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:50.595646Z", "completed_at": "2024-08-30T11:44:50.595650Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1642067432403564, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"owner_id\",\n  \"deal_pipeline_id\",\n  \"deal_pipeline_stage_id\",\n  \"is_deleted\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:49.590097Z", "completed_at": "2024-08-30T11:44:50.696714Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:50.697191Z", "completed_at": "2024-08-30T11:44:50.697197Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2101788520812988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"content_id\",\n  \"num_included\",\n  \"num_queued\",\n  \"sub_type\",\n  \"type\",\n  \"app_name\",\n  \"name\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_campaign_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:49.598193Z", "completed_at": "2024-08-30T11:44:50.702019Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:50.702472Z", "completed_at": "2024-08-30T11:44:50.702476Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.209630012512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"category\",\n  \"status\",\n  \"response\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_bounce_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:50.688283Z", "completed_at": "2024-08-30T11:44:51.654462Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:51.655035Z", "completed_at": "2024-08-30T11:44:51.655049Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0732190608978271, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"referer\",\n  \"browser\",\n  \"location\",\n  \"ip_address\",\n  \"url\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_click_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:50.707891Z", "completed_at": "2024-08-30T11:44:51.735939Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:51.736403Z", "completed_at": "2024-08-30T11:44:51.736408Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1332879066467285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"attempt\",\n  \"response\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_deferred_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:50.799818Z", "completed_at": "2024-08-30T11:44:51.835490Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:51.835981Z", "completed_at": "2024-08-30T11:44:51.835988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1482367515563965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"response\",\n  \"smtp_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_delivered_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:50.804046Z", "completed_at": "2024-08-30T11:44:51.841813Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:51.846882Z", "completed_at": "2024-08-30T11:44:51.846888Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1489999294281006, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"drop_reason\",\n  \"bcc\",\n  \"cc\",\n  \"drop_message\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_dropped_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:51.764867Z", "completed_at": "2024-08-30T11:44:52.775360Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:52.775854Z", "completed_at": "2024-08-30T11:44:52.775860Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1143860816955566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_forward_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:51.842504Z", "completed_at": "2024-08-30T11:44:52.811725Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:52.812268Z", "completed_at": "2024-08-30T11:44:52.812273Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0739259719848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"duration\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_open_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:51.955069Z", "completed_at": "2024-08-30T11:44:52.930334Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:52.930792Z", "completed_at": "2024-08-30T11:44:52.930796Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0940420627593994, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bcc\",\n  \"cc\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_sent_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:51.949762Z", "completed_at": "2024-08-30T11:44:52.997550Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:52.998032Z", "completed_at": "2024-08-30T11:44:52.998037Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1477837562561035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_print_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:52.917286Z", "completed_at": "2024-08-30T11:44:53.823208Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:53.823732Z", "completed_at": "2024-08-30T11:44:53.823738Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.013719081878662, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bounced\",\n  \"portal_subscription_status\",\n  \"requested_by\",\n  \"source\",\n  \"subscriptions\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_status_change_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:52.878461Z", "completed_at": "2024-08-30T11:44:53.895326Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:53.896801Z", "completed_at": "2024-08-30T11:44:53.896815Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1370189189910889, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"ip_address\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_spam_report_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:53.045803Z", "completed_at": "2024-08-30T11:44:54.027017Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:54.027490Z", "completed_at": "2024-08-30T11:44:54.027496Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0959279537200928, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"caused_by_created\",\n  \"caused_by_id\",\n  \"created\",\n  \"email_campaign_id\",\n  \"obsoleted_by_created\",\n  \"obsoleted_by_id\",\n  \"portal_id\",\n  \"sent_by_created\",\n  \"sent_by_id\",\n  \"type\",\n  \"filtered_event\",\n  \"recipient\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:53.097400Z", "completed_at": "2024-08-30T11:44:54.091411Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:54.091901Z", "completed_at": "2024-08-30T11:44:54.091908Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1021530628204346, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_timestamp\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_call_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:53.933448Z", "completed_at": "2024-08-30T11:44:54.928013Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:54.928519Z", "completed_at": "2024-08-30T11:44:54.928524Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.10760498046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:54.017033Z", "completed_at": "2024-08-30T11:44:55.052993Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:55.053459Z", "completed_at": "2024-08-30T11:44:55.053464Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.144792079925537, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:54.200925Z", "completed_at": "2024-08-30T11:44:55.170439Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:55.170857Z", "completed_at": "2024-08-30T11:44:55.170860Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0695090293884277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_all_owner_ids\",\n  \"property_hs_all_team_ids\",\n  \"property_hs_createdate\",\n  \"property_hs_email_subject\",\n  \"property_hs_email_text\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_modified_by\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_email_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:54.142950Z", "completed_at": "2024-08-30T11:44:55.169322Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:55.169872Z", "completed_at": "2024-08-30T11:44:55.169880Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.137559175491333, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:55.041949Z", "completed_at": "2024-08-30T11:44:56.029677Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:56.030147Z", "completed_at": "2024-08-30T11:44:56.030153Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1081669330596924, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_synced\",\n  \"created_from_link_id\",\n  \"end_time\",\n  \"pre_meeting_prospect_reminders\",\n  \"source\",\n  \"source_id\",\n  \"start_time\",\n  \"web_conference_meeting_id\",\n  \"meeting_outcome\",\n  \"body\",\n  \"external_url\",\n  \"title\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_meeting_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:55.162475Z", "completed_at": "2024-08-30T11:44:56.163868Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:56.164347Z", "completed_at": "2024-08-30T11:44:56.164353Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1046838760375977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_body_preview\",\n  \"property_hs_createdate\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_note_body\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_note_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:55.281124Z", "completed_at": "2024-08-30T11:44:56.275027Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:56.275490Z", "completed_at": "2024-08-30T11:44:56.275495Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.102766752243042, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"type\",\n  \"_fivetran_synced\",\n  \"portal_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:55.273827Z", "completed_at": "2024-08-30T11:44:56.318016Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:56.318476Z", "completed_at": "2024-08-30T11:44:56.318481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.151304006576538, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_object_id\",\n  \"property_hs_task_type\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\",\n  \"task_type\",\n  \"property_hs_engagement_source\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_task_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:56.152088Z", "completed_at": "2024-08-30T11:44:57.136373Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:57.136871Z", "completed_at": "2024-08-30T11:44:57.136877Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0919208526611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__merged_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"merged_deal_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"merged_deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:56.267974Z", "completed_at": "2024-08-30T11:44:57.318414Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:57.318892Z", "completed_at": "2024-08-30T11:44:57.318899Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.156221866607666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner_tmp", "compiled": true, "compiled_code": "\n\nselect \"owner_id\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"portal_id\",\n  \"type\",\n  \"updated_at\",\n  \"email\",\n  \"first_name\",\n  \"last_name\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"owner_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:56.384765Z", "completed_at": "2024-08-30T11:44:57.434275Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:57.434717Z", "completed_at": "2024-08-30T11:44:57.434722Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1655809879302979, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option_tmp", "compiled": true, "compiled_code": "\n\nselect \"label\",\n  \"property_id\",\n  \"_fivetran_synced\",\n  \"display_order\",\n  \"hidden\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"property_option_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_option_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:56.426406Z", "completed_at": "2024-08-30T11:44:57.470870Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:57.471338Z", "completed_at": "2024-08-30T11:44:57.471342Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1510541439056396, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_id\",\n  \"_fivetran_synced\",\n  \"calculated\",\n  \"created_at\",\n  \"description\",\n  \"field_type\",\n  \"group_name\",\n  \"hubspot_defined\",\n  \"hubspot_object\",\n  \"label\",\n  \"name\",\n  \"show_currency_symbol\",\n  \"type\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"property_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:57.246241Z", "completed_at": "2024-08-30T11:44:58.273839Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.274300Z", "completed_at": "2024-08-30T11:44:58.274305Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1389410495758057, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"company_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:57.424947Z", "completed_at": "2024-08-30T11:44:58.366274Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.366763Z", "completed_at": "2024-08-30T11:44:58.366769Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.059617042541504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"contact_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:57.578321Z", "completed_at": "2024-08-30T11:44:58.496896Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.497379Z", "completed_at": "2024-08-30T11:44:58.497384Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0253193378448486, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"stage_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"is_closed\",\n  \"label\",\n  \"pipeline_id\",\n  \"ticket_state\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_pipeline_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:57.553055Z", "completed_at": "2024-08-30T11:44:58.618457Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.619047Z", "completed_at": "2024-08-30T11:44:58.619053Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1774399280548096, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"engagement_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_engagement_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.730961Z", "completed_at": "2024-08-30T11:44:58.733844Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.735055Z", "completed_at": "2024-08-30T11:44:58.735064Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006796836853027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.738040Z", "completed_at": "2024-08-30T11:44:58.739189Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.739675Z", "completed_at": "2024-08-30T11:44:58.739680Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0028302669525146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.741130Z", "completed_at": "2024-08-30T11:44:58.742098Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.742593Z", "completed_at": "2024-08-30T11:44:58.742602Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002775907516479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.745065Z", "completed_at": "2024-08-30T11:44:58.746846Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.747324Z", "completed_at": "2024-08-30T11:44:58.747328Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003448009490966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.748858Z", "completed_at": "2024-08-30T11:44:58.749798Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.750237Z", "completed_at": "2024-08-30T11:44:58.750241Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002357006072998047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_member_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.751627Z", "completed_at": "2024-08-30T11:44:58.752588Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.753004Z", "completed_at": "2024-08-30T11:44:58.753007Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022559165954589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_merge_audit_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.754493Z", "completed_at": "2024-08-30T11:44:58.755521Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.755987Z", "completed_at": "2024-08-30T11:44:58.755991Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0024690628051757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.757394Z", "completed_at": "2024-08-30T11:44:58.758378Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.758811Z", "completed_at": "2024-08-30T11:44:58.758815Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0023179054260253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.760199Z", "completed_at": "2024-08-30T11:44:58.761749Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.762173Z", "completed_at": "2024-08-30T11:44:58.762176Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002850055694580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.763520Z", "completed_at": "2024-08-30T11:44:58.764455Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.764858Z", "completed_at": "2024-08-30T11:44:58.764861Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022020339965820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.766173Z", "completed_at": "2024-08-30T11:44:58.767100Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.767520Z", "completed_at": "2024-08-30T11:44:58.767525Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0021910667419433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.768979Z", "completed_at": "2024-08-30T11:44:58.770023Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.770496Z", "completed_at": "2024-08-30T11:44:58.770501Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0025322437286376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.771911Z", "completed_at": "2024-08-30T11:44:58.772880Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.773311Z", "completed_at": "2024-08-30T11:44:58.773315Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002286195755004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.774663Z", "completed_at": "2024-08-30T11:44:58.775615Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.776034Z", "completed_at": "2024-08-30T11:44:58.776037Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022318363189697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.777446Z", "completed_at": "2024-08-30T11:44:58.819533Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.820168Z", "completed_at": "2024-08-30T11:44:58.820174Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04368090629577637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_campaign_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.821713Z", "completed_at": "2024-08-30T11:44:58.822688Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.823238Z", "completed_at": "2024-08-30T11:44:58.823242Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002540111541748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_bounce_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.824771Z", "completed_at": "2024-08-30T11:44:58.825805Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.826251Z", "completed_at": "2024-08-30T11:44:58.826256Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0024290084838867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_click_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.827631Z", "completed_at": "2024-08-30T11:44:58.828587Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.829001Z", "completed_at": "2024-08-30T11:44:58.829004Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022389888763427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.830577Z", "completed_at": "2024-08-30T11:44:58.831571Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.832038Z", "completed_at": "2024-08-30T11:44:58.832042Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0025327205657958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_deferred_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.833431Z", "completed_at": "2024-08-30T11:44:58.835127Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.835640Z", "completed_at": "2024-08-30T11:44:58.835643Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0030829906463623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_delivered_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.836999Z", "completed_at": "2024-08-30T11:44:58.837971Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.838387Z", "completed_at": "2024-08-30T11:44:58.838391Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022559165954589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_dropped_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.839706Z", "completed_at": "2024-08-30T11:44:58.840651Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.841158Z", "completed_at": "2024-08-30T11:44:58.841161Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0023040771484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_forward_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.842560Z", "completed_at": "2024-08-30T11:44:58.843482Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.843903Z", "completed_at": "2024-08-30T11:44:58.843906Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002209186553955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_open_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.845227Z", "completed_at": "2024-08-30T11:44:58.846210Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.846741Z", "completed_at": "2024-08-30T11:44:58.846744Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0024149417877197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_print_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.848259Z", "completed_at": "2024-08-30T11:44:58.849281Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.849700Z", "completed_at": "2024-08-30T11:44:58.849704Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0023469924926757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_sent_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.851142Z", "completed_at": "2024-08-30T11:44:58.853170Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.853780Z", "completed_at": "2024-08-30T11:44:58.853784Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003628969192504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_spam_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.855206Z", "completed_at": "2024-08-30T11:44:58.856131Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.856537Z", "completed_at": "2024-08-30T11:44:58.856540Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0021948814392089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_status_change_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.857846Z", "completed_at": "2024-08-30T11:44:58.858754Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.859149Z", "completed_at": "2024-08-30T11:44:58.859152Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002141237258911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_call_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.860571Z", "completed_at": "2024-08-30T11:44:58.861506Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.861934Z", "completed_at": "2024-08-30T11:44:58.861937Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002301931381225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.863266Z", "completed_at": "2024-08-30T11:44:58.864220Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.864631Z", "completed_at": "2024-08-30T11:44:58.864634Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022127628326416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.865925Z", "completed_at": "2024-08-30T11:44:58.867500Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.867907Z", "completed_at": "2024-08-30T11:44:58.867910Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0028128623962402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.869221Z", "completed_at": "2024-08-30T11:44:58.870212Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.870840Z", "completed_at": "2024-08-30T11:44:58.870846Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0025348663330078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.872319Z", "completed_at": "2024-08-30T11:44:58.873451Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.873896Z", "completed_at": "2024-08-30T11:44:58.873899Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002482891082763672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.875254Z", "completed_at": "2024-08-30T11:44:58.876278Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.876691Z", "completed_at": "2024-08-30T11:44:58.876694Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002310037612915039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_meeting_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.878317Z", "completed_at": "2024-08-30T11:44:58.879371Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.879818Z", "completed_at": "2024-08-30T11:44:58.879822Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0025298595428466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_note_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.881305Z", "completed_at": "2024-08-30T11:44:58.883213Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.883696Z", "completed_at": "2024-08-30T11:44:58.883700Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003329038619995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_task_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.885157Z", "completed_at": "2024-08-30T11:44:58.886185Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.886587Z", "completed_at": "2024-08-30T11:44:58.886590Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002317190170288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.merged_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.887860Z", "completed_at": "2024-08-30T11:44:58.888801Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.889195Z", "completed_at": "2024-08-30T11:44:58.889198Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0021431446075439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.owner_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.890455Z", "completed_at": "2024-08-30T11:44:58.891346Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.891740Z", "completed_at": "2024-08-30T11:44:58.891743Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0020987987518310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.893004Z", "completed_at": "2024-08-30T11:44:58.893906Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.894295Z", "completed_at": "2024-08-30T11:44:58.894298Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002183198928833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_option_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.895894Z", "completed_at": "2024-08-30T11:44:58.897004Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.897455Z", "completed_at": "2024-08-30T11:44:58.897459Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003481149673461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.899831Z", "completed_at": "2024-08-30T11:44:58.900767Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.901180Z", "completed_at": "2024-08-30T11:44:58.901183Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022461414337158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.902584Z", "completed_at": "2024-08-30T11:44:58.903554Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.903975Z", "completed_at": "2024-08-30T11:44:58.903978Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002259969711303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.905317Z", "completed_at": "2024-08-30T11:44:58.906260Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.906685Z", "completed_at": "2024-08-30T11:44:58.906688Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022301673889160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.908020Z", "completed_at": "2024-08-30T11:44:58.908989Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.909397Z", "completed_at": "2024-08-30T11:44:58.909400Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022211074829101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.910767Z", "completed_at": "2024-08-30T11:44:58.911686Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.912107Z", "completed_at": "2024-08-30T11:44:58.912110Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022482872009277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.913449Z", "completed_at": "2024-08-30T11:44:58.915177Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.915596Z", "completed_at": "2024-08-30T11:44:58.915599Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0030121803283691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.916979Z", "completed_at": "2024-08-30T11:44:58.917903Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:58.918307Z", "completed_at": "2024-08-30T11:44:58.918310Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022439956665039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.386775Z", "completed_at": "2024-08-30T11:44:59.421078Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:59.421617Z", "completed_at": "2024-08-30T11:44:59.421632Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.139549970626831, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"object_type_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_pipeline_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.485434Z", "completed_at": "2024-08-30T11:44:59.468152Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:59.468594Z", "completed_at": "2024-08-30T11:44:59.468598Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0913341045379639, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"name\",\n  \"ticket_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"timestamp_instant\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.604369Z", "completed_at": "2024-08-30T11:44:59.641093Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:59.641784Z", "completed_at": "2024-08-30T11:44:59.641795Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2515950202941895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"id\",\n  \"is_deleted\",\n  \"property_closed_date\",\n  \"property_createdate\",\n  \"property_first_agent_reply_date\",\n  \"property_hs_pipeline\",\n  \"property_hs_pipeline_stage\",\n  \"property_hs_ticket_category\",\n  \"property_hs_ticket_priority\",\n  \"property_hubspot_owner_id\",\n  \"property_subject\",\n  \"property_content\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:58.919663Z", "completed_at": "2024-08-30T11:44:59.993119Z"}, {"name": "execute", "started_at": "2024-08-30T11:44:59.993624Z", "completed_at": "2024-08-30T11:44:59.993631Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1826069355010986, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    deleteable\n    \n as \n    \n    deleteable\n    \n, \n    \n    \n    dynamic\n    \n as \n    \n    dynamic\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metadata_error\n    \n as \n    \n    metadata_error\n    \n, \n    \n    \n    metadata_last_processing_state_change_at\n    \n as \n    \n    metadata_last_processing_state_change_at\n    \n, \n    \n    \n    metadata_last_size_change_at\n    \n as \n    \n    metadata_last_size_change_at\n    \n, \n    \n    \n    metadata_processing\n    \n as \n    \n    metadata_processing\n    \n, \n    \n    \n    metadata_size\n    \n as \n    \n    metadata_size\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        deleteable as is_deletable,\n        dynamic as is_dynamic,\n        id as contact_list_id,\n        metadata_error,\n        cast(metadata_last_processing_state_change_at as timestamp) as metadata_last_processing_state_change_at,\n        cast(metadata_last_size_change_at as timestamp) as metadata_last_size_change_at,\n        metadata_processing,\n        metadata_size,\n        name as contact_list_name,\n        portal_id,\n        cast(updated_at as timestamp) as updated_timestamp\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:59.526828Z", "completed_at": "2024-08-30T11:45:00.675172Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:00.675950Z", "completed_at": "2024-08-30T11:45:00.675958Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2523930072784424, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_company_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:59.579616Z", "completed_at": "2024-08-30T11:45:00.675688Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:00.676937Z", "completed_at": "2024-08-30T11:45:00.676942Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.2104809284210205, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    id\n    \n as company_id , \n    \n    \n    is_deleted\n    \n as is_company_deleted , \n    cast(null as TEXT) as company_name , \n    cast(null as TEXT) as description , \n    cast(null as timestamp) as created_date , \n    cast(null as TEXT) as industry , \n    cast(null as TEXT) as street_address , \n    cast(null as TEXT) as street_address_2 , \n    cast(null as TEXT) as city , \n    cast(null as TEXT) as state , \n    cast(null as TEXT) as country , \n    cast(null as integer) as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_company_columns.sql macro\n        company_id,\n        is_company_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_name,\n        description,\n        created_date,\n        industry,\n        street_address,\n        street_address_2,\n        city,\n        state,\n        country,\n        company_annual_revenue\n        \n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__company_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:44:59.856328Z", "completed_at": "2024-08-30T11:45:00.979561Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:00.980060Z", "completed_at": "2024-08-30T11:45:00.980068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2297742366790771, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_member_tmp\" \n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    added_at\n    \n as \n    \n    added_at\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    contact_list_id\n    \n as \n    \n    contact_list_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_member_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(added_at as timestamp) as added_timestamp,\n        contact_id,\n        contact_list_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_member\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:00.102963Z", "completed_at": "2024-08-30T11:45:01.045390Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:01.045874Z", "completed_at": "2024-08-30T11:45:01.045879Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0438859462738037, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as is_contact_deleted , \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as contact_id , \n    \n    \n    property_hs_calculated_merged_vids\n    \n as calculated_merged_vids , \n    \n    \n    property_email\n    \n as email , \n    \n    \n    property_company\n    \n as contact_company , \n    \n    \n    property_firstname\n    \n as first_name , \n    \n    \n    property_lastname\n    \n as last_name , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_jobtitle\n    \n as job_title , \n    \n    \n    property_annualrevenue\n    \n as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns.\n        -- a few columns below are aliased within the macros/get_contact_columns.sql macro\n        contact_id,\n        is_contact_deleted,\n        calculated_merged_vids, -- will be null for BigQuery users until v3 api is rolled out to them\n        email,\n        contact_company,\n        first_name,\n        last_name,\n        cast(created_date as timestamp) as created_date,\n        job_title,\n        company_annual_revenue,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n\n        --The below macro adds the fields defined within your hubspot__contact_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__contact_calculated_fields variable.\n        \n\n\n\n    from macro\n    \n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:00.789899Z", "completed_at": "2024-08-30T11:45:01.784474Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:01.784968Z", "completed_at": "2024-08-30T11:45:01.784975Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0946531295776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        contact_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_contact_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:00.779812Z", "completed_at": "2024-08-30T11:45:01.785439Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:01.785913Z", "completed_at": "2024-08-30T11:45:01.785916Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1479029655456543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_company_tmp\"\n\n), macro as (\n\n    select \n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        company_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:01.086973Z", "completed_at": "2024-08-30T11:45:02.101540Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:02.102131Z", "completed_at": "2024-08-30T11:45:02.102134Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1115121841430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_merge_audit", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_merge_audit_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    canonical_vid\n    \n as \n    \n    canonical_vid\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    entity_id\n    \n as \n    \n    entity_id\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    num_properties_moved\n    \n as \n    \n    num_properties_moved\n    \n, \n    \n    \n    timestamp\n    \n as \n    \n    timestamp\n    \n, \n    \n    \n    user_id\n    \n as \n    \n    user_id\n    \n, \n    \n    \n    vid_to_merge\n    \n as \n    \n    vid_to_merge\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        canonical_vid,\n        contact_id,\n        entity_id,\n        first_name,\n        last_name,\n        num_properties_moved,\n        cast( \n        timestamp\n        as timestamp) as timestamp_at,\n        user_id,\n        vid_to_merge,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_merge_audit\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:01.148849Z", "completed_at": "2024-08-30T11:45:02.100499Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:02.101092Z", "completed_at": "2024-08-30T11:45:02.101099Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0561473369598389, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_contact_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        contact_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:01.928369Z", "completed_at": "2024-08-30T11:45:02.939694Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:02.940170Z", "completed_at": "2024-08-30T11:45:02.940178Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.131321907043457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        cast(pipeline_id as TEXT) as deal_pipeline_id,\n        created_at as deal_pipeline_created_at,\n        updated_at as deal_pipeline_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:01.885188Z", "completed_at": "2024-08-30T11:45:02.946911Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:02.947360Z", "completed_at": "2024-08-30T11:45:02.947363Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1850402355194092, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_deal_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:02.199015Z", "completed_at": "2024-08-30T11:45:03.139588Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:03.140079Z", "completed_at": "2024-08-30T11:45:03.140087Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0367767810821533, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    closed_won\n    \n as \n    \n    closed_won\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    probability\n    \n as \n    \n    probability\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        closed_won as is_closed_won,\n        display_order,\n        label as pipeline_stage_label,\n        pipeline_id as deal_pipeline_id,\n        probability,\n        cast(stage_id as TEXT) as deal_pipeline_stage_id,\n        created_at as deal_pipeline_stage_created_at,\n        updated_at as deal_pipeline_stage_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:02.206004Z", "completed_at": "2024-08-30T11:45:03.272716Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:03.273204Z", "completed_at": "2024-08-30T11:45:03.273210Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1779839992523193, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_active\n    \n as \n    \n    _fivetran_active\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    date_entered\n    \n as \n    \n    date_entered\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date_entered as timestamp) as date_entered,\n        deal_id,\n        source,\n        source_id,\n        value as deal_stage_name,\n        _fivetran_active,\n        cast(_fivetran_end as timestamp) as _fivetran_end,\n        cast(_fivetran_start as timestamp) as _fivetran_start\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:03.070822Z", "completed_at": "2024-08-30T11:45:04.066058Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:04.066820Z", "completed_at": "2024-08-30T11:45:04.066827Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1076862812042236, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    content_id\n    \n as \n    \n    content_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    num_included\n    \n as \n    \n    num_included\n    \n, \n    \n    \n    num_queued\n    \n as \n    \n    num_queued\n    \n, \n    \n    \n    sub_type\n    \n as \n    \n    sub_type\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        app_name,\n        content_id,\n        id as email_campaign_id,\n        name as email_campaign_name,\n        num_included,\n        num_queued,\n        sub_type as email_campaign_sub_type,\n        subject as email_campaign_subject,\n        type as email_campaign_type\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:03.061528Z", "completed_at": "2024-08-30T11:45:04.066564Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:04.067501Z", "completed_at": "2024-08-30T11:45:04.067504Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1177539825439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    deal_pipeline_id\n    \n as \n    \n    deal_pipeline_id\n    \n, \n    \n    \n    deal_pipeline_stage_id\n    \n as \n    \n    deal_pipeline_stage_id\n    \n, \n    \n    \n    is_deleted\n    \n as is_deal_deleted , \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    cast(null as integer) as \n    \n    portal_id\n    \n , \n    cast(null as TEXT) as deal_name , \n    cast(null as TEXT) as description , \n    cast(null as integer) as amount , \n    cast(null as timestamp) as closed_date , \n    cast(null as timestamp) as created_date \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_deal_columns.sql macro\n        deal_name,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        is_deal_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        cast(deal_pipeline_id as TEXT) as deal_pipeline_id,\n        cast(deal_pipeline_stage_id as TEXT) as deal_pipeline_stage_id,\n        owner_id,\n        portal_id,\n        description,\n        amount\n\n        --The below macro adds the fields defined within your hubspot__deal_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__deal_calculated_fields variable.\n        \n\n\n\n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:03.236437Z", "completed_at": "2024-08-30T11:45:04.210584Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:04.211042Z", "completed_at": "2024-08-30T11:45:04.211048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0779619216918945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    category\n    \n as \n    \n    category\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n    from base\n    \n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        category as bounce_category,\n        id as event_id,\n        response as returned_response,\n        status as returned_status\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:03.385789Z", "completed_at": "2024-08-30T11:45:04.354923Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:04.355396Z", "completed_at": "2024-08-30T11:45:04.355403Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0687870979309082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    referer\n    \n as \n    \n    referer\n    \n, \n    \n    \n    url\n    \n as \n    \n    url\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        referer as referer_url,\n        url as click_url,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:04.180459Z", "completed_at": "2024-08-30T11:45:05.243783Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:05.244254Z", "completed_at": "2024-08-30T11:45:05.244259Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1635451316833496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    attempt\n    \n as \n    \n    attempt\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        attempt as attempt_number,\n        id as event_id,\n        response as returned_response\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:04.185211Z", "completed_at": "2024-08-30T11:45:05.237218Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:05.237688Z", "completed_at": "2024-08-30T11:45:05.237695Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1703848838806152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    smtp_id\n    \n as \n    \n    smtp_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        response as returned_response,\n        smtp_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:04.315013Z", "completed_at": "2024-08-30T11:45:05.366970Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:05.367429Z", "completed_at": "2024-08-30T11:45:05.367436Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1523191928863525, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    drop_message\n    \n as \n    \n    drop_message\n    \n, \n    \n    \n    drop_reason\n    \n as \n    \n    drop_reason\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        drop_message,\n        drop_reason,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_dropped_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:04.455075Z", "completed_at": "2024-08-30T11:45:05.514975Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:05.515452Z", "completed_at": "2024-08-30T11:45:05.515458Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.166883945465088, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:05.352069Z", "completed_at": "2024-08-30T11:45:06.293428Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:06.293913Z", "completed_at": "2024-08-30T11:45:06.293920Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0448060035705566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_sent_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:05.344254Z", "completed_at": "2024-08-30T11:45:06.355335Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:06.355809Z", "completed_at": "2024-08-30T11:45:06.355814Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1181840896606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    duration\n    \n as \n    \n    duration\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        duration as duration_open,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:05.467969Z", "completed_at": "2024-08-30T11:45:06.453598Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:06.454080Z", "completed_at": "2024-08-30T11:45:06.454087Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0940818786621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:05.622582Z", "completed_at": "2024-08-30T11:45:06.553678Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:06.554161Z", "completed_at": "2024-08-30T11:45:06.554168Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0383918285369873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bounced\n    \n as \n    \n    bounced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    portal_subscription_status\n    \n as \n    \n    portal_subscription_status\n    \n, \n    \n    \n    requested_by\n    \n as \n    \n    requested_by\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    subscriptions\n    \n as \n    \n    subscriptions\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bounced as is_bounced,\n        id as event_id,\n        portal_subscription_status as subscription_status,\n        requested_by as requested_by_email,\n        source as change_source,\n        subscriptions\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:06.399769Z", "completed_at": "2024-08-30T11:45:07.326415Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:07.326904Z", "completed_at": "2024-08-30T11:45:07.326911Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0360419750213623, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        ip_address,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:06.462970Z", "completed_at": "2024-08-30T11:45:07.394483Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:07.394954Z", "completed_at": "2024-08-30T11:45:07.394960Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.03000807762146, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    caused_by_created\n    \n as \n    \n    caused_by_created\n    \n, \n    \n    \n    caused_by_id\n    \n as \n    \n    caused_by_id\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_campaign_id\n    \n as \n    \n    email_campaign_id\n    \n, \n    \n    \n    filtered_event\n    \n as \n    \n    filtered_event\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    obsoleted_by_created\n    \n as \n    \n    obsoleted_by_created\n    \n, \n    \n    \n    obsoleted_by_id\n    \n as \n    \n    obsoleted_by_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    recipient\n    \n as \n    \n    recipient\n    \n, \n    \n    \n    sent_by_created\n    \n as \n    \n    sent_by_created\n    \n, \n    \n    \n    sent_by_id\n    \n as \n    \n    sent_by_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        cast(caused_by_created as timestamp) as caused_timestamp,\n        caused_by_id as caused_by_event_id,\n        cast(created as timestamp) as created_timestamp,\n        email_campaign_id,\n        filtered_event as is_filtered_event,\n        id as event_id,\n        cast(obsoleted_by_created as timestamp) as obsoleted_timestamp,\n        obsoleted_by_id as obsoleted_by_event_id,\n        portal_id,\n        recipient as recipient_email_address,\n        cast(sent_by_created as timestamp) as sent_timestamp,\n        sent_by_id as sent_by_event_id,\n        type as event_type\n    from macro\n    \n)\n\nselect *\nfrom fields\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:06.661835Z", "completed_at": "2024-08-30T11:45:07.616759Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:07.617778Z", "completed_at": "2024-08-30T11:45:07.617781Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.049757957458496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company_tmp\"\n\n), macro as (\n\n    select \n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:06.562601Z", "completed_at": "2024-08-30T11:45:07.615823Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:07.617052Z", "completed_at": "2024-08-30T11:45:07.617060Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1584272384643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:07.435876Z", "completed_at": "2024-08-30T11:45:08.365724Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:08.366204Z", "completed_at": "2024-08-30T11:45:08.366210Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0389549732208252, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:07.494620Z", "completed_at": "2024-08-30T11:45:08.456599Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:08.457068Z", "completed_at": "2024-08-30T11:45:08.457074Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0592660903930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_all_owner_ids\" as all_owner_ids\n        , \"property_hs_all_team_ids\" as all_team_ids\n        , \"property_hs_email_subject\" as email_subject\n        , \"property_hs_email_text\" as email_text\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_modified_by\" as modified_by\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:07.721998Z", "completed_at": "2024-08-30T11:45:08.734898Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:08.735376Z", "completed_at": "2024-08-30T11:45:08.735383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.115746259689331, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n , \n    cast(null as TEXT) as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    cast(null as timestamp) as created_timestamp , \n    cast(null as timestamp) as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"created_from_link_id\"\n        , \"end_time\"\n        , \"pre_meeting_prospect_reminders\"\n        , \"source\"\n        , \"source_id\"\n        , \"start_time\"\n        , \"web_conference_meeting_id\"\n        , \"meeting_outcome\"\n        , \"body\"\n        , \"external_url\"\n        , \"title\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:07.714181Z", "completed_at": "2024-08-30T11:45:08.742011Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:08.742453Z", "completed_at": "2024-08-30T11:45:08.742457Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1339478492736816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:08.474829Z", "completed_at": "2024-08-30T11:45:09.414851Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:09.415321Z", "completed_at": "2024-08-30T11:45:09.415327Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0444979667663574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    cast(null as TEXT) as note , \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_body_preview\" as body_preview\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_note_body\" as note_body\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:08.554136Z", "completed_at": "2024-08-30T11:45:09.596488Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:09.596960Z", "completed_at": "2024-08-30T11:45:09.596966Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.146202802658081, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as is_active , \n    cast(null as timestamp) as created_timestamp , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as integer) as \n    \n    owner_id\n    \n , \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    cast(null as timestamp) as occurred_timestamp , \n    \n    \n    type\n    \n as engagement_type \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as engagement_id,\n        created_timestamp,\n        owner_id,\n        occurred_timestamp,\n        portal_id,\n        engagement_type,\n        is_active\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:08.838345Z", "completed_at": "2024-08-30T11:45:09.811847Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:09.813473Z", "completed_at": "2024-08-30T11:45:09.813480Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0754799842834473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        , \"property_hs_task_type\" as task_type\n        \n        \n        \n\n        \n        \n        , \"property_hs_object_id\" as object_id\n        , \"property_hs_engagement_source\" as engagement_source\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:08.848116Z", "completed_at": "2024-08-30T11:45:09.812609Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:09.813727Z", "completed_at": "2024-08-30T11:45:09.813730Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0726649761199951, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__merged_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    merged_deal_id\n    \n as \n    \n    merged_deal_id\n    \n\n\n\n    from base\n\n), fields as (\n    \n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        merged_deal_id\n    from macro\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:09.520456Z", "completed_at": "2024-08-30T11:45:10.585174Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:10.585664Z", "completed_at": "2024-08-30T11:45:10.585671Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1668949127197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        email as email_address,\n        first_name,\n        last_name,\n        owner_id,\n        portal_id,\n        type as owner_type,\n        cast(updated_at as timestamp) as updated_timestamp,\n        trim( first_name || ' ' || last_name ) as full_name\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:09.701696Z", "completed_at": "2024-08-30T11:45:10.682624Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:10.683106Z", "completed_at": "2024-08-30T11:45:10.683112Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0723650455474854, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_option_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    property_id\n    \n as \n    \n    property_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    hidden\n    \n as \n    \n    hidden\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        label as property_option_label,\t\n        property_id,\n        _fivetran_synced,\n        display_order,\n        hidden,\n        value as property_option_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_option\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:09.921942Z", "completed_at": "2024-08-30T11:45:10.873806Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:10.874293Z", "completed_at": "2024-08-30T11:45:10.874299Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0635619163513184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_company_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:09.915080Z", "completed_at": "2024-08-30T11:45:10.910171Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:10.910634Z", "completed_at": "2024-08-30T11:45:10.910639Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0973188877105713, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    calculated\n    \n as \n    \n    calculated\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    field_type\n    \n as \n    \n    field_type\n    \n, \n    \n    \n    group_name\n    \n as \n    \n    group_name\n    \n, \n    \n    \n    hubspot_defined\n    \n as \n    \n    hubspot_defined\n    \n, \n    \n    \n    hubspot_object\n    \n as \n    \n    hubspot_object\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    show_currency_symbol\n    \n as \n    \n    show_currency_symbol\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_id,\n        _fivetran_synced,\n        calculated,\n        created_at,\n        description,\n        field_type,\n        group_name,\n        hubspot_defined,\n        hubspot_object,\n        label as property_label,\n        name as property_name,\n        type as property_type,\n        updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:10.687664Z", "completed_at": "2024-08-30T11:45:11.653593Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:11.654065Z", "completed_at": "2024-08-30T11:45:11.654072Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0650970935821533, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:10.774580Z", "completed_at": "2024-08-30T11:45:11.758641Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:11.759531Z", "completed_at": "2024-08-30T11:45:11.759540Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0819909572601318, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    is_closed\n    \n as \n    \n    is_closed\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    ticket_state\n    \n as \n    \n    ticket_state\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        _fivetran_deleted as is_ticket_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        is_closed,\n        label as pipeline_stage_label,\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        cast(stage_id as integer ) as ticket_pipeline_stage_id,\n        ticket_state,\n        created_at as ticket_pipeline_stage_created_at,\n        updated_at as ticket_pipeline_stage_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:11.012886Z", "completed_at": "2024-08-30T11:45:11.975930Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:11.976401Z", "completed_at": "2024-08-30T11:45:11.976408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0643651485443115, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    object_type_id\n    \n as \n    \n    object_type_id\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        _fivetran_deleted as is_ticket_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        object_type_id,\n        created_at as ticket_pipeline_created_at,\n        updated_at as ticket_pipeline_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.078894Z", "completed_at": "2024-08-30T11:45:12.086537Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.087048Z", "completed_at": "2024-08-30T11:45:12.087054Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00918889045715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_list_contact_list_id.ff8e4cc29a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.088573Z", "completed_at": "2024-08-30T11:45:12.096381Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.097190Z", "completed_at": "2024-08-30T11:45:12.097198Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009835004806518555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_list_contact_list_id.036739c1b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.099395Z", "completed_at": "2024-08-30T11:45:12.107234Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.107717Z", "completed_at": "2024-08-30T11:45:12.107723Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009351968765258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__company_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_property_history\"\n\n), windows as (\n\n    select\n        company_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by company_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(company_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__company_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.109309Z", "completed_at": "2024-08-30T11:45:12.112197Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.112640Z", "completed_at": "2024-08-30T11:45:12.112644Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004251003265380859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__company_company_id.0d0a080d43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.114035Z", "completed_at": "2024-08-30T11:45:12.117072Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.117525Z", "completed_at": "2024-08-30T11:45:12.117530Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004391908645629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__company_company_id.394a2a4ba0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\"\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.118992Z", "completed_at": "2024-08-30T11:45:12.121764Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.122193Z", "completed_at": "2024-08-30T11:45:12.122197Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004133939743041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_contact_id.9f112f8944", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.123599Z", "completed_at": "2024-08-30T11:45:12.127113Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.127559Z", "completed_at": "2024-08-30T11:45:12.127563Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004843711853027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_contact_id.b9135eb03a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\"\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.129047Z", "completed_at": "2024-08-30T11:45:12.132730Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.133188Z", "completed_at": "2024-08-30T11:45:12.133192Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005039215087890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_property_history\"\n\n), windows as (\n\n    select\n        contact_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by contact_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(contact_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:10.985830Z", "completed_at": "2024-08-30T11:45:12.037925Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.038407Z", "completed_at": "2024-08-30T11:45:12.038412Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1565921306610107, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_engagement_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.134719Z", "completed_at": "2024-08-30T11:45:12.141358Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.142635Z", "completed_at": "2024-08-30T11:45:12.142639Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009199857711791992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_company_company_id__deal_id__type_id.59d48f3923", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, deal_id, type_id\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_company\"\n    group by company_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.144243Z", "completed_at": "2024-08-30T11:45:12.152005Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.152915Z", "completed_at": "2024-08-30T11:45:12.152920Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010663032531738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__contact_merge_adjust", "compiled": true, "compiled_code": "\n\nwith contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\"\n), contact_merge_audit as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_merge_audit\"\n\n\n), contact_merge_removal as (\n    select \n        contacts.*\n    from contacts\n    \n    left join contact_merge_audit\n        on cast(contacts.contact_id as TEXT) = cast(contact_merge_audit.vid_to_merge as TEXT)\n    \n    where contact_merge_audit.vid_to_merge is null\n)\n\nselect *\nfrom contact_merge_removal", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.148820Z", "completed_at": "2024-08-30T11:45:12.152241Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.153148Z", "completed_at": "2024-08-30T11:45:12.153153Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005786895751953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_contact_contact_id__deal_id__type_id.37de71798b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, deal_id, type_id\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_contact\"\n    group by contact_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.156992Z", "completed_at": "2024-08-30T11:45:12.162278Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.163178Z", "completed_at": "2024-08-30T11:45:12.163183Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008918046951293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_deal_pipeline_id.8a0e3cd7a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.159570Z", "completed_at": "2024-08-30T11:45:12.162511Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.163409Z", "completed_at": "2024-08-30T11:45:12.163412Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0090179443359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_deal_pipeline_id.dff6c45403", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is not null\ngroup by deal_pipeline_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.169591Z", "completed_at": "2024-08-30T11:45:12.172654Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.173220Z", "completed_at": "2024-08-30T11:45:12.173226Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008547067642211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.d53656553e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_stage_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.166097Z", "completed_at": "2024-08-30T11:45:12.173469Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.174697Z", "completed_at": "2024-08-30T11:45:12.174700Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010383129119873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_property_history\"\n\n), windows as (\n\n    select\n        deal_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by deal_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(deal_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.176201Z", "completed_at": "2024-08-30T11:45:12.223816Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.224308Z", "completed_at": "2024-08-30T11:45:12.224314Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.049791812896728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.ba90fa6113", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is not null\ngroup by deal_pipeline_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.180267Z", "completed_at": "2024-08-30T11:45:12.229056Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.229919Z", "completed_at": "2024-08-30T11:45:12.229926Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.051007986068725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_campaign_email_campaign_id.79921899a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.225853Z", "completed_at": "2024-08-30T11:45:12.229539Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.231000Z", "completed_at": "2024-08-30T11:45:12.231003Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006494045257568359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_campaign_email_campaign_id.9820d33f2e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.233332Z", "completed_at": "2024-08-30T11:45:12.239265Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.240130Z", "completed_at": "2024-08-30T11:45:12.240139Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008831977844238281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_deal_id.ff48693e20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.236582Z", "completed_at": "2024-08-30T11:45:12.239870Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.241254Z", "completed_at": "2024-08-30T11:45:12.241257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00909423828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_deal_id.ac1628ac69", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\"\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.247945Z", "completed_at": "2024-08-30T11:45:12.250679Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.251133Z", "completed_at": "2024-08-30T11:45:12.251140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008152961730957031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_bounce_event_id.0341ffa8e9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.243802Z", "completed_at": "2024-08-30T11:45:12.255194Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.255763Z", "completed_at": "2024-08-30T11:45:12.255769Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013820886611938477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_bounce_event_id.71b13d26d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.252569Z", "completed_at": "2024-08-30T11:45:12.256509Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.257735Z", "completed_at": "2024-08-30T11:45:12.257742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0064809322357177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_click_event_id.8a1be931c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.258870Z", "completed_at": "2024-08-30T11:45:12.266262Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.266924Z", "completed_at": "2024-08-30T11:45:12.266933Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01037907600402832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_click_event_id.da8d8487a1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.262998Z", "completed_at": "2024-08-30T11:45:12.267183Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.268728Z", "completed_at": "2024-08-30T11:45:12.268733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007306098937988281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_deferred_event_id.80293078e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.270684Z", "completed_at": "2024-08-30T11:45:12.278163Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.278687Z", "completed_at": "2024-08-30T11:45:12.278693Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010107755661010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_deferred_event_id.2f779e2912", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.275168Z", "completed_at": "2024-08-30T11:45:12.279674Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.280695Z", "completed_at": "2024-08-30T11:45:12.280699Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009637832641601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_delivered_event_id.87c8eb3f20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.280966Z", "completed_at": "2024-08-30T11:45:12.287859Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.288382Z", "completed_at": "2024-08-30T11:45:12.288387Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008882999420166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_delivered_event_id.f818bf03fc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.285138Z", "completed_at": "2024-08-30T11:45:12.289101Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.290132Z", "completed_at": "2024-08-30T11:45:12.290136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006119966506958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_dropped_event_id.c92d449f52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.291012Z", "completed_at": "2024-08-30T11:45:12.297875Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.298522Z", "completed_at": "2024-08-30T11:45:12.298528Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009450912475585938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_dropped_event_id.40706bbf71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.294497Z", "completed_at": "2024-08-30T11:45:12.298771Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.300062Z", "completed_at": "2024-08-30T11:45:12.300066Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006887912750244141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_forward_event_id.b9a8bf63b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.301570Z", "completed_at": "2024-08-30T11:45:12.307947Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.308469Z", "completed_at": "2024-08-30T11:45:12.308474Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008588075637817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_forward_event_id.7f133d2dd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.305013Z", "completed_at": "2024-08-30T11:45:12.309268Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.310622Z", "completed_at": "2024-08-30T11:45:12.310626Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006891012191772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_sent_event_id.cf77d9f15d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.311553Z", "completed_at": "2024-08-30T11:45:12.318358Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.318854Z", "completed_at": "2024-08-30T11:45:12.318859Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00905299186706543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_sent_event_id.122cb22272", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.315398Z", "completed_at": "2024-08-30T11:45:12.319814Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.320810Z", "completed_at": "2024-08-30T11:45:12.320813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010264873504638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_open_event_id.a2e658fe16", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.321047Z", "completed_at": "2024-08-30T11:45:12.329018Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.329540Z", "completed_at": "2024-08-30T11:45:12.329545Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009977102279663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_open_event_id.3a369549b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.326283Z", "completed_at": "2024-08-30T11:45:12.330558Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.331587Z", "completed_at": "2024-08-30T11:45:12.331590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008892059326171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_print_event_id.94d4e09b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.331811Z", "completed_at": "2024-08-30T11:45:12.338317Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.338821Z", "completed_at": "2024-08-30T11:45:12.338826Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008395195007324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_print_event_id.40a8ccd3f3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.335764Z", "completed_at": "2024-08-30T11:45:12.339503Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.340724Z", "completed_at": "2024-08-30T11:45:12.340728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006120920181274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_status_change_event_id.c5e80297b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.341620Z", "completed_at": "2024-08-30T11:45:12.348558Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.349042Z", "completed_at": "2024-08-30T11:45:12.349048Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009418964385986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_status_change_event_id.13105203e0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.345006Z", "completed_at": "2024-08-30T11:45:12.349293Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.350725Z", "completed_at": "2024-08-30T11:45:12.350729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007054805755615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_spam_report_event_id.2a56aced8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.352242Z", "completed_at": "2024-08-30T11:45:12.358603Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.359067Z", "completed_at": "2024-08-30T11:45:12.359072Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00847482681274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_spam_report_event_id.448320447a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.361139Z", "completed_at": "2024-08-30T11:45:12.364583Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.368007Z", "completed_at": "2024-08-30T11:45:12.368012Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008600950241088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_event_id.4f287f3531", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.365364Z", "completed_at": "2024-08-30T11:45:12.369198Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.370434Z", "completed_at": "2024-08-30T11:45:12.370438Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011026859283447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_event_id.734683460d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.370682Z", "completed_at": "2024-08-30T11:45:12.379571Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.380624Z", "completed_at": "2024-08-30T11:45:12.380629Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011794805526733398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_call_engagement_id.5ceb3917bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.376625Z", "completed_at": "2024-08-30T11:45:12.379855Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.380882Z", "completed_at": "2024-08-30T11:45:12.380886Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0058062076568603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_call_engagement_id.43b4413603", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.383734Z", "completed_at": "2024-08-30T11:45:12.389371Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.390269Z", "completed_at": "2024-08-30T11:45:12.390274Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008316755294799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_email_engagement_id.175561ecca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.386601Z", "completed_at": "2024-08-30T11:45:12.389610Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.390505Z", "completed_at": "2024-08-30T11:45:12.390508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008407115936279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_email_engagement_id.5eeb06dcfc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.395852Z", "completed_at": "2024-08-30T11:45:12.399627Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.400324Z", "completed_at": "2024-08-30T11:45:12.400329Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008439779281616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_meeting_engagement_id.70721fb830", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.393225Z", "completed_at": "2024-08-30T11:45:12.400068Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.401218Z", "completed_at": "2024-08-30T11:45:12.401221Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009726762771606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_meeting_engagement_id.18dd11dc28", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.403231Z", "completed_at": "2024-08-30T11:45:12.408797Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.409251Z", "completed_at": "2024-08-30T11:45:12.409256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007713794708251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_note_engagement_id.244059891e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.406182Z", "completed_at": "2024-08-30T11:45:12.409463Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.410657Z", "completed_at": "2024-08-30T11:45:12.410660Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008442878723144531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_note_engagement_id.e2eaf5256e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.412055Z", "completed_at": "2024-08-30T11:45:12.422993Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.423445Z", "completed_at": "2024-08-30T11:45:12.423449Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012948036193847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagements", "compiled": true, "compiled_code": "\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement\"\n\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\"\n\n), contacts_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(contact_id)\n as contact_ids\n    from contacts\n    group by 1\n\n\n\n\n\n), deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal\"\n \n), deals_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(deal_id)\n as deal_ids\n    from deals\n    group by 1\n\n\n\n\n\n), companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company\"\n\n), companies_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(company_id)\n as company_ids\n    from companies\n    group by 1\n\n\n\n), joined as (\n\n    select \n         contacts_agg.contact_ids, \n         deals_agg.deal_ids, \n         companies_agg.company_ids, \n        engagements.*\n    from engagements\n     left join contacts_agg using (engagement_id) \n     left join deals_agg using (engagement_id) \n     left join companies_agg using (engagement_id) \n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.420304Z", "completed_at": "2024-08-30T11:45:12.424379Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.425450Z", "completed_at": "2024-08-30T11:45:12.425455Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00962209701538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_engagement_id.b26f4d328f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.425674Z", "completed_at": "2024-08-30T11:45:12.433000Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.433495Z", "completed_at": "2024-08-30T11:45:12.433500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00918889045715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_engagement_id.4f054187b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.430456Z", "completed_at": "2024-08-30T11:45:12.434397Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.435420Z", "completed_at": "2024-08-30T11:45:12.435423Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008449077606201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_task_engagement_id.0bbd752d82", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.435655Z", "completed_at": "2024-08-30T11:45:12.442061Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.442647Z", "completed_at": "2024-08-30T11:45:12.442652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008400917053222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_task_engagement_id.0f578bc80c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.439481Z", "completed_at": "2024-08-30T11:45:12.444249Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.448418Z", "completed_at": "2024-08-30T11:45:12.448423Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009886980056762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__merged_deal_deal_id.a843ca0610", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.444525Z", "completed_at": "2024-08-30T11:45:12.449368Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.450382Z", "completed_at": "2024-08-30T11:45:12.450385Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012931108474731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__merged_deal_merged_deal_id.c2d24039b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect merged_deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\"\nwhere merged_deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.457783Z", "completed_at": "2024-08-30T11:45:12.465393Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.466097Z", "completed_at": "2024-08-30T11:45:12.466101Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009467124938964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__property_option_property_id__property_option_label.2792c4669b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        property_id, property_option_label\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_option\"\n    group by property_id, property_option_label\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.462717Z", "completed_at": "2024-08-30T11:45:12.465873Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.466988Z", "completed_at": "2024-08-30T11:45:12.466992Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005537986755371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__property__fivetran_id.37b6ec5db1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property\"\nwhere _fivetran_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.469187Z", "completed_at": "2024-08-30T11:45:12.476482Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.476947Z", "completed_at": "2024-08-30T11:45:12.476953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00945901870727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__property__fivetran_id.1d41a2aa95", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    _fivetran_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property\"\nwhere _fivetran_id is not null\ngroup by _fivetran_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.472226Z", "completed_at": "2024-08-30T11:45:12.477870Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.478964Z", "completed_at": "2024-08-30T11:45:12.478968Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013248920440673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__company_history_company_id__field_name__valid_to.654ef778b1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__company_history\"\n    group by company_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.479202Z", "completed_at": "2024-08-30T11:45:12.485605Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.486028Z", "completed_at": "2024-08-30T11:45:12.486034Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008272171020507812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__company_history_id.33035793ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__company_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.483193Z", "completed_at": "2024-08-30T11:45:12.487432Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.490680Z", "completed_at": "2024-08-30T11:45:12.490684Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008400917053222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__company_history_id.f1af964b1f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__company_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.487690Z", "completed_at": "2024-08-30T11:45:12.494847Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.495318Z", "completed_at": "2024-08-30T11:45:12.495323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00878286361694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__contact_history_contact_id__field_name__valid_to.42ccfb8329", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_history\"\n    group by contact_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.492240Z", "completed_at": "2024-08-30T11:45:12.496269Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.497245Z", "completed_at": "2024-08-30T11:45:12.497248Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009626150131225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_history_id.eaae22e088", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.497480Z", "completed_at": "2024-08-30T11:45:12.506481Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.506979Z", "completed_at": "2024-08-30T11:45:12.506983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0109100341796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_history_id.aef69ae1ec", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.502362Z", "completed_at": "2024-08-30T11:45:12.511449Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.511898Z", "completed_at": "2024-08-30T11:45:12.511902Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010465145111083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.508463Z", "completed_at": "2024-08-30T11:45:12.512788Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.513952Z", "completed_at": "2024-08-30T11:45:12.513955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009445905685424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_clicks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_clicks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.514179Z", "completed_at": "2024-08-30T11:45:12.518646Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.522215Z", "completed_at": "2024-08-30T11:45:12.522220Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009547948837280273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.518894Z", "completed_at": "2024-08-30T11:45:12.523194Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.524242Z", "completed_at": "2024-08-30T11:45:12.524245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01051020622253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.524469Z", "completed_at": "2024-08-30T11:45:12.529784Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.533323Z", "completed_at": "2024-08-30T11:45:12.533327Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010303974151611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.530020Z", "completed_at": "2024-08-30T11:45:12.534318Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.535282Z", "completed_at": "2024-08-30T11:45:12.535285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009376049041748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.535518Z", "completed_at": "2024-08-30T11:45:12.539827Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.543545Z", "completed_at": "2024-08-30T11:45:12.543550Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009408950805664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_opens", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_opens\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.540089Z", "completed_at": "2024-08-30T11:45:12.544448Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.545485Z", "completed_at": "2024-08-30T11:45:12.545488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009588003158569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_print", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.545708Z", "completed_at": "2024-08-30T11:45:12.550083Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.554527Z", "completed_at": "2024-08-30T11:45:12.554532Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010189056396484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.550317Z", "completed_at": "2024-08-30T11:45:12.555218Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.556337Z", "completed_at": "2024-08-30T11:45:12.556341Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00738835334777832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.557215Z", "completed_at": "2024-08-30T11:45:12.563919Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.564377Z", "completed_at": "2024-08-30T11:45:12.564382Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009038925170898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.561278Z", "completed_at": "2024-08-30T11:45:12.564592Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.565811Z", "completed_at": "2024-08-30T11:45:12.565814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0058591365814208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__deal_history_deal_id__field_name__valid_to.f55c724804", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        deal_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_history\"\n    group by deal_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.567271Z", "completed_at": "2024-08-30T11:45:12.574085Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.575442Z", "completed_at": "2024-08-30T11:45:12.575448Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010040044784545898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_history_id.a1c6cd6a75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.570521Z", "completed_at": "2024-08-30T11:45:12.574570Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.575704Z", "completed_at": "2024-08-30T11:45:12.575707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0066149234771728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_history_id.1cb93fca79", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.581668Z", "completed_at": "2024-08-30T11:45:12.585284Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.585961Z", "completed_at": "2024-08-30T11:45:12.585966Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008912086486816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_event_aggregates_email_send_id.4deec238f9", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n) select\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__email_event_aggregates\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.578369Z", "completed_at": "2024-08-30T11:45:12.585709Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.586862Z", "completed_at": "2024-08-30T11:45:12.586865Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01026010513305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_event_aggregates_email_send_id.ac29e6997a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n) select email_send_id\nfrom __dbt__cte__int_hubspot__email_event_aggregates\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.589022Z", "completed_at": "2024-08-30T11:45:12.601764Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.602339Z", "completed_at": "2024-08-30T11:45:12.602345Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014857292175292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__companies", "compiled": true, "compiled_code": "\n\nwith companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\"\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company\"\n\n), engagement_companies_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_companies.company_id\n    from engagements\n    inner join engagement_companies\n        using (engagement_id)\n\n), engagement_companies_agg as (\n\n    \n\n    select\n        company_id,\n        count(case when engagement_type = 'NOTE' then company_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then company_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then company_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then company_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then company_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then company_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then company_id end) as count_engagement_forwarded_emails\n    from engagement_companies_joined\n    group by 1\n\n\n\n), joined as (\n\n    select \n        companies.*,\n        \n        coalesce(engagement_companies_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_companies_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_companies_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_companies_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_companies_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from companies\n    left join engagement_companies_agg\n        using (company_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__companies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:11.753406Z", "completed_at": "2024-08-30T11:45:12.692028Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.692508Z", "completed_at": "2024-08-30T11:45:12.692515Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0469379425048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    name\n    \n as field_name , \n    \n    \n    source\n    \n as change_source , \n    \n    \n    source_id\n    \n as change_source_id , \n    \n    \n    timestamp_instant\n    \n as change_timestamp , \n    \n    \n    value\n    \n as new_value \n\n\n         \n            \n        \n        \n        \n\n        \n        \n        , \"_fivetran_active\"\n\n \n        \n        from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:11.857897Z", "completed_at": "2024-08-30T11:45:12.790623Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:12.791077Z", "completed_at": "2024-08-30T11:45:12.791082Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0479161739349365, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as ticket_id , \n    cast(null as boolean) as _fivetran_ticket_deleted , \n    \n    \n    is_deleted\n    \n as is_ticket_deleted , \n    \n    \n    property_closed_date\n    \n as closed_date , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_first_agent_reply_date\n    \n as first_agent_reply_at , \n    \n    \n    property_hs_pipeline\n    \n as ticket_pipeline_id , \n    \n    \n    property_hs_pipeline_stage\n    \n as ticket_pipeline_stage_id , \n    \n    \n    property_hs_ticket_category\n    \n as ticket_category , \n    \n    \n    property_hs_ticket_priority\n    \n as ticket_priority , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_subject\n    \n as ticket_subject , \n    \n    \n    property_content\n    \n as ticket_content \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_ticket_columns.sql macro\n        ticket_id,\n        coalesce(_fivetran_ticket_deleted, is_ticket_deleted) as is_ticket_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        first_agent_reply_at,\n        ticket_pipeline_id,\n        ticket_pipeline_stage_id,\n        ticket_category,\n        ticket_priority,\n        owner_id,\n        ticket_subject,\n        ticket_content\n\n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__ticket_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.603918Z", "completed_at": "2024-08-30T11:45:13.617356Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.617805Z", "completed_at": "2024-08-30T11:45:13.617809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.120507001876831, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_emails", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"all_owner_ids\",\n  base.\"all_team_ids\",\n  base.\"email_subject\",\n  base.\"email_text\",\n  base.\"lastmodifieddate\",\n  base.\"modified_by\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_emails\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.594968Z", "completed_at": "2024-08-30T11:45:13.612370Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.612843Z", "completed_at": "2024-08-30T11:45:13.612849Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1391427516937256, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_calls", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_calls\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.742156Z", "completed_at": "2024-08-30T11:45:13.745346Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.745806Z", "completed_at": "2024-08-30T11:45:13.745811Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004633665084838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagements_engagement_id.59b32bc0d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.747235Z", "completed_at": "2024-08-30T11:45:13.749917Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.750361Z", "completed_at": "2024-08-30T11:45:13.750365Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004019021987915039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagements_engagement_id.01d5c3ee5d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.751753Z", "completed_at": "2024-08-30T11:45:13.804955Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.805444Z", "completed_at": "2024-08-30T11:45:13.805450Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05464434623718262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_stages", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\"\n\n\n), merged_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\"\n\n), aggregate_merged_deals as (\n\n    select\n        deal_id,\n        \n    array_agg(merged_deal_id)\n as merged_deal_ids\n    from merged_deals\n    group by 1\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n        aggregate_merged_deals.merged_deal_ids,\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n    left join aggregate_merged_deals\n        on deals.deal_id = aggregate_merged_deals.deal_id\n\n    left join merged_deals\n        on deals.deal_id = merged_deals.merged_deal_id\n    where merged_deals.merged_deal_id is null\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n), deal_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_stage\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\n\n), final as (\n\n    select\n        deal_stage.deal_id || '-' || row_number() over(partition by deal_stage.deal_id order by deal_stage.date_entered asc) as deal_stage_id,\n        deals_enhanced.deal_id,\n        deals_enhanced.deal_name,\n\n        \n        deals_enhanced.merged_deal_ids,\n        \n        \n        deal_stage._fivetran_start as date_stage_entered,\n        deal_stage._fivetran_end as date_stage_exited,\n        deal_stage._fivetran_active as is_stage_active,\n        deal_stage.deal_stage_name as pipeline_stage_id,\n        pipeline_stage.pipeline_stage_label,\n        pipeline_stage.deal_pipeline_id as pipeline_id,\n        pipeline.pipeline_label,\n        deal_stage.source,\n        deal_stage.source_id,\n        pipeline_stage.is_active as is_pipeline_stage_active,\n        pipeline.is_active as is_pipeline_active,\n        pipeline_stage.is_closed_won as is_pipeline_stage_closed_won,\n        pipeline_stage.display_order as pipeline_stage_display_order,\n        pipeline.display_order as pipeline_display_order,\n        pipeline_stage.probability as pipeline_stage_probability,\n        coalesce(pipeline.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        coalesce(pipeline_stage.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        coalesce(deals_enhanced.is_deal_deleted, false) as is_deal_deleted,\n        pipeline_stage.deal_pipeline_stage_created_at,\n        pipeline_stage.deal_pipeline_stage_updated_at\n\n    from deal_stage\n\n    left join pipeline_stage\n        on deal_stage.deal_stage_name = pipeline_stage.deal_pipeline_stage_id\n    \n    left join pipeline\n        on pipeline_stage.deal_pipeline_id = pipeline.deal_pipeline_id\n\n    left join deals_enhanced\n        on deal_stage.deal_id = deals_enhanced.deal_id\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_stages\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.807087Z", "completed_at": "2024-08-30T11:45:13.824134Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.824674Z", "completed_at": "2024-08-30T11:45:13.824683Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018585681915283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deals", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\"\n\n\n), merged_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\"\n\n), aggregate_merged_deals as (\n\n    select\n        deal_id,\n        \n    array_agg(merged_deal_id)\n as merged_deal_ids\n    from merged_deals\n    group by 1\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n        aggregate_merged_deals.merged_deal_ids,\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n    left join aggregate_merged_deals\n        on deals.deal_id = aggregate_merged_deals.deal_id\n\n    left join merged_deals\n        on deals.deal_id = merged_deals.merged_deal_id\n    where merged_deals.merged_deal_id is null\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal\"\n\n), engagement_deal_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_deals.deal_id\n    from engagements\n    inner join engagement_deals\n        on cast(engagements.engagement_id as bigint) = cast(engagement_deals.engagement_id as bigint )\n\n), engagement_deal_agg as (\n\n    \n\n    select\n        deal_id,\n        count(case when engagement_type = 'NOTE' then deal_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then deal_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then deal_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then deal_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then deal_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then deal_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then deal_id end) as count_engagement_forwarded_emails\n    from engagement_deal_joined\n    group by 1\n\n\n\n), engagements_joined as (\n\n    select \n        deals_enhanced.*,\n        \n        coalesce(engagement_deal_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_deal_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_deal_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_deal_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_deal_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from deals_enhanced\n    left join engagement_deal_agg\n        on cast(deals_enhanced.deal_id as bigint) = cast(engagement_deal_agg.deal_id as bigint )\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.826376Z", "completed_at": "2024-08-30T11:45:13.829552Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.829989Z", "completed_at": "2024-08-30T11:45:13.829993Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004631996154785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_bounce_event_id.39d8daa6f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.831405Z", "completed_at": "2024-08-30T11:45:13.834354Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.834809Z", "completed_at": "2024-08-30T11:45:13.834814Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0043032169342041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_bounce_event_id.7a1c6704e1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_bounce\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.800814Z", "completed_at": "2024-08-30T11:45:13.736782Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.740139Z", "completed_at": "2024-08-30T11:45:13.740145Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0399541854858398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_meetings", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"created_from_link_id\",\n  base.\"end_time\",\n  base.\"pre_meeting_prospect_reminders\",\n  base.\"source\",\n  base.\"source_id\",\n  base.\"start_time\",\n  base.\"web_conference_meeting_id\",\n  base.\"meeting_outcome\",\n  base.\"body\",\n  base.\"external_url\",\n  base.\"title\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_meetings\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.836198Z", "completed_at": "2024-08-30T11:45:13.840767Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.841865Z", "completed_at": "2024-08-30T11:45:13.841868Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009137868881225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_clicks_event_id.f603501ca0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_clicks\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.842112Z", "completed_at": "2024-08-30T11:45:13.845981Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.849497Z", "completed_at": "2024-08-30T11:45:13.849503Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008913040161132812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_clicks_event_id.60d3912846", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_clicks\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.846209Z", "completed_at": "2024-08-30T11:45:13.851115Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.854436Z", "completed_at": "2024-08-30T11:45:13.854440Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009410858154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_deferred_event_id.2c6decaa91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.851389Z", "completed_at": "2024-08-30T11:45:13.855392Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.856473Z", "completed_at": "2024-08-30T11:45:13.856478Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009141921997070312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_deferred_event_id.bb75dcb83a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_deferred\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.856742Z", "completed_at": "2024-08-30T11:45:13.864362Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.864872Z", "completed_at": "2024-08-30T11:45:13.864877Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009640216827392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_delivered_event_id.0609870be3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.860891Z", "completed_at": "2024-08-30T11:45:13.865541Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.866569Z", "completed_at": "2024-08-30T11:45:13.866572Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006785869598388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_delivered_event_id.242e838cce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_delivered\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.867412Z", "completed_at": "2024-08-30T11:45:13.873409Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.874038Z", "completed_at": "2024-08-30T11:45:13.874045Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008572816848754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_dropped_event_id.5cfe4eeb95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.870763Z", "completed_at": "2024-08-30T11:45:13.874329Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.875633Z", "completed_at": "2024-08-30T11:45:13.875636Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00615692138671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_dropped_event_id.093040860b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_dropped\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.877116Z", "completed_at": "2024-08-30T11:45:13.883190Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.883721Z", "completed_at": "2024-08-30T11:45:13.883727Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008472204208374023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_forward_event_id.417a73da08", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.880386Z", "completed_at": "2024-08-30T11:45:13.883942Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.885108Z", "completed_at": "2024-08-30T11:45:13.885112Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006111621856689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_forward_event_id.064956aaa7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_forward\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.886618Z", "completed_at": "2024-08-30T11:45:13.893272Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.893754Z", "completed_at": "2024-08-30T11:45:13.893759Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009070158004760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_opens_event_id.a9fe279ee1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_opens\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.890672Z", "completed_at": "2024-08-30T11:45:13.893966Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.895209Z", "completed_at": "2024-08-30T11:45:13.895212Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005834817886352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_opens_event_id.d7963f4eb0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_opens\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.896623Z", "completed_at": "2024-08-30T11:45:13.902487Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.902948Z", "completed_at": "2024-08-30T11:45:13.902953Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00813603401184082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_print_event_id.9dac8a147e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.899831Z", "completed_at": "2024-08-30T11:45:13.903159Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.904416Z", "completed_at": "2024-08-30T11:45:13.904419Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0059049129486083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_print_event_id.548f6cece7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_print\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.905858Z", "completed_at": "2024-08-30T11:45:13.912297Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.912763Z", "completed_at": "2024-08-30T11:45:13.912767Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008575201034545898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_sent_event_id.5507dcc5b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.908937Z", "completed_at": "2024-08-30T11:45:13.913721Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.914752Z", "completed_at": "2024-08-30T11:45:13.914757Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009315967559814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_sent_event_id.68076270f8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_sent\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.915003Z", "completed_at": "2024-08-30T11:45:13.921401Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.921859Z", "completed_at": "2024-08-30T11:45:13.921866Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008253097534179688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_spam_report_event_id.5ddca8771a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.918819Z", "completed_at": "2024-08-30T11:45:13.923114Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.926013Z", "completed_at": "2024-08-30T11:45:13.926017Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008177995681762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_spam_report_event_id.20aab81ec6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_spam_report\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.928182Z", "completed_at": "2024-08-30T11:45:13.935205Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.935724Z", "completed_at": "2024-08-30T11:45:13.935729Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009109020233154297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_status_change_event_id.a1737e44b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.931573Z", "completed_at": "2024-08-30T11:45:13.936632Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.937668Z", "completed_at": "2024-08-30T11:45:13.937671Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009563922882080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_status_change_event_id.2e5b2b72e2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.937909Z", "completed_at": "2024-08-30T11:45:13.941751Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.944866Z", "completed_at": "2024-08-30T11:45:13.944871Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008395195007324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__companies_company_id.687ec98e97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__companies\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.941977Z", "completed_at": "2024-08-30T11:45:13.945838Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.946775Z", "completed_at": "2024-08-30T11:45:13.946778Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01726818084716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__companies_company_id.a58ceac3f2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__companies\" where not coalesce(is_company_deleted, false)) dbt_subquery\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.947001Z", "completed_at": "2024-08-30T11:45:13.968875Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.969353Z", "completed_at": "2024-08-30T11:45:13.969358Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02370285987854004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__daily_ticket_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_property_history\"\n\n    -- should we include an option pivot out ALL properties? in the same vein as our passthrough-all-columns var\n    where lower(field_name) in \n        ('hs_pipeline', 'hs_pipeline_stage'\n    )\n\n    \n    and change_timestamp >= (select cast(max(date_day) as timestamp) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__daily_ticket_history\" )\n    \n\n), windows as (\n\n    select\n        cast(date_trunc('day', change_timestamp) as date) as date_day,\n        ticket_id,\n        field_name,\n        new_value,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        _fivetran_end as valid_to\n        -- if it is currently active fivetran_end = 9999-12-31 23:59:59, but the calendar_spine will end at the current_date\n    from history\n\n), order_daily_changes as (\n\n    select \n        *,\n        row_number() over (\n            partition by date_day, ticket_id, field_name\n            order by valid_from desc\n            ) as row_num\n    from windows\n\n), extract_latest as (\n    \n    select \n        date_day,\n        ticket_id,\n        field_name,\n        case when new_value is null then 'is_null' else new_value end as new_value,\n        change_source,\n        change_source_id,\n        valid_from,\n        valid_to\n\n    from order_daily_changes\n    where row_num = 1\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from extract_latest\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.971099Z", "completed_at": "2024-08-30T11:45:13.974704Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.975152Z", "completed_at": "2024-08-30T11:45:13.975155Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005255222320556641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__ticket_ticket_id.299e7c4c53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.976561Z", "completed_at": "2024-08-30T11:45:13.979310Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.979732Z", "completed_at": "2024-08-30T11:45:13.979736Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004048824310302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__ticket_ticket_id.78c6fbfcaf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.981107Z", "completed_at": "2024-08-30T11:45:13.995115Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.995560Z", "completed_at": "2024-08-30T11:45:13.995565Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01534414291381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__tickets", "compiled": true, "compiled_code": "\n\nwith ticket as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\"\n\n), ticket_pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline\"\n\n), ticket_pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage\"\n\n\n\n\n), ticket_company as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_company\"\n\n), company as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\"\n\n), join_companies as (\n    \n    select\n        ticket_company.ticket_id,\n        ticket_company.company_id,\n        company.company_name\n\n    from ticket_company\n    left join company \n        on ticket_company.company_id = company.company_id\n\n), agg_companies as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when company_id is null then '' else cast(company_id as TEXT) end)\n as company_ids,\n        \n    array_agg(case when company_name is null then '' else company_name end)\n as company_names\n\n    from join_companies\n    group by 1\n\n\n\n\n), ticket_contact as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_contact\"\n\n), contact as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\"\n\n), join_contacts as (\n    \n    select\n        ticket_contact.ticket_id,\n        ticket_contact.contact_id,\n        contact.email\n\n    from ticket_contact\n    left join contact \n        on ticket_contact.contact_id = contact.contact_id\n\n), agg_contacts as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when contact_id is null then '' else cast(contact_id as TEXT) end)\n as contact_ids,\n        \n    array_agg(case when email is null then '' else email end)\n as contact_emails\n\n    from join_contacts\n    group by 1\n\n\n\n\n), owner as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner\"\n\n\n\n\n), engagement as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), ticket_engagement as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_engagement\"\n\n), join_engagements as (\n\n    select \n        engagement.engagement_type,\n        ticket_engagement.ticket_id\n    from engagement\n    inner join ticket_engagement\n        on cast(engagement.engagement_id as bigint) = cast(ticket_engagement.engagement_id as bigint )\n\n), agg_engagements as (\n\n    \n\n    select\n        ticket_id,\n        count(case when engagement_type = 'NOTE' then ticket_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then ticket_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then ticket_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then ticket_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then ticket_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then ticket_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then ticket_id end) as count_engagement_forwarded_emails\n    from join_engagements\n    group by 1\n\n\n\n\n\n), final_join as (\n\n    select\n        ticket.*,\n        ticket_pipeline_stage.ticket_state,\n        ticket_pipeline_stage.is_closed,\n        ticket_pipeline_stage.pipeline_stage_label,\n        ticket_pipeline.pipeline_label,\n        ticket_pipeline_stage.display_order as pipeline_stage_order,\n        ticket_pipeline.is_ticket_pipeline_deleted,\n        ticket_pipeline_stage.is_ticket_pipeline_stage_deleted\n\n    \n        , owner.email_address as owner_email\n        , owner.full_name as owner_full_name\n    \n\n    \n\n    \n        , agg_contacts.contact_ids\n        , agg_contacts.contact_emails\n    \n\n    \n        , agg_companies.company_ids\n        , agg_companies.company_names\n    \n\n    \n        \n        , coalesce(agg_engagements.count_engagement_notes,0) as count_engagement_notes\n        \n        , coalesce(agg_engagements.count_engagement_tasks,0) as count_engagement_tasks\n        \n        , coalesce(agg_engagements.count_engagement_calls,0) as count_engagement_calls\n        \n        , coalesce(agg_engagements.count_engagement_meetings,0) as count_engagement_meetings\n        \n        , coalesce(agg_engagements.count_engagement_emails,0) as count_engagement_emails\n        \n        , coalesce(agg_engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails\n        \n        , coalesce(agg_engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails\n        \n    \n\n    from ticket\n\n    left join ticket_pipeline \n        on ticket.ticket_pipeline_id = ticket_pipeline.ticket_pipeline_id \n    \n    left join ticket_pipeline_stage \n        on ticket.ticket_pipeline_stage_id = ticket_pipeline_stage.ticket_pipeline_stage_id\n        and ticket_pipeline.ticket_pipeline_id = ticket_pipeline_stage.ticket_pipeline_id\n\n    \n    left join owner \n        on ticket.owner_id = owner.owner_id\n    \n\n    \n\n    \n    left join agg_contacts\n        on ticket.ticket_id = agg_contacts.ticket_id \n    \n\n    \n    left join agg_companies\n        on ticket.ticket_id = agg_companies.ticket_id \n    \n\n    \n    left join agg_engagements\n        on ticket.ticket_id = agg_engagements.ticket_id\n    \n)\n\nselect *\nfrom final_join", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.997098Z", "completed_at": "2024-08-30T11:45:14.001000Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.001441Z", "completed_at": "2024-08-30T11:45:14.001446Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005257368087768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_emails_engagement_id.13a39d1e09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_emails\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.002833Z", "completed_at": "2024-08-30T11:45:14.005426Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.005853Z", "completed_at": "2024-08-30T11:45:14.005858Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003907918930053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_emails_engagement_id.b18e2acbde", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_emails\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.007240Z", "completed_at": "2024-08-30T11:45:14.009898Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.010327Z", "completed_at": "2024-08-30T11:45:14.010331Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0039539337158203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_calls_engagement_id.00f8d8357f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_calls\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.011698Z", "completed_at": "2024-08-30T11:45:14.014211Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.014646Z", "completed_at": "2024-08-30T11:45:14.014649Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003815889358520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_calls_engagement_id.972572ce6c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_calls\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.016087Z", "completed_at": "2024-08-30T11:45:14.019374Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.019819Z", "completed_at": "2024-08-30T11:45:14.019824Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004638195037841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__engagement_metrics__by_contact_contact_id.4a800df06b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n) select contact_id\nfrom __dbt__cte__int_hubspot__engagement_metrics__by_contact\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.021231Z", "completed_at": "2024-08-30T11:45:14.026507Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.026978Z", "completed_at": "2024-08-30T11:45:14.026984Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00665593147277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__engagement_metrics__by_contact_contact_id.1c156b64ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n) select\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__engagement_metrics__by_contact\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.028598Z", "completed_at": "2024-08-30T11:45:14.031740Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.032206Z", "completed_at": "2024-08-30T11:45:14.032211Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004676103591918945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_stages_deal_stage_id.162d2d204b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_stage_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_stages\"\nwhere deal_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.033693Z", "completed_at": "2024-08-30T11:45:14.036569Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.037006Z", "completed_at": "2024-08-30T11:45:14.037010Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004209995269775391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_stages_deal_stage_id.7fd3732373", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_stage_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_stages\" where not coalesce(is_deal_pipeline_stage_deleted, false)) dbt_subquery\nwhere deal_stage_id is not null\ngroup by deal_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.038421Z", "completed_at": "2024-08-30T11:45:14.041170Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.041607Z", "completed_at": "2024-08-30T11:45:14.041612Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0040760040283203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deals_deal_id.bdbfe47fcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deals\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.043136Z", "completed_at": "2024-08-30T11:45:14.045770Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.046206Z", "completed_at": "2024-08-30T11:45:14.046210Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004068136215209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deals_deal_id.d728fe5f71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deals\" where not coalesce(is_deal_deleted, false)) dbt_subquery\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.047627Z", "completed_at": "2024-08-30T11:45:14.051212Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.051648Z", "completed_at": "2024-08-30T11:45:14.051653Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004914045333862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_meetings_engagement_id.83a791c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_meetings\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.053206Z", "completed_at": "2024-08-30T11:45:14.055971Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.056416Z", "completed_at": "2024-08-30T11:45:14.056420Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004210948944091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_meetings_engagement_id.3098aabcd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_meetings\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.057948Z", "completed_at": "2024-08-30T11:45:14.068602Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.069048Z", "completed_at": "2024-08-30T11:45:14.069054Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012080192565917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_sends", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n),  __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n), sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_sent\"\n\n), metrics as (\n\n    select *\n    from __dbt__cte__int_hubspot__email_event_aggregates\n\n), joined as (\n\n    select\n        sends.*,\n        coalesce(metrics.bounces,0) as bounces,\n        coalesce(metrics.clicks,0) as clicks,\n        coalesce(metrics.deferrals,0) as deferrals,\n        coalesce(metrics.deliveries,0) as deliveries,\n        coalesce(metrics.drops,0) as drops,\n        coalesce(metrics.forwards,0) as forwards,\n        coalesce(metrics.opens,0) as opens,\n        coalesce(metrics.prints,0) as prints,\n        coalesce(metrics.spam_reports,0) as spam_reports\n    from sends\n    left join metrics using (email_send_id)\n\n), booleans as (\n\n    select \n        *,\n        bounces > 0 as was_bounced,\n        clicks > 0 as was_clicked,\n        deferrals > 0 as was_deferred,\n        deliveries > 0 as was_delivered,\n        forwards > 0 as was_forwarded,\n        opens > 0 as was_opened,\n        prints > 0 as was_printed,\n        spam_reports > 0 as was_spam_reported\n    from joined\n\n\n\n), unsubscribes as (\n\n    select *\n    from __dbt__cte__int_hubspot__email_aggregate_status_change\n\n), unsubscribes_joined as (\n\n    select \n        booleans.*,\n        coalesce(unsubscribes.unsubscribes,0) as unsubscribes,\n        coalesce(unsubscribes.unsubscribes,0) > 0 as was_unsubcribed\n    from booleans\n    left join unsubscribes using (email_send_id)\n\n)\n\nselect *\nfrom unsubscribes_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.070667Z", "completed_at": "2024-08-30T11:45:14.074742Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.075193Z", "completed_at": "2024-08-30T11:45:14.075197Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005430936813354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_aggregate_status_change_email_send_id.16bf74a3bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n) select email_send_id\nfrom __dbt__cte__int_hubspot__email_aggregate_status_change\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.076628Z", "completed_at": "2024-08-30T11:45:14.081346Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.081797Z", "completed_at": "2024-08-30T11:45:14.081802Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006081104278564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_aggregate_status_change_email_send_id.7c03e87c05", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n) select\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__email_aggregate_status_change\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:12.905802Z", "completed_at": "2024-08-30T11:45:13.970874Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:13.974123Z", "completed_at": "2024-08-30T11:45:13.974128Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1783320903778076, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_notes", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"note\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"body_preview\",\n  base.\"lastmodifieddate\",\n  base.\"note_body\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_notes\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.084277Z", "completed_at": "2024-08-30T11:45:14.094510Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.095017Z", "completed_at": "2024-08-30T11:45:14.095024Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012786149978637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__pivot_daily_ticket_history", "compiled": true, "compiled_code": "\n\n\n\nwith daily_history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__daily_ticket_history\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__pivot_daily_ticket_history\" )\n    \n\n), pivot_out as (\n\n    select \n        date_day, \n        ticket_id\n\n        -- should we remove the `hs_` prefix? could introduce some duplicates if people already have something like `hs_owner` and `owner`\n        , max(case when lower(field_name) = 'hs_pipeline' then new_value end) as hs_pipeline\n        , max(case when lower(field_name) = 'hs_pipeline_stage' then new_value end) as hs_pipeline_stage\n        from daily_history\n\n    group by 1,2\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from pivot_out\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__pivot_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.091550Z", "completed_at": "2024-08-30T11:45:14.097031Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.100628Z", "completed_at": "2024-08-30T11:45:14.100634Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010203123092651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__tickets_ticket_id.259c6846d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.097395Z", "completed_at": "2024-08-30T11:45:14.101657Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.102675Z", "completed_at": "2024-08-30T11:45:14.102678Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015807151794433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__tickets_ticket_id.4b54466361", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.729696Z", "completed_at": "2024-08-30T11:45:14.703328Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.703853Z", "completed_at": "2024-08-30T11:45:14.703867Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0890579223632812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_tasks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n  base.\"task_type\",\n  base.\"object_id\",\n  base.\"engagement_source\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_tasks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.818474Z", "completed_at": "2024-08-30T11:45:14.823320Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:14.823770Z", "completed_at": "2024-08-30T11:45:14.823775Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007348775863647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__marketing_events_standardized", "compiled": true, "compiled_code": "with events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\" \n),\n\nstandardized as (\n\n    select \n        event_id,\n        coalesce(email_send_timestamp, created_timestamp) as activity_timestamp,\n        email_campaign_id as campaign_id,\n        recipient_email_address as email,\n        contact_id,\n        'email send' as event_type,\n        cast(null as numeric(28,6)) as event_value,    \n        cast(null as timestamp) as updated_at,\n        email_subject,\n        bounces as total_bounces,\n        clicks as total_clicks,\n        deferrals as total_deferrals,\n        deliveries as total_deliveries,\n        drops as total_drops,\n        forwards as total_forwards,\n        opens as total_opens,\n        spam_reports as total_spam_reports,\n        cast(null as integer) as total_unsubscribes,\n        was_bounced,\n        was_clicked,\n        was_deferred,\n        was_delivered,\n        was_forwarded,\n        was_opened,\n        cast(null as boolean) was_unsubscribed\n    from events\n)\n\nselect *\nfrom standardized", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_events_standardized\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.102905Z", "completed_at": "2024-08-30T11:45:15.116127Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.116718Z", "completed_at": "2024-08-30T11:45:15.116726Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.124885082244873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contacts", "compiled": true, "compiled_code": "\n\n\n\nwith  __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        recipient_email_address,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), email_joined as (\n\n    select \n        contacts.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contacts\n    left join email_metrics\n        on contacts.email = email_metrics.recipient_email_address\n\n\n\n\n\n\n\n), engagements as (\n\n    select *\n    from __dbt__cte__int_hubspot__engagement_metrics__by_contact\n\n), engagements_joined as (\n\n    select \n        email_joined.*,\n        \n        coalesce(engagements.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagements.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagements.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagements.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagements.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from email_joined\n    left join engagements\n        using (contact_id)\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contacts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.227930Z", "completed_at": "2024-08-30T11:45:15.233271Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.233887Z", "completed_at": "2024-08-30T11:45:15.233897Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0069391727447509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_sends_event_id.9fc8a8bef3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.235376Z", "completed_at": "2024-08-30T11:45:15.238423Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.238891Z", "completed_at": "2024-08-30T11:45:15.238895Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004436969757080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_sends_event_id.b01306228f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:13.960959Z", "completed_at": "2024-08-30T11:45:15.140450Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.140925Z", "completed_at": "2024-08-30T11:45:15.140931Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.283348798751831, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__ticket_calendar_spine", "compiled": true, "compiled_code": "\n\nwith calendar as (\n\n    \n    \n    \n    \n    \n\n    select * \n    from (\n        \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1604\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2020-04-16' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= \n\n    \n    (current_timestamp at time zone 'utc')::timestamp\n + ((interval '1 week') * (1))\n\n\n\n)\n\nselect * from filtered\n\n \n    ) as date_spine\n\n    \n    where date_day >= (select min(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__ticket_calendar_spine\" )\n    \n\n), ticket as (\n\n    select \n        *,\n        cast( date_trunc('day', case when closed_date is null then \n    current_timestamp::timestamp\n else closed_date end) as date) as open_until\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\"\n    where not coalesce(is_ticket_deleted, false)\n\n), joined as (\n\n    select \n        cast(calendar.date_day as date) as date_day,\n        ticket.ticket_id\n    from calendar \n    inner join ticket\n        on cast(calendar.date_day as date) >= cast(ticket.created_date as date)\n        -- use this variable to extend the ticket's history past its close date (for reporting/data viz purposes :-)\n        and cast(calendar.date_day as date) <= \n\n    ticket.open_until + ((interval '1 day') * (0))\n\n\n\n), surrogate as (\n\n    select\n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from joined\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__ticket_calendar_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.240290Z", "completed_at": "2024-08-30T11:45:15.244822Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.247955Z", "completed_at": "2024-08-30T11:45:15.247961Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00860595703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_notes_engagement_id.76434ac965", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_notes\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.245088Z", "completed_at": "2024-08-30T11:45:15.248924Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.249910Z", "completed_at": "2024-08-30T11:45:15.249913Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011856317520141602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_notes_engagement_id.c9864b5001", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_notes\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.113885Z", "completed_at": "2024-08-30T11:45:15.149992Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.150417Z", "completed_at": "2024-08-30T11:45:15.150420Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.148667812347412, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_campaigns", "compiled": true, "compiled_code": "\n\n\nwith campaigns as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign\"\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        email_campaign_id,\n        \n        sum(email_sends.bounces) as total_bounces,\n        count(distinct case when email_sends.bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(email_sends.clicks) as total_clicks,\n        count(distinct case when email_sends.clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(email_sends.deferrals) as total_deferrals,\n        count(distinct case when email_sends.deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(email_sends.deliveries) as total_deliveries,\n        count(distinct case when email_sends.deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(email_sends.drops) as total_drops,\n        count(distinct case when email_sends.drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(email_sends.forwards) as total_forwards,\n        count(distinct case when email_sends.forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(email_sends.opens) as total_opens,\n        count(distinct case when email_sends.opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(email_sends.prints) as total_prints,\n        count(distinct case when email_sends.prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(email_sends.spam_reports) as total_spam_reports,\n        count(distinct case when email_sends.spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(email_sends.unsubscribes) as total_unsubscribes,\n        count(distinct case when email_sends.unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), joined as (\n\n    select \n        campaigns.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from campaigns\n    left join email_metrics\n        on campaigns.email_campaign_id = email_metrics.email_campaign_id\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_campaigns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.257956Z", "completed_at": "2024-08-30T11:45:15.265873Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.266402Z", "completed_at": "2024-08-30T11:45:15.266407Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009648799896240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_tasks_engagement_id.67738794ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_tasks\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.263203Z", "completed_at": "2024-08-30T11:45:15.267321Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.268500Z", "completed_at": "2024-08-30T11:45:15.268504Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009290933609008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_tasks_engagement_id.754d36b939", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_tasks\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.268761Z", "completed_at": "2024-08-30T11:45:15.275756Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.276250Z", "completed_at": "2024-08-30T11:45:15.276255Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009047985076904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__marketing_events_standardized_event_id.04bbf23276", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_events_standardized\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.273218Z", "completed_at": "2024-08-30T11:45:15.277136Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.278162Z", "completed_at": "2024-08-30T11:45:15.278165Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013082742691040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__marketing_events_standardized_event_id.2e1e3ff399", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_events_standardized\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.278392Z", "completed_at": "2024-08-30T11:45:15.289898Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.290450Z", "completed_at": "2024-08-30T11:45:15.290455Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013453006744384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__marketing_contacts_standardized", "compiled": true, "compiled_code": "\n\n\n\n\nwith contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contacts\" \n),\n\nstandardized as (\n\n    select \n        contact_id,\n        first_name,\n        last_name,\n        email,\n        contact_company,\n        cast(created_date as timestamp) as created_at,\n        cast(null as TEXT) as contact_phone,\n        cast(null as timestamp) as updated_at,\n        cast(null as TEXT) as contact_address,\n        cast(null as TEXT) as contact_city,\n        cast(null as TEXT) as contact_state,\n        cast(null as TEXT) as contact_country,\n        cast(null as TEXT) as contact_timezone,\n        cast(null as TEXT) as contact_language,\n        cast(null as timestamp) as first_event_at,\n        cast(null as timestamp) as last_event_at,\n        cast(null as TEXT) as contact_status,\n        total_bounces,\n        total_clicks,\n        total_deferrals,\n        total_deliveries,\n        total_drops,\n        total_forwards,\n        total_opens,\n        cast(null as integer) as total_unsubscribes,\n        count_engagement_emails as total_sends, -- check this\n        cast(null as integer) as total_replies,   \n        cast(null as integer) as total_responses,    \n        total_unique_opens,\n        total_unique_clicks\n    from contacts\n)\n\nselect * \nfrom standardized", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_contacts_standardized\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.287253Z", "completed_at": "2024-08-30T11:45:15.291398Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.292468Z", "completed_at": "2024-08-30T11:45:15.292472Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00892782211303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contacts_contact_id.e28e88dce3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contacts\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.292691Z", "completed_at": "2024-08-30T11:45:15.299815Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.300295Z", "completed_at": "2024-08-30T11:45:15.300299Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00897526741027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contacts_contact_id.8f627121df", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contacts\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.296754Z", "completed_at": "2024-08-30T11:45:15.301200Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.302223Z", "completed_at": "2024-08-30T11:45:15.302226Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009788990020751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__marketing_campaigns_standardized", "compiled": true, "compiled_code": "\n\nwith campaigns as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_campaigns\" \n),\n\nstandardized as (\n\n    select \n        email_campaign_id as campaign_id,\n        email_campaign_name as campaign_name,\n        email_campaign_type as campaign_type,\n        email_campaign_sub_type as campaign_sub_type,\n        email_campaign_subject as campaign_subject,\n        coalesce(app_id, content_id) as secondary_id,\n        cast(null as timestamp) as created_at,\n        cast(null as timestamp) as updated_at,\n        total_bounces,\n        total_clicks,\n        total_deferrals,\n        total_deliveries,\n        total_opens,\n        cast(null as integer) as total_unsubscribes,\n        total_unique_clicks,\n        total_unique_opens\n    from campaigns\n)\n\nselect *\nfrom standardized", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_campaigns_standardized\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.302457Z", "completed_at": "2024-08-30T11:45:15.309739Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.310261Z", "completed_at": "2024-08-30T11:45:15.310266Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009215116500854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_campaigns_email_campaign_id.6b2d6f43c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.307285Z", "completed_at": "2024-08-30T11:45:15.311207Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.312328Z", "completed_at": "2024-08-30T11:45:15.312332Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00895380973815918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_campaigns_email_campaign_id.2470fabe62", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.312612Z", "completed_at": "2024-08-30T11:45:15.316879Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.319829Z", "completed_at": "2024-08-30T11:45:15.319833Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008771896362304688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__marketing_contacts_standardized_contact_id.7be44fda82", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_contacts_standardized\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.317118Z", "completed_at": "2024-08-30T11:45:15.321301Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.324760Z", "completed_at": "2024-08-30T11:45:15.324765Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00900888442993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__marketing_contacts_standardized_contact_id.9d7857b44a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_contacts_standardized\"\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.322085Z", "completed_at": "2024-08-30T11:45:15.330461Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.330982Z", "completed_at": "2024-08-30T11:45:15.330987Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010526895523071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__marketing_campaigns_standardized_campaign_id.7b59048a9f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_campaigns_standardized\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.326589Z", "completed_at": "2024-08-30T11:45:15.331888Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.332422Z", "completed_at": "2024-08-30T11:45:15.332425Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0068280696868896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__marketing_campaigns_standardized_campaign_id.c71cac8d22", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_campaigns_standardized\"\nwhere campaign_id is not null\ngroup by campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:14.825485Z", "completed_at": "2024-08-30T11:45:15.883003Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:15.883518Z", "completed_at": "2024-08-30T11:45:15.883524Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1759910583496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__email_metrics__by_contact_list", "compiled": true, "compiled_code": "\n\nwith email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\"\n\n), contact_list_member as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_member\"\n\n), joined as (\n\n    select\n        email_sends.*,\n        contact_list_member.contact_list_id\n    from email_sends\n    left join contact_list_member\n        using (contact_id)\n    where contact_list_member.contact_list_id is not null\n\n), email_metrics as (\n    \n    select \n        contact_list_id,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from joined\n    group by 1\n\n)\n\nselect *\nfrom email_metrics", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__email_metrics__by_contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:16.013305Z", "completed_at": "2024-08-30T11:45:16.016410Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:16.016912Z", "completed_at": "2024-08-30T11:45:16.016917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013813018798828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_metrics__by_contact_list_contact_list_id.095d72d5b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:16.010488Z", "completed_at": "2024-08-30T11:45:16.017667Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:16.018080Z", "completed_at": "2024-08-30T11:45:16.018083Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015500068664550781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_metrics__by_contact_list_contact_list_id.1d3cf4caf2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:15.250133Z", "completed_at": "2024-08-30T11:45:16.165625Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:16.166272Z", "completed_at": "2024-08-30T11:45:16.166281Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.024963140487671, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__scd_daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__pivot_daily_ticket_history\"\n\n), set_values as (\n\n    select \n        date_day, \n        ticket_id,\n        id\n\n         \n        , hs_pipeline as hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_field_partition\n\n         \n        , hs_pipeline_stage as hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline_stage is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_stage_field_partition\n\n        \n    \n    from change_data\n\n), fill_values as (\n\n-- each row of the pivoted table includes ticket property values if that property was updated on that day\n-- we need to backfill to persist values that have been previously updated and are still valid \n    select \n        date_day, \n        ticket_id,\n        id\n        \n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n\n        \n\n    from set_values\n\n)\n\nselect *\nfrom fill_values", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__scd_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:16.004044Z", "completed_at": "2024-08-30T11:45:16.954890Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:16.955370Z", "completed_at": "2024-08-30T11:45:16.955378Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0572597980499268, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_lists", "compiled": true, "compiled_code": "\n\nwith contact_lists as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list\"\n\n\n\n), email_metrics as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__email_metrics__by_contact_list\"\n\n), joined as (\n    \n    select \n        contact_lists.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contact_lists\n    left join email_metrics\n        using (contact_list_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_lists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:17.062117Z", "completed_at": "2024-08-30T11:45:17.068159Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:17.068725Z", "completed_at": "2024-08-30T11:45:17.068744Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008992910385131836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_lists_contact_list_id.3bde1bb891", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_lists\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:17.065442Z", "completed_at": "2024-08-30T11:45:17.069463Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:17.070519Z", "completed_at": "2024-08-30T11:45:17.070523Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009565353393554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_lists_contact_list_id.ea9ef03bac", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_lists\" where not coalesce(is_contact_list_deleted, false)) dbt_subquery\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:16.275382Z", "completed_at": "2024-08-30T11:45:17.291854Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:17.292329Z", "completed_at": "2024-08-30T11:45:17.292334Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1282429695129395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__scd_daily_ticket_history\"\n\n\n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\")\n\n-- If no issue fields have been updated since the last incremental run, the pivoted_daily_history CTE will return no record/rows.\n-- When this is the case, we need to grab the most recent day's records from the previously built table so that we can persist \n-- those values into the future.\n\n), most_recent_data as ( \n\n    select \n        *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\"\n    where date_day = (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\" )\n\n\n), calendar as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__ticket_calendar_spine\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\")\n    \n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage\"\n\n), joined as (\n\n    select \n        calendar.date_day,\n        calendar.ticket_id\n            \n             \n            , coalesce(change_data.hs_pipeline, most_recent_data.hs_pipeline) as hs_pipeline\n             \n            , coalesce(change_data.hs_pipeline_stage, most_recent_data.hs_pipeline_stage) as hs_pipeline_stage\n            \n        \n        \n\n    from calendar\n    left join change_data\n        on calendar.ticket_id = change_data.ticket_id\n        and calendar.date_day = change_data.date_day\n    \n    \n    left join most_recent_data\n        on calendar.ticket_id = most_recent_data.ticket_id\n        and calendar.date_day = most_recent_data.date_day\n    \n\n), set_values as (\n\n    select \n        date_day,\n        ticket_id\n        \n        \n        , hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_partition\n        \n        , hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline_stage is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_stage_partition\n        \n\n    from joined\n\n), fill_values as (\n\n    select \n        date_day,\n        ticket_id\n\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n        \n\n    from set_values\n\n), fix_null_values as (\n\n    select \n        date_day,\n        ticket_id,\n        pipeline_stage.ticket_state,\n        pipeline.pipeline_label as hs_pipeline_label,\n        pipeline_stage.pipeline_stage_label as hs_pipeline_stage_label\n\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline as TEXT ) = 'is_null' then null else hs_pipeline end as hs_pipeline\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline_stage as TEXT ) = 'is_null' then null else hs_pipeline_stage end as hs_pipeline_stage\n        \n\n    from fill_values\n\n    left join pipeline \n        on cast(fill_values.hs_pipeline as integer) = pipeline.ticket_pipeline_id\n    left join pipeline_stage \n        on cast(fill_values.hs_pipeline_stage as integer) = pipeline_stage.ticket_pipeline_stage_id\n        and pipeline.ticket_pipeline_id = pipeline_stage.ticket_pipeline_id\n\n), surrogate as (\n\n    select\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as ticket_day_id,\n        *\n\n    from fix_null_values\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:17.408792Z", "completed_at": "2024-08-30T11:45:17.412361Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:17.412822Z", "completed_at": "2024-08-30T11:45:17.412827Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00809621810913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__daily_ticket_history_ticket_day_id.294440dc9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is not null\ngroup by ticket_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:45:17.405860Z", "completed_at": "2024-08-30T11:45:17.413526Z"}, {"name": "execute", "started_at": "2024-08-30T11:45:17.414002Z", "completed_at": "2024-08-30T11:45:17.414005Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009716987609863281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__daily_ticket_history_ticket_day_id.087496580e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_day_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is null\n\n\n", "relation_name": null}], "elapsed_time": 35.00316596031189, "args": {"log_format_file": "debug", "populate_cache": true, "vars": {}, "partial_parse": true, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests", "target": "postgres", "require_explicit_package_overrides_for_builtin_materializations": false, "use_colors": true, "favor_state": false, "log_format": "default", "quiet": false, "indirect_selection": "eager", "cache_selected_only": false, "invocation_command": "dbt docs generate -t postgres", "log_level": "info", "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests/logs", "introspect": true, "empty_catalog": false, "log_level_file": "debug", "static_parser": true, "warn_error_options": {"include": [], "exclude": []}, "version_check": true, "show_resource_report": false, "profiles_dir": "/Users/avinash.kunnath/.dbt", "partial_parse_file_diff": true, "which": "generate", "select": [], "static": false, "strict_mode": false, "macro_debugging": false, "write_json": true, "printer_width": 80, "send_anonymous_usage_stats": true, "defer": false, "log_file_max_bytes": 10485760, "compile": true, "use_colors_file": true, "enable_legacy_logger": false, "exclude": [], "print": true}}