{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-08-30T11:10:00.536794Z", "invocation_id": "21e363f6-94d9-4eb2-b12e-b2e91d742d79", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:29.190000Z", "completed_at": "2024-08-30T11:09:30.190773Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:30.191899Z", "completed_at": "2024-08-30T11:09:30.191908Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1629481315612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"contact_list_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"added_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_list_member_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_member_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:29.155256Z", "completed_at": "2024-08-30T11:09:30.191599Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:30.193070Z", "completed_at": "2024-08-30T11:09:30.193074Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1737070083618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"is_deleted\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:29.194568Z", "completed_at": "2024-08-30T11:09:30.191367Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:30.192816Z", "completed_at": "2024-08-30T11:09:30.192819Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1834619045257568, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"deleteable\",\n  \"dynamic\",\n  \"metadata_error\",\n  \"metadata_last_processing_state_change_at\",\n  \"metadata_last_size_change_at\",\n  \"metadata_processing\",\n  \"metadata_size\",\n  \"offset\",\n  \"portal_id\",\n  \"updated_at\",\n  \"name\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_list_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:29.134125Z", "completed_at": "2024-08-30T11:09:30.324234Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:30.325323Z", "completed_at": "2024-08-30T11:09:30.325334Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3062107563018799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"name\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"company_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:30.297044Z", "completed_at": "2024-08-30T11:09:31.277781Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:31.278881Z", "completed_at": "2024-08-30T11:09:31.278889Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0854520797729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_merge_audit_tmp", "compiled": true, "compiled_code": "\n\nselect \"canonical_vid\",\n  \"contact_id\",\n  \"vid_to_merge\",\n  \"_fivetran_synced\",\n  \"entity_id\",\n  \"first_name\",\n  \"last_name\",\n  \"num_properties_moved\",\n  \"timestamp\",\n  \"user_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_merge_audit_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_merge_audit_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:30.310265Z", "completed_at": "2024-08-30T11:09:31.278175Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:31.279131Z", "completed_at": "2024-08-30T11:09:31.279134Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0730829238891602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"value\",\n  \"source_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:30.317918Z", "completed_at": "2024-08-30T11:09:31.398035Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:31.398508Z", "completed_at": "2024-08-30T11:09:31.398514Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1853477954864502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_email\",\n  \"id\",\n  \"property_company\",\n  \"property_firstname\",\n  \"property_lastname\",\n  \"property_email_1\",\n  \"property_createdate\",\n  \"property_jobtitle\",\n  \"property_annualrevenue\",\n  \"property_hs_calculated_merged_vids\",\n  \"property_created_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:30.439897Z", "completed_at": "2024-08-30T11:09:31.511406Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:31.512623Z", "completed_at": "2024-08-30T11:09:31.512634Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1831488609313965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"deal_id\",\n  \"type_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:31.390724Z", "completed_at": "2024-08-30T11:09:32.307800Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:32.308299Z", "completed_at": "2024-08-30T11:09:32.308306Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0299949645996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"closed_won\",\n  \"display_order\",\n  \"probability\",\n  \"stage_id\",\n  \"label\",\n  \"pipeline_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_pipeline_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:31.385010Z", "completed_at": "2024-08-30T11:09:32.400842Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:32.402029Z", "completed_at": "2024-08-30T11:09:32.402045Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.123931884765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"deal_id\",\n  \"_fivetran_synced\",\n  \"type_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:31.504034Z", "completed_at": "2024-08-30T11:09:32.519403Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:32.519877Z", "completed_at": "2024-08-30T11:09:32.519883Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1269328594207764, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_pipeline_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:31.624064Z", "completed_at": "2024-08-30T11:09:32.566212Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:32.566678Z", "completed_at": "2024-08-30T11:09:32.566684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0568909645080566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:32.415412Z", "completed_at": "2024-08-30T11:09:33.438403Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:33.438972Z", "completed_at": "2024-08-30T11:09:33.438997Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1220519542694092, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"deal_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"date_entered\",\n  \"source\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:32.632138Z", "completed_at": "2024-08-30T11:09:33.546998Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:33.547813Z", "completed_at": "2024-08-30T11:09:33.547821Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0120692253112793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"content_id\",\n  \"num_included\",\n  \"num_queued\",\n  \"sub_type\",\n  \"type\",\n  \"app_name\",\n  \"name\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_campaign_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:32.509908Z", "completed_at": "2024-08-30T11:09:33.571929Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:33.572431Z", "completed_at": "2024-08-30T11:09:33.572437Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1732029914855957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"owner_id\",\n  \"deal_pipeline_id\",\n  \"deal_pipeline_stage_id\",\n  \"is_deleted\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:32.686230Z", "completed_at": "2024-08-30T11:09:33.658469Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:33.658945Z", "completed_at": "2024-08-30T11:09:33.658952Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0742692947387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"category\",\n  \"status\",\n  \"response\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_bounce_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:33.541246Z", "completed_at": "2024-08-30T11:09:34.533295Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:34.533935Z", "completed_at": "2024-08-30T11:09:34.533947Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.099031925201416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"referer\",\n  \"browser\",\n  \"location\",\n  \"ip_address\",\n  \"url\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_click_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:33.646914Z", "completed_at": "2024-08-30T11:09:34.651198Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:34.651683Z", "completed_at": "2024-08-30T11:09:34.651689Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1219289302825928, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"attempt\",\n  \"response\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_deferred_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:33.760640Z", "completed_at": "2024-08-30T11:09:34.695409Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:34.695882Z", "completed_at": "2024-08-30T11:09:34.695889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0346980094909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"drop_reason\",\n  \"bcc\",\n  \"cc\",\n  \"drop_message\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_dropped_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:33.683614Z", "completed_at": "2024-08-30T11:09:34.702888Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:34.703355Z", "completed_at": "2024-08-30T11:09:34.703359Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1254141330718994, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"response\",\n  \"smtp_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_delivered_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:34.639991Z", "completed_at": "2024-08-30T11:09:35.583495Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:35.584671Z", "completed_at": "2024-08-30T11:09:35.584689Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.049644947052002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_forward_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:34.795938Z", "completed_at": "2024-08-30T11:09:35.814101Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:35.814587Z", "completed_at": "2024-08-30T11:09:35.814594Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1317181587219238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_print_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:34.769851Z", "completed_at": "2024-08-30T11:09:35.819737Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:35.821134Z", "completed_at": "2024-08-30T11:09:35.821147Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.159985065460205, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"duration\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_open_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:34.809610Z", "completed_at": "2024-08-30T11:09:35.825256Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:35.825749Z", "completed_at": "2024-08-30T11:09:35.825754Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1197690963745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bcc\",\n  \"cc\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_sent_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:35.691024Z", "completed_at": "2024-08-30T11:09:36.731952Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:36.732673Z", "completed_at": "2024-08-30T11:09:36.732681Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1583678722381592, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"ip_address\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_spam_report_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:35.941900Z", "completed_at": "2024-08-30T11:09:36.969830Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:36.971344Z", "completed_at": "2024-08-30T11:09:36.971351Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1352150440216064, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_timestamp\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_call_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:35.937459Z", "completed_at": "2024-08-30T11:09:36.970453Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:36.971589Z", "completed_at": "2024-08-30T11:09:36.971592Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1367909908294678, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"caused_by_created\",\n  \"caused_by_id\",\n  \"created\",\n  \"email_campaign_id\",\n  \"obsoleted_by_created\",\n  \"obsoleted_by_id\",\n  \"portal_id\",\n  \"sent_by_created\",\n  \"sent_by_id\",\n  \"type\",\n  \"filtered_event\",\n  \"recipient\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:35.931571Z", "completed_at": "2024-08-30T11:09:36.979213Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:36.979677Z", "completed_at": "2024-08-30T11:09:36.979682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1590032577514648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bounced\",\n  \"portal_subscription_status\",\n  \"requested_by\",\n  \"source\",\n  \"subscriptions\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_status_change_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:36.849841Z", "completed_at": "2024-08-30T11:09:37.856784Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:37.857346Z", "completed_at": "2024-08-30T11:09:37.857358Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1182708740234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:37.076439Z", "completed_at": "2024-08-30T11:09:38.031308Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:38.031873Z", "completed_at": "2024-08-30T11:09:38.031887Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0706911087036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:37.070759Z", "completed_at": "2024-08-30T11:09:38.052283Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:38.052796Z", "completed_at": "2024-08-30T11:09:38.052803Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0847289562225342, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:37.091064Z", "completed_at": "2024-08-30T11:09:38.056942Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:38.057391Z", "completed_at": "2024-08-30T11:09:38.057394Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.071187973022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_all_owner_ids\",\n  \"property_hs_all_team_ids\",\n  \"property_hs_createdate\",\n  \"property_hs_email_subject\",\n  \"property_hs_email_text\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_modified_by\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_email_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:37.970137Z", "completed_at": "2024-08-30T11:09:39.017929Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:39.018509Z", "completed_at": "2024-08-30T11:09:39.018521Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1563470363616943, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_synced\",\n  \"created_from_link_id\",\n  \"end_time\",\n  \"pre_meeting_prospect_reminders\",\n  \"source\",\n  \"source_id\",\n  \"start_time\",\n  \"web_conference_meeting_id\",\n  \"meeting_outcome\",\n  \"body\",\n  \"external_url\",\n  \"title\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_meeting_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:38.142422Z", "completed_at": "2024-08-30T11:09:39.052605Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:39.053223Z", "completed_at": "2024-08-30T11:09:39.053230Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0140149593353271, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_body_preview\",\n  \"property_hs_createdate\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_note_body\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_note_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:38.162732Z", "completed_at": "2024-08-30T11:09:39.184832Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:39.185611Z", "completed_at": "2024-08-30T11:09:39.185619Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1235840320587158, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"type\",\n  \"_fivetran_synced\",\n  \"portal_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:38.155652Z", "completed_at": "2024-08-30T11:09:39.227990Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:39.228559Z", "completed_at": "2024-08-30T11:09:39.228566Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.172529935836792, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_object_id\",\n  \"property_hs_task_type\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\",\n  \"task_type\",\n  \"property_hs_engagement_source\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_task_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:39.130431Z", "completed_at": "2024-08-30T11:09:40.199565Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:40.200088Z", "completed_at": "2024-08-30T11:09:40.200096Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1741859912872314, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__merged_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"merged_deal_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"merged_deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:39.157406Z", "completed_at": "2024-08-30T11:09:40.202979Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:40.203421Z", "completed_at": "2024-08-30T11:09:40.203424Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1468229293823242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner_tmp", "compiled": true, "compiled_code": "\n\nselect \"owner_id\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"portal_id\",\n  \"type\",\n  \"updated_at\",\n  \"email\",\n  \"first_name\",\n  \"last_name\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"owner_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:39.287433Z", "completed_at": "2024-08-30T11:09:40.230005Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:40.230617Z", "completed_at": "2024-08-30T11:09:40.230623Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0485000610351562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option_tmp", "compiled": true, "compiled_code": "\n\nselect \"label\",\n  \"property_id\",\n  \"_fivetran_synced\",\n  \"display_order\",\n  \"hidden\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"property_option_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_option_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:39.329108Z", "completed_at": "2024-08-30T11:09:40.270888Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:40.271398Z", "completed_at": "2024-08-30T11:09:40.271406Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.046226978302002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_id\",\n  \"_fivetran_synced\",\n  \"calculated\",\n  \"created_at\",\n  \"description\",\n  \"field_type\",\n  \"group_name\",\n  \"hubspot_defined\",\n  \"hubspot_object\",\n  \"label\",\n  \"name\",\n  \"show_currency_symbol\",\n  \"type\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"property_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:40.311162Z", "completed_at": "2024-08-30T11:09:41.239376Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.239845Z", "completed_at": "2024-08-30T11:09:41.239852Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0320408344268799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"contact_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:40.306693Z", "completed_at": "2024-08-30T11:09:41.248145Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.248613Z", "completed_at": "2024-08-30T11:09:41.248618Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0406088829040527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"company_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:40.336234Z", "completed_at": "2024-08-30T11:09:41.359045Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.359498Z", "completed_at": "2024-08-30T11:09:41.359503Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1476402282714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"engagement_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_engagement_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:40.375658Z", "completed_at": "2024-08-30T11:09:41.401763Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.402221Z", "completed_at": "2024-08-30T11:09:41.402227Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1471490859985352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"stage_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"is_closed\",\n  \"label\",\n  \"pipeline_id\",\n  \"ticket_state\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_pipeline_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.523397Z", "completed_at": "2024-08-30T11:09:41.524622Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.525202Z", "completed_at": "2024-08-30T11:09:41.525208Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0033197402954101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.528048Z", "completed_at": "2024-08-30T11:09:41.529143Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.529647Z", "completed_at": "2024-08-30T11:09:41.529652Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0027108192443847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.531054Z", "completed_at": "2024-08-30T11:09:41.532022Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.532438Z", "completed_at": "2024-08-30T11:09:41.532441Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022459030151367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.533777Z", "completed_at": "2024-08-30T11:09:41.534750Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.535543Z", "completed_at": "2024-08-30T11:09:41.535546Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0026521682739257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.537654Z", "completed_at": "2024-08-30T11:09:41.538610Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.539112Z", "completed_at": "2024-08-30T11:09:41.539117Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0030891895294189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_member_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.540585Z", "completed_at": "2024-08-30T11:09:41.541538Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.541990Z", "completed_at": "2024-08-30T11:09:41.541993Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002319812774658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_merge_audit_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.543516Z", "completed_at": "2024-08-30T11:09:41.544539Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.544999Z", "completed_at": "2024-08-30T11:09:41.545004Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002493143081665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.547062Z", "completed_at": "2024-08-30T11:09:41.548105Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.548778Z", "completed_at": "2024-08-30T11:09:41.548784Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002960205078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.550788Z", "completed_at": "2024-08-30T11:09:41.552202Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.552796Z", "completed_at": "2024-08-30T11:09:41.552801Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0032777786254882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.554586Z", "completed_at": "2024-08-30T11:09:41.556423Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.556894Z", "completed_at": "2024-08-30T11:09:41.556898Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003239870071411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.558461Z", "completed_at": "2024-08-30T11:09:41.559452Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.559917Z", "completed_at": "2024-08-30T11:09:41.559921Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0024750232696533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.561316Z", "completed_at": "2024-08-30T11:09:41.562258Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.562706Z", "completed_at": "2024-08-30T11:09:41.562710Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002270221710205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.564048Z", "completed_at": "2024-08-30T11:09:41.564956Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.565372Z", "completed_at": "2024-08-30T11:09:41.565375Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0021791458129882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.566796Z", "completed_at": "2024-08-30T11:09:41.568083Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.568636Z", "completed_at": "2024-08-30T11:09:41.568640Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0028829574584960938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.570247Z", "completed_at": "2024-08-30T11:09:41.572063Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.572561Z", "completed_at": "2024-08-30T11:09:41.572565Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003328084945678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_campaign_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.574111Z", "completed_at": "2024-08-30T11:09:41.618853Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.619481Z", "completed_at": "2024-08-30T11:09:41.619489Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04636502265930176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_bounce_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.621187Z", "completed_at": "2024-08-30T11:09:41.622179Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.622619Z", "completed_at": "2024-08-30T11:09:41.622622Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002563953399658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_click_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.623974Z", "completed_at": "2024-08-30T11:09:41.624917Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.625332Z", "completed_at": "2024-08-30T11:09:41.625336Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022079944610595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.626651Z", "completed_at": "2024-08-30T11:09:41.627611Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.628024Z", "completed_at": "2024-08-30T11:09:41.628027Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022118091583251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_deferred_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.629330Z", "completed_at": "2024-08-30T11:09:41.630257Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.630668Z", "completed_at": "2024-08-30T11:09:41.630671Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0021970272064208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_delivered_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.632171Z", "completed_at": "2024-08-30T11:09:41.633982Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.634416Z", "completed_at": "2024-08-30T11:09:41.634421Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0032787322998046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_dropped_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.635785Z", "completed_at": "2024-08-30T11:09:41.636696Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.637101Z", "completed_at": "2024-08-30T11:09:41.637104Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002157926559448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_forward_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.638379Z", "completed_at": "2024-08-30T11:09:41.639299Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.639701Z", "completed_at": "2024-08-30T11:09:41.639704Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0021419525146484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_open_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.640971Z", "completed_at": "2024-08-30T11:09:41.641855Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.642542Z", "completed_at": "2024-08-30T11:09:41.642547Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002482175827026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_print_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.644060Z", "completed_at": "2024-08-30T11:09:41.645190Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.645747Z", "completed_at": "2024-08-30T11:09:41.645752Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0026891231536865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_sent_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.647272Z", "completed_at": "2024-08-30T11:09:41.649264Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.649891Z", "completed_at": "2024-08-30T11:09:41.649895Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0035457611083984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_spam_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.651324Z", "completed_at": "2024-08-30T11:09:41.652357Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.652785Z", "completed_at": "2024-08-30T11:09:41.652789Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0023429393768310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_status_change_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.654148Z", "completed_at": "2024-08-30T11:09:41.655093Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.655498Z", "completed_at": "2024-08-30T11:09:41.655501Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002208232879638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_call_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.656809Z", "completed_at": "2024-08-30T11:09:41.657743Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.658151Z", "completed_at": "2024-08-30T11:09:41.658154Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002262115478515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.659734Z", "completed_at": "2024-08-30T11:09:41.660735Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.661131Z", "completed_at": "2024-08-30T11:09:41.661135Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0023529529571533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.662476Z", "completed_at": "2024-08-30T11:09:41.664121Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.664533Z", "completed_at": "2024-08-30T11:09:41.664537Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0028836727142333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.665802Z", "completed_at": "2024-08-30T11:09:41.666696Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.667096Z", "completed_at": "2024-08-30T11:09:41.667099Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002103090286254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.668347Z", "completed_at": "2024-08-30T11:09:41.669302Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.669890Z", "completed_at": "2024-08-30T11:09:41.669895Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002412080764770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.671329Z", "completed_at": "2024-08-30T11:09:41.672447Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.672889Z", "completed_at": "2024-08-30T11:09:41.672897Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0026350021362304688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_meeting_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.674630Z", "completed_at": "2024-08-30T11:09:41.675693Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.676172Z", "completed_at": "2024-08-30T11:09:41.676176Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0025069713592529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_note_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.677551Z", "completed_at": "2024-08-30T11:09:41.678536Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.678953Z", "completed_at": "2024-08-30T11:09:41.678956Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002262115478515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_task_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.680276Z", "completed_at": "2024-08-30T11:09:41.682233Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.682879Z", "completed_at": "2024-08-30T11:09:41.682888Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0035581588745117188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.merged_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.684367Z", "completed_at": "2024-08-30T11:09:41.685439Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.685864Z", "completed_at": "2024-08-30T11:09:41.685868Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002368927001953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.owner_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.687217Z", "completed_at": "2024-08-30T11:09:41.688208Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.688696Z", "completed_at": "2024-08-30T11:09:41.688700Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002354145050048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.690028Z", "completed_at": "2024-08-30T11:09:41.690994Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.691409Z", "completed_at": "2024-08-30T11:09:41.691412Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002235889434814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_option_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.692775Z", "completed_at": "2024-08-30T11:09:41.693698Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.694114Z", "completed_at": "2024-08-30T11:09:41.694117Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002218961715698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.695440Z", "completed_at": "2024-08-30T11:09:41.697161Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.697735Z", "completed_at": "2024-08-30T11:09:41.697738Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003164052963256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.699096Z", "completed_at": "2024-08-30T11:09:41.700076Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.700491Z", "completed_at": "2024-08-30T11:09:41.700495Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022487640380859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.701816Z", "completed_at": "2024-08-30T11:09:41.702786Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.703196Z", "completed_at": "2024-08-30T11:09:41.703200Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.002228260040283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.704492Z", "completed_at": "2024-08-30T11:09:41.705433Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.705831Z", "completed_at": "2024-08-30T11:09:41.705834Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0021851062774658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.707154Z", "completed_at": "2024-08-30T11:09:41.708125Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.708544Z", "completed_at": "2024-08-30T11:09:41.708547Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0022339820861816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.709861Z", "completed_at": "2024-08-30T11:09:41.711496Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.711914Z", "completed_at": "2024-08-30T11:09:41.711918Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0030031204223632812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.713474Z", "completed_at": "2024-08-30T11:09:41.714422Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:41.714852Z", "completed_at": "2024-08-30T11:09:41.714855Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0023050308227539062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.347207Z", "completed_at": "2024-08-30T11:09:42.279887Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:42.281055Z", "completed_at": "2024-08-30T11:09:42.281075Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0288970470428467, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"name\",\n  \"ticket_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"timestamp_instant\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.339635Z", "completed_at": "2024-08-30T11:09:42.357475Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:42.358002Z", "completed_at": "2024-08-30T11:09:42.358014Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1355552673339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"object_type_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_pipeline_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.486746Z", "completed_at": "2024-08-30T11:09:42.559714Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:42.560818Z", "completed_at": "2024-08-30T11:09:42.560836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.181584119796753, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"id\",\n  \"is_deleted\",\n  \"property_closed_date\",\n  \"property_createdate\",\n  \"property_first_agent_reply_date\",\n  \"property_hs_pipeline\",\n  \"property_hs_pipeline_stage\",\n  \"property_hs_ticket_category\",\n  \"property_hs_ticket_priority\",\n  \"property_hubspot_owner_id\",\n  \"property_subject\",\n  \"property_content\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:41.716346Z", "completed_at": "2024-08-30T11:09:42.797148Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:42.797644Z", "completed_at": "2024-08-30T11:09:42.797651Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1955971717834473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_member_tmp\" \n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    added_at\n    \n as \n    \n    added_at\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    contact_list_id\n    \n as \n    \n    contact_list_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_member_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(added_at as timestamp) as added_timestamp,\n        contact_id,\n        contact_list_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_member\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:42.377717Z", "completed_at": "2024-08-30T11:09:43.392509Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:43.393022Z", "completed_at": "2024-08-30T11:09:43.393030Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.119955062866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    id\n    \n as company_id , \n    \n    \n    is_deleted\n    \n as is_company_deleted , \n    cast(null as TEXT) as company_name , \n    cast(null as TEXT) as description , \n    cast(null as timestamp) as created_date , \n    cast(null as TEXT) as industry , \n    cast(null as TEXT) as street_address , \n    cast(null as TEXT) as street_address_2 , \n    cast(null as TEXT) as city , \n    cast(null as TEXT) as state , \n    cast(null as TEXT) as country , \n    cast(null as integer) as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_company_columns.sql macro\n        company_id,\n        is_company_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_name,\n        description,\n        created_date,\n        industry,\n        street_address,\n        street_address_2,\n        city,\n        state,\n        country,\n        company_annual_revenue\n        \n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__company_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:42.478393Z", "completed_at": "2024-08-30T11:09:43.538169Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:43.538640Z", "completed_at": "2024-08-30T11:09:43.538646Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2081959247589111, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    deleteable\n    \n as \n    \n    deleteable\n    \n, \n    \n    \n    dynamic\n    \n as \n    \n    dynamic\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metadata_error\n    \n as \n    \n    metadata_error\n    \n, \n    \n    \n    metadata_last_processing_state_change_at\n    \n as \n    \n    metadata_last_processing_state_change_at\n    \n, \n    \n    \n    metadata_last_size_change_at\n    \n as \n    \n    metadata_last_size_change_at\n    \n, \n    \n    \n    metadata_processing\n    \n as \n    \n    metadata_processing\n    \n, \n    \n    \n    metadata_size\n    \n as \n    \n    metadata_size\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        deleteable as is_deletable,\n        dynamic as is_dynamic,\n        id as contact_list_id,\n        metadata_error,\n        cast(metadata_last_processing_state_change_at as timestamp) as metadata_last_processing_state_change_at,\n        cast(metadata_last_size_change_at as timestamp) as metadata_last_size_change_at,\n        metadata_processing,\n        metadata_size,\n        name as contact_list_name,\n        portal_id,\n        cast(updated_at as timestamp) as updated_timestamp\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:42.669040Z", "completed_at": "2024-08-30T11:09:43.725407Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:43.738071Z", "completed_at": "2024-08-30T11:09:43.738082Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1800148487091064, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_company_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:42.914781Z", "completed_at": "2024-08-30T11:09:43.887544Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:43.888264Z", "completed_at": "2024-08-30T11:09:43.888273Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1273128986358643, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_merge_audit", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_merge_audit_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    canonical_vid\n    \n as \n    \n    canonical_vid\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    entity_id\n    \n as \n    \n    entity_id\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    num_properties_moved\n    \n as \n    \n    num_properties_moved\n    \n, \n    \n    \n    timestamp\n    \n as \n    \n    timestamp\n    \n, \n    \n    \n    user_id\n    \n as \n    \n    user_id\n    \n, \n    \n    \n    vid_to_merge\n    \n as \n    \n    vid_to_merge\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        canonical_vid,\n        contact_id,\n        entity_id,\n        first_name,\n        last_name,\n        num_properties_moved,\n        cast( \n        timestamp\n        as timestamp) as timestamp_at,\n        user_id,\n        vid_to_merge,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_merge_audit\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:43.500257Z", "completed_at": "2024-08-30T11:09:44.517517Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:44.518101Z", "completed_at": "2024-08-30T11:09:44.518112Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1251850128173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        contact_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_contact_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:43.851068Z", "completed_at": "2024-08-30T11:09:44.920017Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:44.920547Z", "completed_at": "2024-08-30T11:09:44.920553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1694390773773193, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_company_tmp\"\n\n), macro as (\n\n    select \n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        company_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:43.704129Z", "completed_at": "2024-08-30T11:09:44.921009Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:44.921461Z", "completed_at": "2024-08-30T11:09:44.921464Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3276362419128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as is_contact_deleted , \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as contact_id , \n    \n    \n    property_hs_calculated_merged_vids\n    \n as calculated_merged_vids , \n    \n    \n    property_email\n    \n as email , \n    \n    \n    property_company\n    \n as contact_company , \n    \n    \n    property_firstname\n    \n as first_name , \n    \n    \n    property_lastname\n    \n as last_name , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_jobtitle\n    \n as job_title , \n    \n    \n    property_annualrevenue\n    \n as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns.\n        -- a few columns below are aliased within the macros/get_contact_columns.sql macro\n        contact_id,\n        is_contact_deleted,\n        calculated_merged_vids, -- will be null for BigQuery users until v3 api is rolled out to them\n        email,\n        contact_company,\n        first_name,\n        last_name,\n        cast(created_date as timestamp) as created_date,\n        job_title,\n        company_annual_revenue,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n\n        --The below macro adds the fields defined within your hubspot__contact_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__contact_calculated_fields variable.\n        \n\n\n\n    from macro\n    \n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:44.043695Z", "completed_at": "2024-08-30T11:09:45.085479Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:45.085953Z", "completed_at": "2024-08-30T11:09:45.085959Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1416089534759521, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    closed_won\n    \n as \n    \n    closed_won\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    probability\n    \n as \n    \n    probability\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        closed_won as is_closed_won,\n        display_order,\n        label as pipeline_stage_label,\n        pipeline_id as deal_pipeline_id,\n        probability,\n        cast(stage_id as TEXT) as deal_pipeline_stage_id,\n        created_at as deal_pipeline_stage_created_at,\n        updated_at as deal_pipeline_stage_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:44.627320Z", "completed_at": "2024-08-30T11:09:45.592805Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:45.593407Z", "completed_at": "2024-08-30T11:09:45.593414Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0694153308868408, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_contact_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        contact_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:45.030508Z", "completed_at": "2024-08-30T11:09:45.980576Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:45.981582Z", "completed_at": "2024-08-30T11:09:45.981597Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0701711177825928, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_deal_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:45.020875Z", "completed_at": "2024-08-30T11:09:46.055078Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:46.056374Z", "completed_at": "2024-08-30T11:09:46.056386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1470999717712402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        cast(pipeline_id as TEXT) as deal_pipeline_id,\n        created_at as deal_pipeline_created_at,\n        updated_at as deal_pipeline_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:45.185396Z", "completed_at": "2024-08-30T11:09:46.134673Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:46.135195Z", "completed_at": "2024-08-30T11:09:46.135203Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0500400066375732, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_active\n    \n as \n    \n    _fivetran_active\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    date_entered\n    \n as \n    \n    date_entered\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date_entered as timestamp) as date_entered,\n        deal_id,\n        source,\n        source_id,\n        value as deal_stage_name,\n        _fivetran_active,\n        cast(_fivetran_end as timestamp) as _fivetran_end,\n        cast(_fivetran_start as timestamp) as _fivetran_start\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:45.697640Z", "completed_at": "2024-08-30T11:09:46.702452Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:46.703236Z", "completed_at": "2024-08-30T11:09:46.703244Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1111180782318115, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    content_id\n    \n as \n    \n    content_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    num_included\n    \n as \n    \n    num_included\n    \n, \n    \n    \n    num_queued\n    \n as \n    \n    num_queued\n    \n, \n    \n    \n    sub_type\n    \n as \n    \n    sub_type\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        app_name,\n        content_id,\n        id as email_campaign_id,\n        name as email_campaign_name,\n        num_included,\n        num_queued,\n        sub_type as email_campaign_sub_type,\n        subject as email_campaign_subject,\n        type as email_campaign_type\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:46.101350Z", "completed_at": "2024-08-30T11:09:47.043222Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:47.043748Z", "completed_at": "2024-08-30T11:09:47.043768Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0340790748596191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    deal_pipeline_id\n    \n as \n    \n    deal_pipeline_id\n    \n, \n    \n    \n    deal_pipeline_stage_id\n    \n as \n    \n    deal_pipeline_stage_id\n    \n, \n    \n    \n    is_deleted\n    \n as is_deal_deleted , \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    cast(null as integer) as \n    \n    portal_id\n    \n , \n    cast(null as TEXT) as deal_name , \n    cast(null as TEXT) as description , \n    cast(null as integer) as amount , \n    cast(null as timestamp) as closed_date , \n    cast(null as timestamp) as created_date \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_deal_columns.sql macro\n        deal_name,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        is_deal_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        cast(deal_pipeline_id as TEXT) as deal_pipeline_id,\n        cast(deal_pipeline_stage_id as TEXT) as deal_pipeline_stage_id,\n        owner_id,\n        portal_id,\n        description,\n        amount\n\n        --The below macro adds the fields defined within your hubspot__deal_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__deal_calculated_fields variable.\n        \n\n\n\n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:46.170383Z", "completed_at": "2024-08-30T11:09:47.237259Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:47.237777Z", "completed_at": "2024-08-30T11:09:47.237786Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1783430576324463, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    category\n    \n as \n    \n    category\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n    from base\n    \n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        category as bounce_category,\n        id as event_id,\n        response as returned_response,\n        status as returned_status\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:46.236087Z", "completed_at": "2024-08-30T11:09:47.243396Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:47.243848Z", "completed_at": "2024-08-30T11:09:47.243853Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1204462051391602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    referer\n    \n as \n    \n    referer\n    \n, \n    \n    \n    url\n    \n as \n    \n    url\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        referer as referer_url,\n        url as click_url,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:46.809352Z", "completed_at": "2024-08-30T11:09:47.798042Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:47.798546Z", "completed_at": "2024-08-30T11:09:47.798553Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.094750165939331, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    attempt\n    \n as \n    \n    attempt\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        attempt as attempt_number,\n        id as event_id,\n        response as returned_response\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:47.136086Z", "completed_at": "2024-08-30T11:09:48.150340Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:48.150818Z", "completed_at": "2024-08-30T11:09:48.150825Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1315419673919678, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    drop_message\n    \n as \n    \n    drop_message\n    \n, \n    \n    \n    drop_reason\n    \n as \n    \n    drop_reason\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        drop_message,\n        drop_reason,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_dropped_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:47.349925Z", "completed_at": "2024-08-30T11:09:48.294320Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:48.295252Z", "completed_at": "2024-08-30T11:09:48.295263Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0470428466796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    smtp_id\n    \n as \n    \n    smtp_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        response as returned_response,\n        smtp_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:47.357648Z", "completed_at": "2024-08-30T11:09:48.306651Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:48.307140Z", "completed_at": "2024-08-30T11:09:48.307146Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0482518672943115, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:47.907273Z", "completed_at": "2024-08-30T11:09:48.899552Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:48.900046Z", "completed_at": "2024-08-30T11:09:48.900053Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1028788089752197, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:48.269008Z", "completed_at": "2024-08-30T11:09:49.331002Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:49.331479Z", "completed_at": "2024-08-30T11:09:49.331486Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1774461269378662, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    duration\n    \n as \n    \n    duration\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        duration as duration_open,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:48.406369Z", "completed_at": "2024-08-30T11:09:49.414189Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:49.414681Z", "completed_at": "2024-08-30T11:09:49.414688Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1106560230255127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        ip_address,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:48.399748Z", "completed_at": "2024-08-30T11:09:49.423068Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:49.423522Z", "completed_at": "2024-08-30T11:09:49.423527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1265861988067627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_sent_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:49.011430Z", "completed_at": "2024-08-30T11:09:49.987516Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:49.988051Z", "completed_at": "2024-08-30T11:09:49.988058Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0814011096954346, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:49.520015Z", "completed_at": "2024-08-30T11:09:50.474116Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:50.474636Z", "completed_at": "2024-08-30T11:09:50.474643Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0666821002960205, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bounced\n    \n as \n    \n    bounced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    portal_subscription_status\n    \n as \n    \n    portal_subscription_status\n    \n, \n    \n    \n    requested_by\n    \n as \n    \n    requested_by\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    subscriptions\n    \n as \n    \n    subscriptions\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bounced as is_bounced,\n        id as event_id,\n        portal_subscription_status as subscription_status,\n        requested_by as requested_by_email,\n        source as change_source,\n        subscriptions\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:49.446926Z", "completed_at": "2024-08-30T11:09:50.492488Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:50.492943Z", "completed_at": "2024-08-30T11:09:50.492948Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1482288837432861, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    caused_by_created\n    \n as \n    \n    caused_by_created\n    \n, \n    \n    \n    caused_by_id\n    \n as \n    \n    caused_by_id\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_campaign_id\n    \n as \n    \n    email_campaign_id\n    \n, \n    \n    \n    filtered_event\n    \n as \n    \n    filtered_event\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    obsoleted_by_created\n    \n as \n    \n    obsoleted_by_created\n    \n, \n    \n    \n    obsoleted_by_id\n    \n as \n    \n    obsoleted_by_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    recipient\n    \n as \n    \n    recipient\n    \n, \n    \n    \n    sent_by_created\n    \n as \n    \n    sent_by_created\n    \n, \n    \n    \n    sent_by_id\n    \n as \n    \n    sent_by_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        cast(caused_by_created as timestamp) as caused_timestamp,\n        caused_by_id as caused_by_event_id,\n        cast(created as timestamp) as created_timestamp,\n        email_campaign_id,\n        filtered_event as is_filtered_event,\n        id as event_id,\n        cast(obsoleted_by_created as timestamp) as obsoleted_timestamp,\n        obsoleted_by_id as obsoleted_by_event_id,\n        portal_id,\n        recipient as recipient_email_address,\n        cast(sent_by_created as timestamp) as sent_timestamp,\n        sent_by_id as sent_by_event_id,\n        type as event_type\n    from macro\n    \n)\n\nselect *\nfrom fields\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:49.526738Z", "completed_at": "2024-08-30T11:09:50.537278Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:50.537750Z", "completed_at": "2024-08-30T11:09:50.537756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1228652000427246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company_tmp\"\n\n), macro as (\n\n    select \n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:50.094537Z", "completed_at": "2024-08-30T11:09:51.071503Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:51.072007Z", "completed_at": "2024-08-30T11:09:51.072015Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0924630165100098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:50.587330Z", "completed_at": "2024-08-30T11:09:51.569007Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:51.569823Z", "completed_at": "2024-08-30T11:09:51.569832Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0872807502746582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:50.595671Z", "completed_at": "2024-08-30T11:09:51.569524Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:51.570943Z", "completed_at": "2024-08-30T11:09:51.570947Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0804331302642822, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_all_owner_ids\" as all_owner_ids\n        , \"property_hs_all_team_ids\" as all_team_ids\n        , \"property_hs_email_subject\" as email_subject\n        , \"property_hs_email_text\" as email_text\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_modified_by\" as modified_by\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:50.652090Z", "completed_at": "2024-08-30T11:09:51.744621Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:51.745253Z", "completed_at": "2024-08-30T11:09:51.745260Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2041780948638916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n , \n    cast(null as TEXT) as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    cast(null as timestamp) as created_timestamp , \n    cast(null as timestamp) as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"created_from_link_id\"\n        , \"end_time\"\n        , \"pre_meeting_prospect_reminders\"\n        , \"source\"\n        , \"source_id\"\n        , \"start_time\"\n        , \"web_conference_meeting_id\"\n        , \"meeting_outcome\"\n        , \"body\"\n        , \"external_url\"\n        , \"title\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:51.188634Z", "completed_at": "2024-08-30T11:09:52.143299Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:52.143804Z", "completed_at": "2024-08-30T11:09:52.143810Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0467677116394043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    cast(null as TEXT) as note , \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_body_preview\" as body_preview\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_note_body\" as note_body\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:51.679234Z", "completed_at": "2024-08-30T11:09:52.651737Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:52.652264Z", "completed_at": "2024-08-30T11:09:52.652271Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0674479007720947, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as is_active , \n    cast(null as timestamp) as created_timestamp , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as integer) as \n    \n    owner_id\n    \n , \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    cast(null as timestamp) as occurred_timestamp , \n    \n    \n    type\n    \n as engagement_type \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as engagement_id,\n        created_timestamp,\n        owner_id,\n        occurred_timestamp,\n        portal_id,\n        engagement_type,\n        is_active\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:51.684299Z", "completed_at": "2024-08-30T11:09:52.652716Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:52.653225Z", "completed_at": "2024-08-30T11:09:52.653229Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0730528831481934, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        , \"property_hs_task_type\" as task_type\n        \n        \n        \n\n        \n        \n        , \"property_hs_object_id\" as object_id\n        , \"property_hs_engagement_source\" as engagement_source\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:51.858771Z", "completed_at": "2024-08-30T11:09:52.763220Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:52.763706Z", "completed_at": "2024-08-30T11:09:52.763713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0012931823730469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__merged_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    merged_deal_id\n    \n as \n    \n    merged_deal_id\n    \n\n\n\n    from base\n\n), fields as (\n    \n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        merged_deal_id\n    from macro\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:52.235887Z", "completed_at": "2024-08-30T11:09:53.290303Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:53.291286Z", "completed_at": "2024-08-30T11:09:53.291297Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.161600112915039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        email as email_address,\n        first_name,\n        last_name,\n        owner_id,\n        portal_id,\n        type as owner_type,\n        cast(updated_at as timestamp) as updated_timestamp,\n        trim( first_name || ' ' || last_name ) as full_name\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:52.752414Z", "completed_at": "2024-08-30T11:09:53.709738Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:53.710246Z", "completed_at": "2024-08-30T11:09:53.710253Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0627000331878662, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    calculated\n    \n as \n    \n    calculated\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    field_type\n    \n as \n    \n    field_type\n    \n, \n    \n    \n    group_name\n    \n as \n    \n    group_name\n    \n, \n    \n    \n    hubspot_defined\n    \n as \n    \n    hubspot_defined\n    \n, \n    \n    \n    hubspot_object\n    \n as \n    \n    hubspot_object\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    show_currency_symbol\n    \n as \n    \n    show_currency_symbol\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_id,\n        _fivetran_synced,\n        calculated,\n        created_at,\n        description,\n        field_type,\n        group_name,\n        hubspot_defined,\n        hubspot_object,\n        label as property_label,\n        name as property_name,\n        type as property_type,\n        updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:52.746082Z", "completed_at": "2024-08-30T11:09:53.785433Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:53.786110Z", "completed_at": "2024-08-30T11:09:53.786118Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1610119342803955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_option_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    property_id\n    \n as \n    \n    property_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    hidden\n    \n as \n    \n    hidden\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        label as property_option_label,\t\n        property_id,\n        _fivetran_synced,\n        display_order,\n        hidden,\n        value as property_option_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_option\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:52.860797Z", "completed_at": "2024-08-30T11:09:53.845886Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:53.846422Z", "completed_at": "2024-08-30T11:09:53.846429Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0916461944580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:53.398659Z", "completed_at": "2024-08-30T11:09:54.388467Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:54.388959Z", "completed_at": "2024-08-30T11:09:54.388967Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.091615915298462, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_company_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:53.815777Z", "completed_at": "2024-08-30T11:09:54.851623Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:54.852224Z", "completed_at": "2024-08-30T11:09:54.852231Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1413581371307373, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_engagement_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:53.955034Z", "completed_at": "2024-08-30T11:09:54.897385Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:54.897870Z", "completed_at": "2024-08-30T11:09:54.897876Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0370957851409912, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    name\n    \n as field_name , \n    \n    \n    source\n    \n as change_source , \n    \n    \n    source_id\n    \n as change_source_id , \n    \n    \n    timestamp_instant\n    \n as change_timestamp , \n    \n    \n    value\n    \n as new_value \n\n\n         \n            \n        \n        \n        \n\n        \n        \n        , \"_fivetran_active\"\n\n \n        \n        from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:54.992686Z", "completed_at": "2024-08-30T11:09:55.000275Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.000746Z", "completed_at": "2024-08-30T11:09:55.000751Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009005069732666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__company_company_id.0d0a080d43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.002165Z", "completed_at": "2024-08-30T11:09:55.006057Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.006571Z", "completed_at": "2024-08-30T11:09:55.006577Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0055849552154541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__company_company_id.394a2a4ba0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\"\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.009034Z", "completed_at": "2024-08-30T11:09:55.013124Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.013586Z", "completed_at": "2024-08-30T11:09:55.013591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005753755569458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_list_contact_list_id.ff8e4cc29a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.015134Z", "completed_at": "2024-08-30T11:09:55.017930Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.018374Z", "completed_at": "2024-08-30T11:09:55.018378Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004194974899291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_list_contact_list_id.036739c1b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.019775Z", "completed_at": "2024-08-30T11:09:55.026951Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.027430Z", "completed_at": "2024-08-30T11:09:55.027434Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008538961410522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__company_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company_property_history\"\n\n), windows as (\n\n    select\n        company_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by company_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(company_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__company_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.028922Z", "completed_at": "2024-08-30T11:09:55.032536Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.032978Z", "completed_at": "2024-08-30T11:09:55.032983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0049359798431396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_property_history\"\n\n), windows as (\n\n    select\n        contact_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by contact_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(contact_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.034439Z", "completed_at": "2024-08-30T11:09:55.041235Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.041731Z", "completed_at": "2024-08-30T11:09:55.041736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008211851119995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_company_company_id__deal_id__type_id.59d48f3923", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, deal_id, type_id\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_company\"\n    group by company_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.043249Z", "completed_at": "2024-08-30T11:09:55.048061Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.048675Z", "completed_at": "2024-08-30T11:09:55.048682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006421089172363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__contact_merge_adjust", "compiled": true, "compiled_code": "\n\nwith contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\"\n), contact_merge_audit as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_merge_audit\"\n\n\n), contact_merge_removal as (\n    select \n        contacts.*\n    from contacts\n    \n    left join contact_merge_audit\n        on cast(contacts.contact_id as TEXT) = cast(contact_merge_audit.vid_to_merge as TEXT)\n    \n    where contact_merge_audit.vid_to_merge is null\n)\n\nselect *\nfrom contact_merge_removal", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.050640Z", "completed_at": "2024-08-30T11:09:55.053929Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.054415Z", "completed_at": "2024-08-30T11:09:55.054421Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004841804504394531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_contact_id.9f112f8944", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.055921Z", "completed_at": "2024-08-30T11:09:55.058756Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.059208Z", "completed_at": "2024-08-30T11:09:55.059212Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004166841506958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_contact_id.b9135eb03a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\"\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.060610Z", "completed_at": "2024-08-30T11:09:55.063687Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.064148Z", "completed_at": "2024-08-30T11:09:55.064152Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004424095153808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.d53656553e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_stage_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.065600Z", "completed_at": "2024-08-30T11:09:55.069156Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.069594Z", "completed_at": "2024-08-30T11:09:55.069598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004910707473754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.ba90fa6113", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is not null\ngroup by deal_pipeline_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.070998Z", "completed_at": "2024-08-30T11:09:55.074470Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.074925Z", "completed_at": "2024-08-30T11:09:55.074932Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004849910736083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_contact_contact_id__deal_id__type_id.37de71798b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, deal_id, type_id\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_contact\"\n    group by contact_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.076751Z", "completed_at": "2024-08-30T11:09:55.080944Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.081426Z", "completed_at": "2024-08-30T11:09:55.081432Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005861043930053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_property_history\"\n\n), windows as (\n\n    select\n        deal_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by deal_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(deal_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.083047Z", "completed_at": "2024-08-30T11:09:55.085929Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.086374Z", "completed_at": "2024-08-30T11:09:55.086379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004270076751708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_deal_pipeline_id.8a0e3cd7a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.088040Z", "completed_at": "2024-08-30T11:09:55.094430Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.094941Z", "completed_at": "2024-08-30T11:09:55.094947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008049249649047852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_deal_pipeline_id.dff6c45403", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is not null\ngroup by deal_pipeline_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:53.908152Z", "completed_at": "2024-08-30T11:09:54.976732Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:54.977250Z", "completed_at": "2024-08-30T11:09:54.977257Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.237989902496338, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    is_closed\n    \n as \n    \n    is_closed\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    ticket_state\n    \n as \n    \n    ticket_state\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        _fivetran_deleted as is_ticket_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        is_closed,\n        label as pipeline_stage_label,\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        cast(stage_id as integer ) as ticket_pipeline_stage_id,\n        ticket_state,\n        created_at as ticket_pipeline_stage_created_at,\n        updated_at as ticket_pipeline_stage_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.096724Z", "completed_at": "2024-08-30T11:09:55.146829Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.150054Z", "completed_at": "2024-08-30T11:09:55.150059Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05453777313232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_campaign_email_campaign_id.79921899a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.147071Z", "completed_at": "2024-08-30T11:09:55.151045Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.152226Z", "completed_at": "2024-08-30T11:09:55.152231Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00926518440246582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_campaign_email_campaign_id.9820d33f2e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.152480Z", "completed_at": "2024-08-30T11:09:55.156868Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.160279Z", "completed_at": "2024-08-30T11:09:55.160285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009485960006713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_deal_id.ff48693e20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.157168Z", "completed_at": "2024-08-30T11:09:55.161792Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.165086Z", "completed_at": "2024-08-30T11:09:55.165091Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00928187370300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_deal_id.ac1628ac69", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\"\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.162485Z", "completed_at": "2024-08-30T11:09:55.166119Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.167119Z", "completed_at": "2024-08-30T11:09:55.167123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009543895721435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_bounce_event_id.71b13d26d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.167356Z", "completed_at": "2024-08-30T11:09:55.172262Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.175256Z", "completed_at": "2024-08-30T11:09:55.175261Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009310007095336914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_bounce_event_id.0341ffa8e9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.172508Z", "completed_at": "2024-08-30T11:09:55.176522Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.179654Z", "completed_at": "2024-08-30T11:09:55.179658Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008478879928588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_click_event_id.8a1be931c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.177167Z", "completed_at": "2024-08-30T11:09:55.180629Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.181645Z", "completed_at": "2024-08-30T11:09:55.181648Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008600950241088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_click_event_id.da8d8487a1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.181875Z", "completed_at": "2024-08-30T11:09:55.185938Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.189550Z", "completed_at": "2024-08-30T11:09:55.189556Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009133100509643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_deferred_event_id.80293078e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.186748Z", "completed_at": "2024-08-30T11:09:55.190632Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.191635Z", "completed_at": "2024-08-30T11:09:55.191639Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010224103927612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_deferred_event_id.2f779e2912", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.191869Z", "completed_at": "2024-08-30T11:09:55.200287Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.200847Z", "completed_at": "2024-08-30T11:09:55.200853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010390043258666992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_dropped_event_id.c92d449f52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.197265Z", "completed_at": "2024-08-30T11:09:55.201800Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.202858Z", "completed_at": "2024-08-30T11:09:55.202862Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009392738342285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_dropped_event_id.40706bbf71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.203087Z", "completed_at": "2024-08-30T11:09:55.207245Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.210665Z", "completed_at": "2024-08-30T11:09:55.210671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009016990661621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_delivered_event_id.87c8eb3f20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.207542Z", "completed_at": "2024-08-30T11:09:55.211648Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.212684Z", "completed_at": "2024-08-30T11:09:55.212688Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009953975677490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_delivered_event_id.f818bf03fc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.212916Z", "completed_at": "2024-08-30T11:09:55.217785Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.220870Z", "completed_at": "2024-08-30T11:09:55.220875Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009399175643920898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_forward_event_id.b9a8bf63b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.218016Z", "completed_at": "2024-08-30T11:09:55.221829Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.223085Z", "completed_at": "2024-08-30T11:09:55.223091Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009190797805786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_forward_event_id.7f133d2dd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.223433Z", "completed_at": "2024-08-30T11:09:55.227898Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.231310Z", "completed_at": "2024-08-30T11:09:55.231321Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009702920913696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_print_event_id.94d4e09b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.228147Z", "completed_at": "2024-08-30T11:09:55.232346Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.233343Z", "completed_at": "2024-08-30T11:09:55.233346Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009371757507324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_print_event_id.40a8ccd3f3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.233572Z", "completed_at": "2024-08-30T11:09:55.237683Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.241894Z", "completed_at": "2024-08-30T11:09:55.241899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009766101837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_open_event_id.a2e658fe16", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.238386Z", "completed_at": "2024-08-30T11:09:55.242925Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.243928Z", "completed_at": "2024-08-30T11:09:55.243932Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009714841842651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_open_event_id.3a369549b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.244159Z", "completed_at": "2024-08-30T11:09:55.248222Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.251497Z", "completed_at": "2024-08-30T11:09:55.251506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00886988639831543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_spam_report_event_id.2a56aced8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.248498Z", "completed_at": "2024-08-30T11:09:55.252635Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.253751Z", "completed_at": "2024-08-30T11:09:55.253755Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009177207946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_spam_report_event_id.448320447a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.254009Z", "completed_at": "2024-08-30T11:09:55.260940Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.261534Z", "completed_at": "2024-08-30T11:09:55.261540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009332895278930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_sent_event_id.cf77d9f15d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.258305Z", "completed_at": "2024-08-30T11:09:55.261760Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.263047Z", "completed_at": "2024-08-30T11:09:55.263051Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006166934967041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_sent_event_id.122cb22272", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.264541Z", "completed_at": "2024-08-30T11:09:55.272392Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.273401Z", "completed_at": "2024-08-30T11:09:55.273407Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011048316955566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_call_engagement_id.5ceb3917bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.269422Z", "completed_at": "2024-08-30T11:09:55.272685Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.273736Z", "completed_at": "2024-08-30T11:09:55.273740Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006306171417236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_call_engagement_id.43b4413603", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.277283Z", "completed_at": "2024-08-30T11:09:55.282878Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.284087Z", "completed_at": "2024-08-30T11:09:55.284094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009084701538085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_status_change_event_id.c5e80297b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.280229Z", "completed_at": "2024-08-30T11:09:55.283219Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.284379Z", "completed_at": "2024-08-30T11:09:55.284382Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009207963943481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_status_change_event_id.13105203e0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.290508Z", "completed_at": "2024-08-30T11:09:55.294505Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.295761Z", "completed_at": "2024-08-30T11:09:55.295766Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009699821472167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_event_id.4f287f3531", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.297217Z", "completed_at": "2024-08-30T11:09:55.303134Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.303630Z", "completed_at": "2024-08-30T11:09:55.303635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0080718994140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_event_id.734683460d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.300514Z", "completed_at": "2024-08-30T11:09:55.304403Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.305585Z", "completed_at": "2024-08-30T11:09:55.305589Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006308078765869141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_email_engagement_id.175561ecca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.306515Z", "completed_at": "2024-08-30T11:09:55.312663Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.313334Z", "completed_at": "2024-08-30T11:09:55.313341Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008901834487915039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_email_engagement_id.5eeb06dcfc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.310139Z", "completed_at": "2024-08-30T11:09:55.313616Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.315005Z", "completed_at": "2024-08-30T11:09:55.315009Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0061910152435302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_meeting_engagement_id.18dd11dc28", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.316728Z", "completed_at": "2024-08-30T11:09:55.324720Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.325402Z", "completed_at": "2024-08-30T11:09:55.325409Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010767221450805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_meeting_engagement_id.70721fb830", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.321897Z", "completed_at": "2024-08-30T11:09:55.325167Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.326309Z", "completed_at": "2024-08-30T11:09:55.326313Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005856990814208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_note_engagement_id.244059891e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.328557Z", "completed_at": "2024-08-30T11:09:55.339444Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.339943Z", "completed_at": "2024-08-30T11:09:55.339949Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013149738311767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_note_engagement_id.e2eaf5256e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.331783Z", "completed_at": "2024-08-30T11:09:55.344253Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.344842Z", "completed_at": "2024-08-30T11:09:55.344847Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01706981658935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagements", "compiled": true, "compiled_code": "\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement\"\n\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\"\n\n), contacts_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(contact_id)\n as contact_ids\n    from contacts\n    group by 1\n\n\n\n\n\n), deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal\"\n \n), deals_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(deal_id)\n as deal_ids\n    from deals\n    group by 1\n\n\n\n\n\n), companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company\"\n\n), companies_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(company_id)\n as company_ids\n    from companies\n    group by 1\n\n\n\n), joined as (\n\n    select \n         contacts_agg.contact_ids, \n         deals_agg.deal_ids, \n         companies_agg.company_ids, \n        engagements.*\n    from engagements\n     left join contacts_agg using (engagement_id) \n     left join deals_agg using (engagement_id) \n     left join companies_agg using (engagement_id) \n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.341624Z", "completed_at": "2024-08-30T11:09:55.345542Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.346844Z", "completed_at": "2024-08-30T11:09:55.346848Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006418943405151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_engagement_id.b26f4d328f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.347747Z", "completed_at": "2024-08-30T11:09:55.355155Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.355847Z", "completed_at": "2024-08-30T11:09:55.355854Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009994029998779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_engagement_id.4f054187b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.352502Z", "completed_at": "2024-08-30T11:09:55.355627Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.356763Z", "completed_at": "2024-08-30T11:09:55.356766Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005502939224243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_task_engagement_id.0bbd752d82", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.358805Z", "completed_at": "2024-08-30T11:09:55.364129Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.364582Z", "completed_at": "2024-08-30T11:09:55.364587Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007500171661376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_task_engagement_id.0f578bc80c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.361642Z", "completed_at": "2024-08-30T11:09:55.364791Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.365950Z", "completed_at": "2024-08-30T11:09:55.365954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008173227310180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__merged_deal_deal_id.a843ca0610", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.367357Z", "completed_at": "2024-08-30T11:09:55.377872Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.378368Z", "completed_at": "2024-08-30T11:09:55.378374Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012646198272705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__merged_deal_merged_deal_id.c2d24039b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect merged_deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\"\nwhere merged_deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.381495Z", "completed_at": "2024-08-30T11:09:55.387644Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.388092Z", "completed_at": "2024-08-30T11:09:55.388097Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008323192596435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__property__fivetran_id.37b6ec5db1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property\"\nwhere _fivetran_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.384601Z", "completed_at": "2024-08-30T11:09:55.388753Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.390112Z", "completed_at": "2024-08-30T11:09:55.390116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009571075439453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__property__fivetran_id.1d41a2aa95", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    _fivetran_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property\"\nwhere _fivetran_id is not null\ngroup by _fivetran_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.391018Z", "completed_at": "2024-08-30T11:09:55.401790Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.407571Z", "completed_at": "2024-08-30T11:09:55.407579Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018403053283691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__property_option_property_id__property_option_label.2792c4669b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        property_id, property_option_label\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__property_option\"\n    group by property_id, property_option_label\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.395509Z", "completed_at": "2024-08-30T11:09:55.408702Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.409768Z", "completed_at": "2024-08-30T11:09:55.409773Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01894402503967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__daily_ticket_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_property_history\"\n\n    -- should we include an option pivot out ALL properties? in the same vein as our passthrough-all-columns var\n    where lower(field_name) in \n        ('hs_pipeline', 'hs_pipeline_stage'\n    )\n\n    \n    and change_timestamp >= (select cast(max(date_day) as timestamp) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__daily_ticket_history\" )\n    \n\n), windows as (\n\n    select\n        cast(date_trunc('day', change_timestamp) as date) as date_day,\n        ticket_id,\n        field_name,\n        new_value,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        _fivetran_end as valid_to\n        -- if it is currently active fivetran_end = 9999-12-31 23:59:59, but the calendar_spine will end at the current_date\n    from history\n\n), order_daily_changes as (\n\n    select \n        *,\n        row_number() over (\n            partition by date_day, ticket_id, field_name\n            order by valid_from desc\n            ) as row_num\n    from windows\n\n), extract_latest as (\n    \n    select \n        date_day,\n        ticket_id,\n        field_name,\n        case when new_value is null then 'is_null' else new_value end as new_value,\n        change_source,\n        change_source_id,\n        valid_from,\n        valid_to\n\n    from order_daily_changes\n    where row_num = 1\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from extract_latest\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.410009Z", "completed_at": "2024-08-30T11:09:55.417660Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.418134Z", "completed_at": "2024-08-30T11:09:55.418139Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00960993766784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__company_history_company_id__field_name__valid_to.654ef778b1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__company_history\"\n    group by company_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.415082Z", "completed_at": "2024-08-30T11:09:55.419065Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.420076Z", "completed_at": "2024-08-30T11:09:55.420080Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008759021759033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__company_history_id.33035793ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__company_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.420302Z", "completed_at": "2024-08-30T11:09:55.424655Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.428467Z", "completed_at": "2024-08-30T11:09:55.428472Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009582042694091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__company_history_id.f1af964b1f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__company_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.424959Z", "completed_at": "2024-08-30T11:09:55.434206Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.434862Z", "completed_at": "2024-08-30T11:09:55.434869Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011497974395751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__contact_history_contact_id__field_name__valid_to.42ccfb8329", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_history\"\n    group by contact_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.430225Z", "completed_at": "2024-08-30T11:09:55.435095Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.436521Z", "completed_at": "2024-08-30T11:09:55.436526Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007773160934448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_history_id.eaae22e088", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.438421Z", "completed_at": "2024-08-30T11:09:55.446038Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.446699Z", "completed_at": "2024-08-30T11:09:55.446706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0103759765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_history_id.aef69ae1ec", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.441805Z", "completed_at": "2024-08-30T11:09:55.447787Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.448794Z", "completed_at": "2024-08-30T11:09:55.448798Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011375904083251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_bounce\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.449041Z", "completed_at": "2024-08-30T11:09:55.453775Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.458344Z", "completed_at": "2024-08-30T11:09:55.458349Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010746002197265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_clicks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_click\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_clicks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.454025Z", "completed_at": "2024-08-30T11:09:55.459340Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.460344Z", "completed_at": "2024-08-30T11:09:55.460348Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010740995407104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_deferred\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.460630Z", "completed_at": "2024-08-30T11:09:55.465377Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.469428Z", "completed_at": "2024-08-30T11:09:55.469433Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010266780853271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_delivered\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.465643Z", "completed_at": "2024-08-30T11:09:55.470348Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.471415Z", "completed_at": "2024-08-30T11:09:55.471419Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010135889053344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_dropped\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.471654Z", "completed_at": "2024-08-30T11:09:55.479412Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.479939Z", "completed_at": "2024-08-30T11:09:55.479945Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009904146194458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_forward\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.476314Z", "completed_at": "2024-08-30T11:09:55.480161Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.481592Z", "completed_at": "2024-08-30T11:09:55.481596Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006804943084716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_opens", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_open\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_opens\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.483510Z", "completed_at": "2024-08-30T11:09:55.491297Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.491941Z", "completed_at": "2024-08-30T11:09:55.491947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01092982292175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_print", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_print\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.488158Z", "completed_at": "2024-08-30T11:09:55.492253Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.493700Z", "completed_at": "2024-08-30T11:09:55.493706Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007094144821166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_sent\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.495585Z", "completed_at": "2024-08-30T11:09:55.503334Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.503830Z", "completed_at": "2024-08-30T11:09:55.503837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010303020477294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_spam_report\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.500037Z", "completed_at": "2024-08-30T11:09:55.504796Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.506104Z", "completed_at": "2024-08-30T11:09:55.506109Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007613182067871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event_status_change\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.507047Z", "completed_at": "2024-08-30T11:09:55.511544Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.516194Z", "completed_at": "2024-08-30T11:09:55.516203Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011077165603637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__deal_history_deal_id__field_name__valid_to.f55c724804", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        deal_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_history\"\n    group by deal_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.511906Z", "completed_at": "2024-08-30T11:09:55.517400Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.518607Z", "completed_at": "2024-08-30T11:09:55.518611Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011362075805664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_history_id.a1c6cd6a75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.518858Z", "completed_at": "2024-08-30T11:09:55.526389Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.526907Z", "completed_at": "2024-08-30T11:09:55.526915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009623050689697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_history_id.1cb93fca79", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.523142Z", "completed_at": "2024-08-30T11:09:55.528673Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.532945Z", "completed_at": "2024-08-30T11:09:55.532953Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010885000228881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_event_aggregates_email_send_id.ac29e6997a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n) select email_send_id\nfrom __dbt__cte__int_hubspot__email_event_aggregates\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.528949Z", "completed_at": "2024-08-30T11:09:55.534151Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.535328Z", "completed_at": "2024-08-30T11:09:55.535333Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012953042984008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_event_aggregates_email_send_id.4deec238f9", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n) select\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__email_event_aggregates\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.535579Z", "completed_at": "2024-08-30T11:09:55.549957Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.551206Z", "completed_at": "2024-08-30T11:09:55.551217Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017364978790283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__companies", "compiled": true, "compiled_code": "\n\nwith companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\"\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_company\"\n\n), engagement_companies_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_companies.company_id\n    from engagements\n    inner join engagement_companies\n        using (engagement_id)\n\n), engagement_companies_agg as (\n\n    \n\n    select\n        company_id,\n        count(case when engagement_type = 'NOTE' then company_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then company_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then company_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then company_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then company_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then company_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then company_id end) as count_engagement_forwarded_emails\n    from engagement_companies_joined\n    group by 1\n\n\n\n), joined as (\n\n    select \n        companies.*,\n        \n        coalesce(engagement_companies_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_companies_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_companies_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_companies_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_companies_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from companies\n    left join engagement_companies_agg\n        using (company_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__companies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:54.492284Z", "completed_at": "2024-08-30T11:09:55.614517Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:55.615080Z", "completed_at": "2024-08-30T11:09:55.615087Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.2357189655303955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    object_type_id\n    \n as \n    \n    object_type_id\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        _fivetran_deleted as is_ticket_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        object_type_id,\n        created_at as ticket_pipeline_created_at,\n        updated_at as ticket_pipeline_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:54.958856Z", "completed_at": "2024-08-30T11:09:56.083596Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.084072Z", "completed_at": "2024-08-30T11:09:56.084079Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2325220108032227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as ticket_id , \n    cast(null as boolean) as _fivetran_ticket_deleted , \n    \n    \n    is_deleted\n    \n as is_ticket_deleted , \n    \n    \n    property_closed_date\n    \n as closed_date , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_first_agent_reply_date\n    \n as first_agent_reply_at , \n    \n    \n    property_hs_pipeline\n    \n as ticket_pipeline_id , \n    \n    \n    property_hs_pipeline_stage\n    \n as ticket_pipeline_stage_id , \n    \n    \n    property_hs_ticket_category\n    \n as ticket_category , \n    \n    \n    property_hs_ticket_priority\n    \n as ticket_priority , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_subject\n    \n as ticket_subject , \n    \n    \n    property_content\n    \n as ticket_content \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_ticket_columns.sql macro\n        ticket_id,\n        coalesce(_fivetran_ticket_deleted, is_ticket_deleted) as is_ticket_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        first_agent_reply_at,\n        ticket_pipeline_id,\n        ticket_pipeline_stage_id,\n        ticket_category,\n        ticket_priority,\n        owner_id,\n        ticket_subject,\n        ticket_content\n\n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__ticket_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.553187Z", "completed_at": "2024-08-30T11:09:56.520958Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.522110Z", "completed_at": "2024-08-30T11:09:56.522126Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0857489109039307, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_emails", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_email\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"all_owner_ids\",\n  base.\"all_team_ids\",\n  base.\"email_subject\",\n  base.\"email_text\",\n  base.\"lastmodifieddate\",\n  base.\"modified_by\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_emails\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.542474Z", "completed_at": "2024-08-30T11:09:56.577104Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.577647Z", "completed_at": "2024-08-30T11:09:56.577656Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.145557165145874, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_calls", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_call\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_calls\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.695137Z", "completed_at": "2024-08-30T11:09:56.697929Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.698398Z", "completed_at": "2024-08-30T11:09:56.698403Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00418400764465332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagements_engagement_id.59b32bc0d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.699974Z", "completed_at": "2024-08-30T11:09:56.703685Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.704140Z", "completed_at": "2024-08-30T11:09:56.704145Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0051610469818115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagements_engagement_id.01d5c3ee5d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.705624Z", "completed_at": "2024-08-30T11:09:56.760127Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.760751Z", "completed_at": "2024-08-30T11:09:56.760759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05615687370300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_stages", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\"\n\n\n), merged_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\"\n\n), aggregate_merged_deals as (\n\n    select\n        deal_id,\n        \n    array_agg(merged_deal_id)\n as merged_deal_ids\n    from merged_deals\n    group by 1\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n        aggregate_merged_deals.merged_deal_ids,\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n    left join aggregate_merged_deals\n        on deals.deal_id = aggregate_merged_deals.deal_id\n\n    left join merged_deals\n        on deals.deal_id = merged_deals.merged_deal_id\n    where merged_deals.merged_deal_id is null\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n), deal_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_stage\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\n\n), final as (\n\n    select\n        deal_stage.deal_id || '-' || row_number() over(partition by deal_stage.deal_id order by deal_stage.date_entered asc) as deal_stage_id,\n        deals_enhanced.deal_id,\n        deals_enhanced.deal_name,\n\n        \n        deals_enhanced.merged_deal_ids,\n        \n        \n        deal_stage._fivetran_start as date_stage_entered,\n        deal_stage._fivetran_end as date_stage_exited,\n        deal_stage._fivetran_active as is_stage_active,\n        deal_stage.deal_stage_name as pipeline_stage_id,\n        pipeline_stage.pipeline_stage_label,\n        pipeline_stage.deal_pipeline_id as pipeline_id,\n        pipeline.pipeline_label,\n        deal_stage.source,\n        deal_stage.source_id,\n        pipeline_stage.is_active as is_pipeline_stage_active,\n        pipeline.is_active as is_pipeline_active,\n        pipeline_stage.is_closed_won as is_pipeline_stage_closed_won,\n        pipeline_stage.display_order as pipeline_stage_display_order,\n        pipeline.display_order as pipeline_display_order,\n        pipeline_stage.probability as pipeline_stage_probability,\n        coalesce(pipeline.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        coalesce(pipeline_stage.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        coalesce(deals_enhanced.is_deal_deleted, false) as is_deal_deleted,\n        pipeline_stage.deal_pipeline_stage_created_at,\n        pipeline_stage.deal_pipeline_stage_updated_at\n\n    from deal_stage\n\n    left join pipeline_stage\n        on deal_stage.deal_stage_name = pipeline_stage.deal_pipeline_stage_id\n    \n    left join pipeline\n        on pipeline_stage.deal_pipeline_id = pipeline.deal_pipeline_id\n\n    left join deals_enhanced\n        on deal_stage.deal_id = deals_enhanced.deal_id\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_stages\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.762296Z", "completed_at": "2024-08-30T11:09:56.779437Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.779970Z", "completed_at": "2024-08-30T11:09:56.779977Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018661022186279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deals", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal\"\n\n\n), merged_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__merged_deal\"\n\n), aggregate_merged_deals as (\n\n    select\n        deal_id,\n        \n    array_agg(merged_deal_id)\n as merged_deal_ids\n    from merged_deals\n    group by 1\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n        aggregate_merged_deals.merged_deal_ids,\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n    left join aggregate_merged_deals\n        on deals.deal_id = aggregate_merged_deals.deal_id\n\n    left join merged_deals\n        on deals.deal_id = merged_deals.merged_deal_id\n    where merged_deals.merged_deal_id is null\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_deal\"\n\n), engagement_deal_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_deals.deal_id\n    from engagements\n    inner join engagement_deals\n        on cast(engagements.engagement_id as bigint) = cast(engagement_deals.engagement_id as bigint )\n\n), engagement_deal_agg as (\n\n    \n\n    select\n        deal_id,\n        count(case when engagement_type = 'NOTE' then deal_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then deal_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then deal_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then deal_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then deal_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then deal_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then deal_id end) as count_engagement_forwarded_emails\n    from engagement_deal_joined\n    group by 1\n\n\n\n), engagements_joined as (\n\n    select \n        deals_enhanced.*,\n        \n        coalesce(engagement_deal_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_deal_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_deal_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_deal_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_deal_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from deals_enhanced\n    left join engagement_deal_agg\n        on cast(deals_enhanced.deal_id as bigint) = cast(engagement_deal_agg.deal_id as bigint )\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.782071Z", "completed_at": "2024-08-30T11:09:56.788915Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.789362Z", "completed_at": "2024-08-30T11:09:56.789368Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008498907089233398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__pivot_daily_ticket_history", "compiled": true, "compiled_code": "\n\n\n\nwith daily_history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__daily_ticket_history\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__pivot_daily_ticket_history\" )\n    \n\n), pivot_out as (\n\n    select \n        date_day, \n        ticket_id\n\n        -- should we remove the `hs_` prefix? could introduce some duplicates if people already have something like `hs_owner` and `owner`\n        , max(case when lower(field_name) = 'hs_pipeline' then new_value end) as hs_pipeline\n        , max(case when lower(field_name) = 'hs_pipeline_stage' then new_value end) as hs_pipeline_stage\n        from daily_history\n\n    group by 1,2\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from pivot_out\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__pivot_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.790724Z", "completed_at": "2024-08-30T11:09:56.794119Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.794612Z", "completed_at": "2024-08-30T11:09:56.794617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0047571659088134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_bounce_event_id.39d8daa6f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.796201Z", "completed_at": "2024-08-30T11:09:56.799367Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.799868Z", "completed_at": "2024-08-30T11:09:56.799879Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004754781723022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_bounce_event_id.7a1c6704e1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_bounce\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.801360Z", "completed_at": "2024-08-30T11:09:56.806085Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.806633Z", "completed_at": "2024-08-30T11:09:56.806640Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006481170654296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_clicks_event_id.f603501ca0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_clicks\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.809261Z", "completed_at": "2024-08-30T11:09:56.812613Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.813095Z", "completed_at": "2024-08-30T11:09:56.813100Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005071163177490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_clicks_event_id.60d3912846", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_clicks\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.814598Z", "completed_at": "2024-08-30T11:09:56.818393Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.818836Z", "completed_at": "2024-08-30T11:09:56.818841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005171775817871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_deferred_event_id.2c6decaa91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.820256Z", "completed_at": "2024-08-30T11:09:56.823165Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.823608Z", "completed_at": "2024-08-30T11:09:56.823612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004286050796508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_deferred_event_id.bb75dcb83a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_deferred\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.825136Z", "completed_at": "2024-08-30T11:09:56.828049Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.828489Z", "completed_at": "2024-08-30T11:09:56.828494Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004259824752807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_delivered_event_id.0609870be3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.829945Z", "completed_at": "2024-08-30T11:09:56.832627Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.833061Z", "completed_at": "2024-08-30T11:09:56.833065Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0040051937103271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_delivered_event_id.242e838cce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_delivered\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.834421Z", "completed_at": "2024-08-30T11:09:56.837125Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.837591Z", "completed_at": "2024-08-30T11:09:56.837596Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004052162170410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_dropped_event_id.5cfe4eeb95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.839227Z", "completed_at": "2024-08-30T11:09:56.842872Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.843321Z", "completed_at": "2024-08-30T11:09:56.843326Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0051708221435546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_dropped_event_id.093040860b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_dropped\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.844738Z", "completed_at": "2024-08-30T11:09:56.847567Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.848057Z", "completed_at": "2024-08-30T11:09:56.848062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004238128662109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_forward_event_id.417a73da08", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.849698Z", "completed_at": "2024-08-30T11:09:56.852834Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.853308Z", "completed_at": "2024-08-30T11:09:56.853313Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004720926284790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_forward_event_id.064956aaa7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_forward\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.854850Z", "completed_at": "2024-08-30T11:09:56.857554Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.858004Z", "completed_at": "2024-08-30T11:09:56.858008Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0040781497955322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_opens_event_id.a9fe279ee1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_opens\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.859423Z", "completed_at": "2024-08-30T11:09:56.862346Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.862813Z", "completed_at": "2024-08-30T11:09:56.862818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004318952560424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_opens_event_id.d7963f4eb0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_opens\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.864365Z", "completed_at": "2024-08-30T11:09:56.867999Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.868460Z", "completed_at": "2024-08-30T11:09:56.868465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005079030990600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_print_event_id.9dac8a147e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.869904Z", "completed_at": "2024-08-30T11:09:56.872600Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.873039Z", "completed_at": "2024-08-30T11:09:56.873043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004019975662231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_print_event_id.548f6cece7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_print\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.874471Z", "completed_at": "2024-08-30T11:09:56.877427Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.877850Z", "completed_at": "2024-08-30T11:09:56.877854Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00426173210144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_sent_event_id.5507dcc5b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.879444Z", "completed_at": "2024-08-30T11:09:56.882524Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.882984Z", "completed_at": "2024-08-30T11:09:56.882989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004598140716552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_sent_event_id.68076270f8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_sent\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.884415Z", "completed_at": "2024-08-30T11:09:56.887321Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.887762Z", "completed_at": "2024-08-30T11:09:56.887766Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004221916198730469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_spam_report_event_id.5ddca8771a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.889295Z", "completed_at": "2024-08-30T11:09:56.893485Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.893947Z", "completed_at": "2024-08-30T11:09:56.893952Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005663871765136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_spam_report_event_id.20aab81ec6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_spam_report\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.899306Z", "completed_at": "2024-08-30T11:09:56.902115Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.902603Z", "completed_at": "2024-08-30T11:09:56.902607Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0041959285736083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_status_change_event_id.a1737e44b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.904104Z", "completed_at": "2024-08-30T11:09:56.907085Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.907542Z", "completed_at": "2024-08-30T11:09:56.907547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00440216064453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_status_change_event_id.2e5b2b72e2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.909086Z", "completed_at": "2024-08-30T11:09:56.911968Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.912402Z", "completed_at": "2024-08-30T11:09:56.912407Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00426030158996582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__companies_company_id.687ec98e97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__companies\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.913908Z", "completed_at": "2024-08-30T11:09:56.917865Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.918316Z", "completed_at": "2024-08-30T11:09:56.918322Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005383968353271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__companies_company_id.a58ceac3f2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__companies\" where not coalesce(is_company_deleted, false)) dbt_subquery\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:55.728596Z", "completed_at": "2024-08-30T11:09:56.806863Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.808176Z", "completed_at": "2024-08-30T11:09:56.808180Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1991469860076904, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_meetings", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_meeting\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"created_from_link_id\",\n  base.\"end_time\",\n  base.\"pre_meeting_prospect_reminders\",\n  base.\"source\",\n  base.\"source_id\",\n  base.\"start_time\",\n  base.\"web_conference_meeting_id\",\n  base.\"meeting_outcome\",\n  base.\"body\",\n  base.\"external_url\",\n  base.\"title\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_meetings\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.928380Z", "completed_at": "2024-08-30T11:09:56.931359Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.931815Z", "completed_at": "2024-08-30T11:09:56.931820Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004354000091552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__ticket_ticket_id.299e7c4c53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.933216Z", "completed_at": "2024-08-30T11:09:56.935982Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.936427Z", "completed_at": "2024-08-30T11:09:56.936431Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004094123840332031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__ticket_ticket_id.78c6fbfcaf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.937820Z", "completed_at": "2024-08-30T11:09:56.952439Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.952888Z", "completed_at": "2024-08-30T11:09:56.952895Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01595902442932129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__tickets", "compiled": true, "compiled_code": "\n\nwith ticket as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\"\n\n), ticket_pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline\"\n\n), ticket_pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage\"\n\n\n\n\n), ticket_company as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_company\"\n\n), company as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__company\"\n\n), join_companies as (\n    \n    select\n        ticket_company.ticket_id,\n        ticket_company.company_id,\n        company.company_name\n\n    from ticket_company\n    left join company \n        on ticket_company.company_id = company.company_id\n\n), agg_companies as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when company_id is null then '' else cast(company_id as TEXT) end)\n as company_ids,\n        \n    array_agg(case when company_name is null then '' else company_name end)\n as company_names\n\n    from join_companies\n    group by 1\n\n\n\n\n), ticket_contact as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_contact\"\n\n), contact as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact\"\n\n), join_contacts as (\n    \n    select\n        ticket_contact.ticket_id,\n        ticket_contact.contact_id,\n        contact.email\n\n    from ticket_contact\n    left join contact \n        on ticket_contact.contact_id = contact.contact_id\n\n), agg_contacts as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when contact_id is null then '' else cast(contact_id as TEXT) end)\n as contact_ids,\n        \n    array_agg(case when email is null then '' else email end)\n as contact_emails\n\n    from join_contacts\n    group by 1\n\n\n\n\n), owner as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__owner\"\n\n\n\n\n), engagement as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), ticket_engagement as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_engagement\"\n\n), join_engagements as (\n\n    select \n        engagement.engagement_type,\n        ticket_engagement.ticket_id\n    from engagement\n    inner join ticket_engagement\n        on cast(engagement.engagement_id as bigint) = cast(ticket_engagement.engagement_id as bigint )\n\n), agg_engagements as (\n\n    \n\n    select\n        ticket_id,\n        count(case when engagement_type = 'NOTE' then ticket_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then ticket_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then ticket_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then ticket_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then ticket_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then ticket_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then ticket_id end) as count_engagement_forwarded_emails\n    from join_engagements\n    group by 1\n\n\n\n\n\n), final_join as (\n\n    select\n        ticket.*,\n        ticket_pipeline_stage.ticket_state,\n        ticket_pipeline_stage.is_closed,\n        ticket_pipeline_stage.pipeline_stage_label,\n        ticket_pipeline.pipeline_label,\n        ticket_pipeline_stage.display_order as pipeline_stage_order,\n        ticket_pipeline.is_ticket_pipeline_deleted,\n        ticket_pipeline_stage.is_ticket_pipeline_stage_deleted\n\n    \n        , owner.email_address as owner_email\n        , owner.full_name as owner_full_name\n    \n\n    \n\n    \n        , agg_contacts.contact_ids\n        , agg_contacts.contact_emails\n    \n\n    \n        , agg_companies.company_ids\n        , agg_companies.company_names\n    \n\n    \n        \n        , coalesce(agg_engagements.count_engagement_notes,0) as count_engagement_notes\n        \n        , coalesce(agg_engagements.count_engagement_tasks,0) as count_engagement_tasks\n        \n        , coalesce(agg_engagements.count_engagement_calls,0) as count_engagement_calls\n        \n        , coalesce(agg_engagements.count_engagement_meetings,0) as count_engagement_meetings\n        \n        , coalesce(agg_engagements.count_engagement_emails,0) as count_engagement_emails\n        \n        , coalesce(agg_engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails\n        \n        , coalesce(agg_engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails\n        \n    \n\n    from ticket\n\n    left join ticket_pipeline \n        on ticket.ticket_pipeline_id = ticket_pipeline.ticket_pipeline_id \n    \n    left join ticket_pipeline_stage \n        on ticket.ticket_pipeline_stage_id = ticket_pipeline_stage.ticket_pipeline_stage_id\n        and ticket_pipeline.ticket_pipeline_id = ticket_pipeline_stage.ticket_pipeline_id\n\n    \n    left join owner \n        on ticket.owner_id = owner.owner_id\n    \n\n    \n\n    \n    left join agg_contacts\n        on ticket.ticket_id = agg_contacts.ticket_id \n    \n\n    \n    left join agg_companies\n        on ticket.ticket_id = agg_companies.ticket_id \n    \n\n    \n    left join agg_engagements\n        on ticket.ticket_id = agg_engagements.ticket_id\n    \n)\n\nselect *\nfrom final_join", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.954489Z", "completed_at": "2024-08-30T11:09:56.957752Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.958211Z", "completed_at": "2024-08-30T11:09:56.958216Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004683017730712891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_emails_engagement_id.13a39d1e09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_emails\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.959661Z", "completed_at": "2024-08-30T11:09:56.962388Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.962827Z", "completed_at": "2024-08-30T11:09:56.962833Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00404810905456543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_emails_engagement_id.b18e2acbde", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_emails\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.964240Z", "completed_at": "2024-08-30T11:09:56.966958Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.967389Z", "completed_at": "2024-08-30T11:09:56.967394Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004179954528808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_calls_engagement_id.00f8d8357f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_calls\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.969139Z", "completed_at": "2024-08-30T11:09:56.972139Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.972592Z", "completed_at": "2024-08-30T11:09:56.972597Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004507303237915039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_calls_engagement_id.972572ce6c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_calls\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.974051Z", "completed_at": "2024-08-30T11:09:56.978207Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.978653Z", "completed_at": "2024-08-30T11:09:56.978657Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005512237548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__engagement_metrics__by_contact_contact_id.4a800df06b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n) select contact_id\nfrom __dbt__cte__int_hubspot__engagement_metrics__by_contact\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.980104Z", "completed_at": "2024-08-30T11:09:56.983925Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.984437Z", "completed_at": "2024-08-30T11:09:56.984442Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005288839340209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__engagement_metrics__by_contact_contact_id.1c156b64ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n) select\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__engagement_metrics__by_contact\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.985971Z", "completed_at": "2024-08-30T11:09:56.988883Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.989358Z", "completed_at": "2024-08-30T11:09:56.989362Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004321098327636719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_stages_deal_stage_id.162d2d204b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_stage_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_stages\"\nwhere deal_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.990797Z", "completed_at": "2024-08-30T11:09:56.993589Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.994028Z", "completed_at": "2024-08-30T11:09:56.994033Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0041081905364990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_stages_deal_stage_id.7fd3732373", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_stage_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deal_stages\" where not coalesce(is_deal_pipeline_stage_deleted, false)) dbt_subquery\nwhere deal_stage_id is not null\ngroup by deal_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.995698Z", "completed_at": "2024-08-30T11:09:56.999157Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:56.999623Z", "completed_at": "2024-08-30T11:09:56.999629Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005110025405883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deals_deal_id.bdbfe47fcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deals\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.001123Z", "completed_at": "2024-08-30T11:09:57.004968Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.005417Z", "completed_at": "2024-08-30T11:09:57.005422Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0051877498626708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deals_deal_id.d728fe5f71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__deals\" where not coalesce(is_deal_deleted, false)) dbt_subquery\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.192008Z", "completed_at": "2024-08-30T11:09:57.108836Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.109305Z", "completed_at": "2024-08-30T11:09:57.109312Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0284299850463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_notes", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_note\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"note\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"body_preview\",\n  base.\"lastmodifieddate\",\n  base.\"note_body\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_notes\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.220968Z", "completed_at": "2024-08-30T11:09:57.232592Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.233056Z", "completed_at": "2024-08-30T11:09:57.233063Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01305389404296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_sends", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n),  __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n), sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_sent\"\n\n), metrics as (\n\n    select *\n    from __dbt__cte__int_hubspot__email_event_aggregates\n\n), joined as (\n\n    select\n        sends.*,\n        coalesce(metrics.bounces,0) as bounces,\n        coalesce(metrics.clicks,0) as clicks,\n        coalesce(metrics.deferrals,0) as deferrals,\n        coalesce(metrics.deliveries,0) as deliveries,\n        coalesce(metrics.drops,0) as drops,\n        coalesce(metrics.forwards,0) as forwards,\n        coalesce(metrics.opens,0) as opens,\n        coalesce(metrics.prints,0) as prints,\n        coalesce(metrics.spam_reports,0) as spam_reports\n    from sends\n    left join metrics using (email_send_id)\n\n), booleans as (\n\n    select \n        *,\n        bounces > 0 as was_bounced,\n        clicks > 0 as was_clicked,\n        deferrals > 0 as was_deferred,\n        deliveries > 0 as was_delivered,\n        forwards > 0 as was_forwarded,\n        opens > 0 as was_opened,\n        prints > 0 as was_printed,\n        spam_reports > 0 as was_spam_reported\n    from joined\n\n\n\n), unsubscribes as (\n\n    select *\n    from __dbt__cte__int_hubspot__email_aggregate_status_change\n\n), unsubscribes_joined as (\n\n    select \n        booleans.*,\n        coalesce(unsubscribes.unsubscribes,0) as unsubscribes,\n        coalesce(unsubscribes.unsubscribes,0) > 0 as was_unsubcribed\n    from booleans\n    left join unsubscribes using (email_send_id)\n\n)\n\nselect *\nfrom unsubscribes_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.234560Z", "completed_at": "2024-08-30T11:09:57.239396Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.239877Z", "completed_at": "2024-08-30T11:09:57.239882Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006239175796508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_aggregate_status_change_email_send_id.16bf74a3bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n) select email_send_id\nfrom __dbt__cte__int_hubspot__email_aggregate_status_change\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.241289Z", "completed_at": "2024-08-30T11:09:57.244973Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.245426Z", "completed_at": "2024-08-30T11:09:57.245430Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005035877227783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_aggregate_status_change_email_send_id.7c03e87c05", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n) select\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__email_aggregate_status_change\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.246874Z", "completed_at": "2024-08-30T11:09:57.249696Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.250153Z", "completed_at": "2024-08-30T11:09:57.250158Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004233837127685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_meetings_engagement_id.83a791c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_meetings\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.251787Z", "completed_at": "2024-08-30T11:09:57.254443Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.254898Z", "completed_at": "2024-08-30T11:09:57.254903Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004163026809692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_meetings_engagement_id.3098aabcd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_meetings\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.256337Z", "completed_at": "2024-08-30T11:09:57.259035Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.259463Z", "completed_at": "2024-08-30T11:09:57.259468Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.003996133804321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__tickets_ticket_id.259c6846d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.260953Z", "completed_at": "2024-08-30T11:09:57.265562Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.266099Z", "completed_at": "2024-08-30T11:09:57.266105Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006109952926635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__tickets_ticket_id.4b54466361", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.268051Z", "completed_at": "2024-08-30T11:09:57.271177Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.271648Z", "completed_at": "2024-08-30T11:09:57.271654Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.004803657531738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_notes_engagement_id.76434ac965", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_notes\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.273122Z", "completed_at": "2024-08-30T11:09:57.276527Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.277305Z", "completed_at": "2024-08-30T11:09:57.277311Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005151987075805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_notes_engagement_id.c9864b5001", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_notes\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.640324Z", "completed_at": "2024-08-30T11:09:57.685262Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.685867Z", "completed_at": "2024-08-30T11:09:57.685882Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1632492542266846, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_tasks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_task\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n  base.\"task_type\",\n  base.\"object_id\",\n  base.\"engagement_source\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_tasks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.006838Z", "completed_at": "2024-08-30T11:09:57.997844Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:57.998419Z", "completed_at": "2024-08-30T11:09:57.998430Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0977778434753418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__scd_daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__pivot_daily_ticket_history\"\n\n), set_values as (\n\n    select \n        date_day, \n        ticket_id,\n        id\n\n         \n        , hs_pipeline as hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_field_partition\n\n         \n        , hs_pipeline_stage as hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline_stage is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_stage_field_partition\n\n        \n    \n    from change_data\n\n), fill_values as (\n\n-- each row of the pivoted table includes ticket property values if that property was updated on that day\n-- we need to backfill to persist values that have been previously updated and are still valid \n    select \n        date_day, \n        ticket_id,\n        id\n        \n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n\n        \n\n    from set_values\n\n)\n\nselect *\nfrom fill_values", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__scd_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.105943Z", "completed_at": "2024-08-30T11:09:58.111171Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.111631Z", "completed_at": "2024-08-30T11:09:58.111636Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0068569183349609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__marketing_events_standardized", "compiled": true, "compiled_code": "with events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\" \n),\n\nstandardized as (\n\n    select \n        event_id,\n        coalesce(email_send_timestamp, created_timestamp) as activity_timestamp,\n        email_campaign_id as campaign_id,\n        recipient_email_address as email,\n        contact_id,\n        'email send' as event_type,\n        cast(null as numeric(28,6)) as event_value,    \n        cast(null as timestamp) as updated_at,\n        email_subject,\n        bounces as total_bounces,\n        clicks as total_clicks,\n        deferrals as total_deferrals,\n        deliveries as total_deliveries,\n        drops as total_drops,\n        forwards as total_forwards,\n        opens as total_opens,\n        spam_reports as total_spam_reports,\n        cast(null as integer) as total_unsubscribes,\n        was_bounced,\n        was_clicked,\n        was_deferred,\n        was_delivered,\n        was_forwarded,\n        was_opened,\n        cast(null as boolean) was_unsubscribed\n    from events\n)\n\nselect *\nfrom standardized", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_events_standardized\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:56.919815Z", "completed_at": "2024-08-30T11:09:58.034270Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.034762Z", "completed_at": "2024-08-30T11:09:58.034770Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2148640155792236, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__ticket_calendar_spine", "compiled": true, "compiled_code": "\n\nwith calendar as (\n\n    \n    \n    \n    \n    \n\n    select * \n    from (\n        \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1604\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2020-04-16' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= \n\n    \n    (current_timestamp at time zone 'utc')::timestamp\n + ((interval '1 week') * (1))\n\n\n\n)\n\nselect * from filtered\n\n \n    ) as date_spine\n\n    \n    where date_day >= (select min(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__ticket_calendar_spine\" )\n    \n\n), ticket as (\n\n    select \n        *,\n        cast( date_trunc('day', case when closed_date is null then \n    current_timestamp::timestamp\n else closed_date end) as date) as open_until\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket\"\n    where not coalesce(is_ticket_deleted, false)\n\n), joined as (\n\n    select \n        cast(calendar.date_day as date) as date_day,\n        ticket.ticket_id\n    from calendar \n    inner join ticket\n        on cast(calendar.date_day as date) >= cast(ticket.created_date as date)\n        -- use this variable to extend the ticket's history past its close date (for reporting/data viz purposes :-)\n        and cast(calendar.date_day as date) <= \n\n    ticket.open_until + ((interval '1 day') * (0))\n\n\n\n), surrogate as (\n\n    select\n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from joined\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__ticket_calendar_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.135369Z", "completed_at": "2024-08-30T11:09:58.138356Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.138790Z", "completed_at": "2024-08-30T11:09:58.138794Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0046749114990234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_sends_event_id.9fc8a8bef3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.140937Z", "completed_at": "2024-08-30T11:09:58.144027Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.144515Z", "completed_at": "2024-08-30T11:09:58.144520Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004552125930786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_sends_event_id.b01306228f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.145949Z", "completed_at": "2024-08-30T11:09:58.148739Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.149209Z", "completed_at": "2024-08-30T11:09:58.149214Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0041790008544921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_tasks_engagement_id.67738794ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_tasks\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.150675Z", "completed_at": "2024-08-30T11:09:58.154119Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.154547Z", "completed_at": "2024-08-30T11:09:58.154551Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004762172698974609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_tasks_engagement_id.754d36b939", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagement_tasks\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.156146Z", "completed_at": "2024-08-30T11:09:58.159202Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.159654Z", "completed_at": "2024-08-30T11:09:58.159659Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004449129104614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__marketing_events_standardized_event_id.04bbf23276", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_events_standardized\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.161108Z", "completed_at": "2024-08-30T11:09:58.163697Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.164126Z", "completed_at": "2024-08-30T11:09:58.164130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00392603874206543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__marketing_events_standardized_event_id.2e1e3ff399", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__marketing_events_standardized\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.279015Z", "completed_at": "2024-08-30T11:09:58.329063Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.329662Z", "completed_at": "2024-08-30T11:09:58.329670Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1580369472503662, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contacts", "compiled": true, "compiled_code": "\n\n\n\nwith  __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__contact_merge_adjust\" \n\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        recipient_email_address,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), email_joined as (\n\n    select \n        contacts.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contacts\n    left join email_metrics\n        on contacts.email = email_metrics.recipient_email_address\n\n\n\n\n\n\n\n), engagements as (\n\n    select *\n    from __dbt__cte__int_hubspot__engagement_metrics__by_contact\n\n), engagements_joined as (\n\n    select \n        email_joined.*,\n        \n        coalesce(engagements.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagements.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagements.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagements.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagements.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from email_joined\n    left join engagements\n        using (contact_id)\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contacts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.438465Z", "completed_at": "2024-08-30T11:09:58.443072Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.443701Z", "completed_at": "2024-08-30T11:09:58.443708Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0066339969635009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contacts_contact_id.e28e88dce3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contacts\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.445688Z", "completed_at": "2024-08-30T11:09:58.449094Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.449596Z", "completed_at": "2024-08-30T11:09:58.449601Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005075216293334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contacts_contact_id.8f627121df", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contacts\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:57.805867Z", "completed_at": "2024-08-30T11:09:58.789348Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.789828Z", "completed_at": "2024-08-30T11:09:58.789835Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.0978810787200928, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_campaigns", "compiled": true, "compiled_code": "\n\n\nwith campaigns as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__email_campaign\"\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        email_campaign_id,\n        \n        sum(email_sends.bounces) as total_bounces,\n        count(distinct case when email_sends.bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(email_sends.clicks) as total_clicks,\n        count(distinct case when email_sends.clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(email_sends.deferrals) as total_deferrals,\n        count(distinct case when email_sends.deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(email_sends.deliveries) as total_deliveries,\n        count(distinct case when email_sends.deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(email_sends.drops) as total_drops,\n        count(distinct case when email_sends.drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(email_sends.forwards) as total_forwards,\n        count(distinct case when email_sends.forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(email_sends.opens) as total_opens,\n        count(distinct case when email_sends.opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(email_sends.prints) as total_prints,\n        count(distinct case when email_sends.prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(email_sends.spam_reports) as total_spam_reports,\n        count(distinct case when email_sends.spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(email_sends.unsubscribes) as total_unsubscribes,\n        count(distinct case when email_sends.unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), joined as (\n\n    select \n        campaigns.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from campaigns\n    left join email_metrics\n        on campaigns.email_campaign_id = email_metrics.email_campaign_id\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_campaigns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.904722Z", "completed_at": "2024-08-30T11:09:58.912043Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.912520Z", "completed_at": "2024-08-30T11:09:58.912527Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009511947631835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_campaigns_email_campaign_id.6b2d6f43c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.908536Z", "completed_at": "2024-08-30T11:09:58.913274Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:58.913678Z", "completed_at": "2024-08-30T11:09:58.913681Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010133028030395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_campaigns_email_campaign_id.2470fabe62", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.113096Z", "completed_at": "2024-08-30T11:09:59.170881Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:59.171527Z", "completed_at": "2024-08-30T11:09:59.171541Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1701161861419678, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__email_metrics__by_contact_list", "compiled": true, "compiled_code": "\n\nwith email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__email_sends\"\n\n), contact_list_member as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list_member\"\n\n), joined as (\n\n    select\n        email_sends.*,\n        contact_list_member.contact_list_id\n    from email_sends\n    left join contact_list_member\n        using (contact_id)\n    where contact_list_member.contact_list_id is not null\n\n), email_metrics as (\n    \n    select \n        contact_list_id,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from joined\n    group by 1\n\n)\n\nselect *\nfrom email_metrics", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__email_metrics__by_contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:59.300282Z", "completed_at": "2024-08-30T11:09:59.303729Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:59.305068Z", "completed_at": "2024-08-30T11:09:59.305079Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012700080871582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_metrics__by_contact_list_contact_list_id.095d72d5b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:59.294987Z", "completed_at": "2024-08-30T11:09:59.304036Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:59.305408Z", "completed_at": "2024-08-30T11:09:59.305412Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014327049255371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_metrics__by_contact_list_contact_list_id.1d3cf4caf2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:58.165541Z", "completed_at": "2024-08-30T11:09:59.221468Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:59.221944Z", "completed_at": "2024-08-30T11:09:59.221951Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1573939323425293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__scd_daily_ticket_history\"\n\n\n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\")\n\n-- If no issue fields have been updated since the last incremental run, the pivoted_daily_history CTE will return no record/rows.\n-- When this is the case, we need to grab the most recent day's records from the previously built table so that we can persist \n-- those values into the future.\n\n), most_recent_data as ( \n\n    select \n        *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\"\n    where date_day = (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\" )\n\n\n), calendar as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__ticket_calendar_spine\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\")\n    \n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__ticket_pipeline_stage\"\n\n), joined as (\n\n    select \n        calendar.date_day,\n        calendar.ticket_id\n            \n             \n            , coalesce(change_data.hs_pipeline, most_recent_data.hs_pipeline) as hs_pipeline\n             \n            , coalesce(change_data.hs_pipeline_stage, most_recent_data.hs_pipeline_stage) as hs_pipeline_stage\n            \n        \n        \n\n    from calendar\n    left join change_data\n        on calendar.ticket_id = change_data.ticket_id\n        and calendar.date_day = change_data.date_day\n    \n    \n    left join most_recent_data\n        on calendar.ticket_id = most_recent_data.ticket_id\n        and calendar.date_day = most_recent_data.date_day\n    \n\n), set_values as (\n\n    select \n        date_day,\n        ticket_id\n        \n        \n        , hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_partition\n        \n        , hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline_stage is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_stage_partition\n        \n\n    from joined\n\n), fill_values as (\n\n    select \n        date_day,\n        ticket_id\n\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n        \n\n    from set_values\n\n), fix_null_values as (\n\n    select \n        date_day,\n        ticket_id,\n        pipeline_stage.ticket_state,\n        pipeline.pipeline_label as hs_pipeline_label,\n        pipeline_stage.pipeline_stage_label as hs_pipeline_stage_label\n\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline as TEXT ) = 'is_null' then null else hs_pipeline end as hs_pipeline\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline_stage as TEXT ) = 'is_null' then null else hs_pipeline_stage end as hs_pipeline_stage\n        \n\n    from fill_values\n\n    left join pipeline \n        on cast(fill_values.hs_pipeline as integer) = pipeline.ticket_pipeline_id\n    left join pipeline_stage \n        on cast(fill_values.hs_pipeline_stage as integer) = pipeline_stage.ticket_pipeline_stage_id\n        and pipeline.ticket_pipeline_id = pipeline_stage.ticket_pipeline_id\n\n), surrogate as (\n\n    select\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as ticket_day_id,\n        *\n\n    from fix_null_values\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:59.323579Z", "completed_at": "2024-08-30T11:09:59.332293Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:59.332874Z", "completed_at": "2024-08-30T11:09:59.332880Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010258913040161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__daily_ticket_history_ticket_day_id.087496580e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_day_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:59.327993Z", "completed_at": "2024-08-30T11:09:59.333706Z"}, {"name": "execute", "started_at": "2024-08-30T11:09:59.334140Z", "completed_at": "2024-08-30T11:09:59.334144Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007113933563232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__daily_ticket_history_ticket_day_id.294440dc9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is not null\ngroup by ticket_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:09:59.283931Z", "completed_at": "2024-08-30T11:10:00.414210Z"}, {"name": "execute", "started_at": "2024-08-30T11:10:00.414697Z", "completed_at": "2024-08-30T11:10:00.414704Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.2387077808380127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_lists", "compiled": true, "compiled_code": "\n\nwith contact_lists as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"stg_hubspot__contact_list\"\n\n\n\n), email_metrics as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"int_hubspot__email_metrics__by_contact_list\"\n\n), joined as (\n    \n    select \n        contact_lists.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contact_lists\n    left join email_metrics\n        using (contact_list_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_lists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:10:00.524295Z", "completed_at": "2024-08-30T11:10:00.531698Z"}, {"name": "execute", "started_at": "2024-08-30T11:10:00.532279Z", "completed_at": "2024-08-30T11:10:00.532285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009659051895141602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_lists_contact_list_id.3bde1bb891", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_lists\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-30T11:10:00.528429Z", "completed_at": "2024-08-30T11:10:00.533203Z"}, {"name": "execute", "started_at": "2024-08-30T11:10:00.534007Z", "completed_at": "2024-08-30T11:10:00.534013Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006931304931640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_lists_contact_list_id.ea9ef03bac", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot_dev\".\"hubspot__contact_lists\" where not coalesce(is_contact_list_deleted, false)) dbt_subquery\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 34.74440407752991, "args": {"print": true, "which": "generate", "log_file_max_bytes": 10485760, "log_format": "default", "exclude": [], "invocation_command": "dbt docs generate -t postgres", "cache_selected_only": false, "macro_debugging": false, "vars": {}, "populate_cache": true, "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests/logs", "compile": true, "printer_width": 80, "indirect_selection": "eager", "empty_catalog": false, "partial_parse_file_diff": true, "defer": false, "static_parser": true, "partial_parse": true, "favor_state": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": false, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "target": "postgres", "static": false, "strict_mode": false, "profiles_dir": "/Users/avinash.kunnath/.dbt", "version_check": true, "show_resource_report": false, "enable_legacy_logger": false, "introspect": true, "log_format_file": "debug", "send_anonymous_usage_stats": true, "use_colors_file": true, "use_colors": true, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests", "quiet": false, "log_level": "info", "select": []}}