{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.14", "generated_at": "2024-05-11T05:43:30.094454Z", "invocation_id": "e62a36a6-24db-4000-b74d-aec82636c3f7", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:45.154079Z", "completed_at": "2024-05-11T05:42:46.589533Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:46.590191Z", "completed_at": "2024-05-11T05:42:46.590207Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5843720436096191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"name\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"company_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:45.222309Z", "completed_at": "2024-05-11T05:42:46.742103Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:46.743190Z", "completed_at": "2024-05-11T05:42:46.743200Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7280421257019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"deleteable\",\n  \"dynamic\",\n  \"metadata_error\",\n  \"metadata_last_processing_state_change_at\",\n  \"metadata_last_size_change_at\",\n  \"metadata_processing\",\n  \"metadata_size\",\n  \"offset\",\n  \"portal_id\",\n  \"updated_at\",\n  \"name\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_list_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:45.218107Z", "completed_at": "2024-05-11T05:42:46.775100Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:46.776479Z", "completed_at": "2024-05-11T05:42:46.776486Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7414889335632324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"contact_list_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"added_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_list_member_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list_member_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:45.210271Z", "completed_at": "2024-05-11T05:42:46.775516Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:46.776834Z", "completed_at": "2024-05-11T05:42:46.776838Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.743011236190796, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"is_deleted\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:46.736335Z", "completed_at": "2024-05-11T05:42:48.179192Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:48.179857Z", "completed_at": "2024-05-11T05:42:48.179864Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5899980068206787, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"value\",\n  \"source_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:46.883002Z", "completed_at": "2024-05-11T05:42:48.352053Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:48.354134Z", "completed_at": "2024-05-11T05:42:48.354138Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6102430820465088, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_email\",\n  \"id\",\n  \"property_company\",\n  \"property_firstname\",\n  \"property_lastname\",\n  \"property_email_1\",\n  \"property_createdate\",\n  \"property_jobtitle\",\n  \"property_annualrevenue\",\n  \"property_hs_calculated_merged_vids\",\n  \"property_created_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:46.904822Z", "completed_at": "2024-05-11T05:42:48.351693Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:48.353732Z", "completed_at": "2024-05-11T05:42:48.353736Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5963761806488037, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"deal_id\",\n  \"_fivetran_synced\",\n  \"type_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:46.897811Z", "completed_at": "2024-05-11T05:42:48.351269Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:48.353290Z", "completed_at": "2024-05-11T05:42:48.353299Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.597740888595581, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"deal_id\",\n  \"type_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:48.328668Z", "completed_at": "2024-05-11T05:42:49.694255Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:49.694820Z", "completed_at": "2024-05-11T05:42:49.694829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5280492305755615, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"closed_won\",\n  \"display_order\",\n  \"probability\",\n  \"stage_id\",\n  \"label\",\n  \"pipeline_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_pipeline_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:48.507137Z", "completed_at": "2024-05-11T05:42:49.894657Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:49.895118Z", "completed_at": "2024-05-11T05:42:49.895121Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5137720108032227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"deal_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"date_entered\",\n  \"source\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:48.497262Z", "completed_at": "2024-05-11T05:42:49.893714Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:49.894221Z", "completed_at": "2024-05-11T05:42:49.894225Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5210120677947998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_pipeline_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:48.501938Z", "completed_at": "2024-05-11T05:42:49.881054Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:49.881525Z", "completed_at": "2024-05-11T05:42:49.881531Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5209908485412598, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"timestamp\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"name\",\n  \"source_id\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:49.858985Z", "completed_at": "2024-05-11T05:42:51.018430Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:51.019163Z", "completed_at": "2024-05-11T05:42:51.019172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2958803176879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"owner_id\",\n  \"deal_pipeline_id\",\n  \"deal_pipeline_stage_id\",\n  \"is_deleted\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:50.024289Z", "completed_at": "2024-05-11T05:42:51.251824Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:51.259332Z", "completed_at": "2024-05-11T05:42:51.259341Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3912298679351807, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"referer\",\n  \"browser\",\n  \"location\",\n  \"ip_address\",\n  \"url\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_click_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_click_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:50.011246Z", "completed_at": "2024-05-11T05:42:51.254884Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:51.264611Z", "completed_at": "2024-05-11T05:42:51.264618Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.4002199172973633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"content_id\",\n  \"num_included\",\n  \"num_queued\",\n  \"sub_type\",\n  \"type\",\n  \"app_name\",\n  \"name\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_campaign_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:50.019625Z", "completed_at": "2024-05-11T05:42:51.258704Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:51.264928Z", "completed_at": "2024-05-11T05:42:51.264931Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3930511474609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"category\",\n  \"status\",\n  \"response\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_bounce_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_bounce_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:51.155403Z", "completed_at": "2024-05-11T05:42:52.979190Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:52.980409Z", "completed_at": "2024-05-11T05:42:52.980428Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.1518399715423584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"attempt\",\n  \"response\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_deferred_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_deferred_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:51.421165Z", "completed_at": "2024-05-11T05:42:53.623685Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:53.624214Z", "completed_at": "2024-05-11T05:42:53.624222Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.315519094467163, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"drop_reason\",\n  \"bcc\",\n  \"cc\",\n  \"drop_message\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_dropped_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_dropped_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:51.426383Z", "completed_at": "2024-05-11T05:42:53.624967Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:53.625945Z", "completed_at": "2024-05-11T05:42:53.625948Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.349053144454956, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_forward_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_forward_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:51.414400Z", "completed_at": "2024-05-11T05:42:53.624457Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:53.625693Z", "completed_at": "2024-05-11T05:42:53.625696Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.3573498725891113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"response\",\n  \"smtp_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_delivered_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_delivered_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:53.307357Z", "completed_at": "2024-05-11T05:42:55.234802Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:55.235574Z", "completed_at": "2024-05-11T05:42:55.235592Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.068336009979248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"duration\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_open_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_open_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:53.764111Z", "completed_at": "2024-05-11T05:42:55.548211Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:55.548936Z", "completed_at": "2024-05-11T05:42:55.548949Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.9205868244171143, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bcc\",\n  \"cc\",\n  \"from\",\n  \"reply_to\",\n  \"subject\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_sent_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_sent_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:53.733489Z", "completed_at": "2024-05-11T05:42:55.593031Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:55.593802Z", "completed_at": "2024-05-11T05:42:55.593809Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.9704902172088623, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"browser\",\n  \"ip_address\",\n  \"location\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_print_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_print_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:53.771306Z", "completed_at": "2024-05-11T05:42:55.593517Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:55.594509Z", "completed_at": "2024-05-11T05:42:55.594512Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.942859172821045, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"ip_address\",\n  \"user_agent\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_spam_report_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_spam_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:55.378501Z", "completed_at": "2024-05-11T05:42:56.818877Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:56.820567Z", "completed_at": "2024-05-11T05:42:56.820671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6165430545806885, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"bounced\",\n  \"portal_subscription_status\",\n  \"requested_by\",\n  \"source\",\n  \"subscriptions\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_status_change_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_status_change_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:55.686059Z", "completed_at": "2024-05-11T05:42:57.187145Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:57.188079Z", "completed_at": "2024-05-11T05:42:57.188087Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6318261623382568, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"_fivetran_synced\",\n  \"app_id\",\n  \"caused_by_created\",\n  \"caused_by_id\",\n  \"created\",\n  \"email_campaign_id\",\n  \"obsoleted_by_created\",\n  \"obsoleted_by_id\",\n  \"portal_id\",\n  \"sent_by_created\",\n  \"sent_by_id\",\n  \"type\",\n  \"filtered_event\",\n  \"recipient\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"email_event_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:55.704149Z", "completed_at": "2024-05-11T05:42:57.187756Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:57.188823Z", "completed_at": "2024-05-11T05:42:57.188827Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6153349876403809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_timestamp\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_call_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_call_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:55.715005Z", "completed_at": "2024-05-11T05:42:57.297607Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:57.298085Z", "completed_at": "2024-05-11T05:42:57.298092Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6738648414611816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"company_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:56.998725Z", "completed_at": "2024-05-11T05:42:58.587263Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:58.587771Z", "completed_at": "2024-05-11T05:42:58.587777Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7364528179168701, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"contact_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:57.320857Z", "completed_at": "2024-05-11T05:42:58.736126Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:58.737647Z", "completed_at": "2024-05-11T05:42:58.737653Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.571537733078003, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal_tmp", "compiled": true, "compiled_code": "\n\nselect \"deal_id\",\n  \"engagement_id\",\n  \"engagement_type\",\n  \"type_id\",\n  \"_fivetran_synced\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_deal_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_deal_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:57.389832Z", "completed_at": "2024-05-11T05:42:58.908559Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:58.910149Z", "completed_at": "2024-05-11T05:42:58.910153Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6597039699554443, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_synced\",\n  \"created_from_link_id\",\n  \"end_time\",\n  \"pre_meeting_prospect_reminders\",\n  \"source\",\n  \"source_id\",\n  \"start_time\",\n  \"web_conference_meeting_id\",\n  \"meeting_outcome\",\n  \"body\",\n  \"external_url\",\n  \"title\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_meeting_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_meeting_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:57.326757Z", "completed_at": "2024-05-11T05:42:58.908073Z"}, {"name": "execute", "started_at": "2024-05-11T05:42:58.909730Z", "completed_at": "2024-05-11T05:42:58.909739Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7298800945281982, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_all_owner_ids\",\n  \"property_hs_all_team_ids\",\n  \"property_hs_createdate\",\n  \"property_hs_email_subject\",\n  \"property_hs_email_text\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_modified_by\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_email_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_email_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:58.738034Z", "completed_at": "2024-05-11T05:43:00.273833Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:00.274468Z", "completed_at": "2024-05-11T05:43:00.274476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7395038604736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_body_preview\",\n  \"property_hs_createdate\",\n  \"property_hs_lastmodifieddate\",\n  \"property_hs_note_body\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_note_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_note_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:58.893464Z", "completed_at": "2024-05-11T05:43:00.502298Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:00.503214Z", "completed_at": "2024-05-11T05:43:00.503223Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7938201427459717, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task_tmp", "compiled": true, "compiled_code": "\n\nselect \"engagement_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"property_hs_createdate\",\n  \"property_hs_object_id\",\n  \"property_hs_task_type\",\n  \"property_hs_timestamp\",\n  \"property_hubspot_owner_id\",\n  \"property_hubspot_team_id\",\n  \"type\",\n  \"task_type\",\n  \"property_hs_engagement_source\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_task_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_task_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:59.059805Z", "completed_at": "2024-05-11T05:43:00.688794Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:00.698552Z", "completed_at": "2024-05-11T05:43:00.698565Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.8765349388122559, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner_tmp", "compiled": true, "compiled_code": "\n\nselect \"owner_id\",\n  \"_fivetran_synced\",\n  \"created_at\",\n  \"portal_id\",\n  \"type\",\n  \"updated_at\",\n  \"email\",\n  \"first_name\",\n  \"last_name\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"owner_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__owner_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:42:59.053288Z", "completed_at": "2024-05-11T05:43:00.963037Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:00.964011Z", "completed_at": "2024-05-11T05:43:00.964025Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.0899572372436523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"id\",\n  \"type\",\n  \"_fivetran_synced\",\n  \"portal_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"engagement_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:00.689908Z", "completed_at": "2024-05-11T05:43:02.221796Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:02.222485Z", "completed_at": "2024-05-11T05:43:02.222491Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6565496921539307, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_id\",\n  \"_fivetran_synced\",\n  \"calculated\",\n  \"created_at\",\n  \"description\",\n  \"field_type\",\n  \"group_name\",\n  \"hubspot_defined\",\n  \"hubspot_object\",\n  \"label\",\n  \"name\",\n  \"show_currency_symbol\",\n  \"type\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"property_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:00.479173Z", "completed_at": "2024-05-11T05:43:02.208071Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:02.208695Z", "completed_at": "2024-05-11T05:43:02.208707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8676033020019531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option_tmp", "compiled": true, "compiled_code": "\n\nselect \"label\",\n  \"property_id\",\n  \"_fivetran_synced\",\n  \"display_order\",\n  \"hidden\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"property_option_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property_option_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:00.932856Z", "completed_at": "2024-05-11T05:43:02.361760Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:02.362363Z", "completed_at": "2024-05-11T05:43:02.362375Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5612359046936035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"company_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_company_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_company_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:01.145936Z", "completed_at": "2024-05-11T05:43:02.505300Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:02.506099Z", "completed_at": "2024-05-11T05:43:02.506108Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5315639972686768, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"contact_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_contact_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_contact_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:02.347604Z", "completed_at": "2024-05-11T05:43:03.638806Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.640046Z", "completed_at": "2024-05-11T05:43:03.640053Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5056939125061035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"ticket_id\",\n  \"engagement_id\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_engagement_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_engagement_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:02.353253Z", "completed_at": "2024-05-11T05:43:03.639176Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.640342Z", "completed_at": "2024-05-11T05:43:03.640346Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5198190212249756, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage_tmp", "compiled": true, "compiled_code": "\n\nselect \"stage_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"is_closed\",\n  \"label\",\n  \"pipeline_id\",\n  \"ticket_state\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_pipeline_stage_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.868780Z", "completed_at": "2024-05-11T05:43:03.870364Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.870921Z", "completed_at": "2024-05-11T05:43:03.870926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033638477325439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.872874Z", "completed_at": "2024-05-11T05:43:03.874190Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.874861Z", "completed_at": "2024-05-11T05:43:03.874865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032749176025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.company_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.876703Z", "completed_at": "2024-05-11T05:43:03.878772Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.879332Z", "completed_at": "2024-05-11T05:43:03.879336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037839412689208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.881183Z", "completed_at": "2024-05-11T05:43:03.882462Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.883256Z", "completed_at": "2024-05-11T05:43:03.883261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033380985260009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.885397Z", "completed_at": "2024-05-11T05:43:03.886735Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.887299Z", "completed_at": "2024-05-11T05:43:03.887304Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031599998474121094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_list_member_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.889093Z", "completed_at": "2024-05-11T05:43:03.890331Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.890879Z", "completed_at": "2024-05-11T05:43:03.890884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029630661010742188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_merge_audit_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.892688Z", "completed_at": "2024-05-11T05:43:03.893983Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.894526Z", "completed_at": "2024-05-11T05:43:03.894529Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029768943786621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.contact_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.896279Z", "completed_at": "2024-05-11T05:43:03.897507Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.898048Z", "completed_at": "2024-05-11T05:43:03.898052Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037789344787597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.900730Z", "completed_at": "2024-05-11T05:43:03.901868Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.902359Z", "completed_at": "2024-05-11T05:43:03.902363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027010440826416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.903944Z", "completed_at": "2024-05-11T05:43:03.905022Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.905503Z", "completed_at": "2024-05-11T05:43:03.905507Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002557039260864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.907083Z", "completed_at": "2024-05-11T05:43:03.908225Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.908732Z", "completed_at": "2024-05-11T05:43:03.908736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002676248550415039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.910364Z", "completed_at": "2024-05-11T05:43:03.911468Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.911909Z", "completed_at": "2024-05-11T05:43:03.911912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025479793548583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.913448Z", "completed_at": "2024-05-11T05:43:03.914429Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.914913Z", "completed_at": "2024-05-11T05:43:03.914917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025260448455810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.916549Z", "completed_at": "2024-05-11T05:43:03.918312Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.918771Z", "completed_at": "2024-05-11T05:43:03.918775Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032410621643066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.deal_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.920246Z", "completed_at": "2024-05-11T05:43:03.921248Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.921665Z", "completed_at": "2024-05-11T05:43:03.921667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002332925796508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_campaign_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.923040Z", "completed_at": "2024-05-11T05:43:03.924009Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.924439Z", "completed_at": "2024-05-11T05:43:03.924442Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0022950172424316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_bounce_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.925839Z", "completed_at": "2024-05-11T05:43:03.926864Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.927311Z", "completed_at": "2024-05-11T05:43:03.927314Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023789405822753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_click_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.928732Z", "completed_at": "2024-05-11T05:43:03.929701Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.930125Z", "completed_at": "2024-05-11T05:43:03.930128Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002299070358276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.931532Z", "completed_at": "2024-05-11T05:43:03.933194Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.933654Z", "completed_at": "2024-05-11T05:43:03.933657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030279159545898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_deferred_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.934985Z", "completed_at": "2024-05-11T05:43:03.989546Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.991903Z", "completed_at": "2024-05-11T05:43:03.991910Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.058541059494018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_delivered_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.994185Z", "completed_at": "2024-05-11T05:43:03.995223Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.995705Z", "completed_at": "2024-05-11T05:43:03.995709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026950836181640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_dropped_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.998146Z", "completed_at": "2024-05-11T05:43:03.999207Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.999759Z", "completed_at": "2024-05-11T05:43:03.999763Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029401779174804688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_forward_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:02.494231Z", "completed_at": "2024-05-11T05:43:03.853863Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.865012Z", "completed_at": "2024-05-11T05:43:03.865022Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.508349895477295, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_tmp", "compiled": true, "compiled_code": "\n\nselect \"pipeline_id\",\n  \"_fivetran_deleted\",\n  \"_fivetran_synced\",\n  \"active\",\n  \"display_order\",\n  \"label\",\n  \"object_type_id\",\n  \"created_at\",\n  \"updated_at\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_pipeline_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.002578Z", "completed_at": "2024-05-11T05:43:04.003712Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.005087Z", "completed_at": "2024-05-11T05:43:04.005097Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005978107452392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_open_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.005384Z", "completed_at": "2024-05-11T05:43:04.006553Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.007917Z", "completed_at": "2024-05-11T05:43:04.007924Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004767894744873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_print_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.009576Z", "completed_at": "2024-05-11T05:43:04.011532Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.012803Z", "completed_at": "2024-05-11T05:43:04.012807Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006246089935302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_sent_data_postgres", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.013044Z", "completed_at": "2024-05-11T05:43:04.014095Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.015306Z", "completed_at": "2024-05-11T05:43:04.015313Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00482630729675293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_spam_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.017498Z", "completed_at": "2024-05-11T05:43:04.018667Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.019861Z", "completed_at": "2024-05-11T05:43:04.019864Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00577998161315918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.email_event_status_change_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.020088Z", "completed_at": "2024-05-11T05:43:04.021045Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.022148Z", "completed_at": "2024-05-11T05:43:04.022152Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0039730072021484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_call_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.023908Z", "completed_at": "2024-05-11T05:43:04.024841Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.025800Z", "completed_at": "2024-05-11T05:43:04.025803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0056781768798828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.026016Z", "completed_at": "2024-05-11T05:43:04.027690Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.029204Z", "completed_at": "2024-05-11T05:43:04.029209Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004885196685791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.030791Z", "completed_at": "2024-05-11T05:43:04.031829Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.032903Z", "completed_at": "2024-05-11T05:43:04.032908Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004961967468261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.033140Z", "completed_at": "2024-05-11T05:43:04.034056Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.035126Z", "completed_at": "2024-05-11T05:43:04.035129Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003710031509399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.036453Z", "completed_at": "2024-05-11T05:43:04.037422Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.038358Z", "completed_at": "2024-05-11T05:43:04.038361Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004642009735107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_email_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.038571Z", "completed_at": "2024-05-11T05:43:04.039460Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.040981Z", "completed_at": "2024-05-11T05:43:04.040985Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004196882247924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_meeting_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.042653Z", "completed_at": "2024-05-11T05:43:04.043809Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.044863Z", "completed_at": "2024-05-11T05:43:04.044868Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0063440799713134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_note_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.045083Z", "completed_at": "2024-05-11T05:43:04.047104Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.048411Z", "completed_at": "2024-05-11T05:43:04.048416Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005079984664916992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.engagement_task_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.049920Z", "completed_at": "2024-05-11T05:43:04.050898Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.051927Z", "completed_at": "2024-05-11T05:43:04.051930Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004745960235595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.merged_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.052145Z", "completed_at": "2024-05-11T05:43:04.053050Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.054100Z", "completed_at": "2024-05-11T05:43:04.054104Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003626585006713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.owner_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.055443Z", "completed_at": "2024-05-11T05:43:04.056436Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.057539Z", "completed_at": "2024-05-11T05:43:04.057543Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0049169063568115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.057772Z", "completed_at": "2024-05-11T05:43:04.058825Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.059908Z", "completed_at": "2024-05-11T05:43:04.059911Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.003932952880859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.property_option_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.061375Z", "completed_at": "2024-05-11T05:43:04.063106Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.064098Z", "completed_at": "2024-05-11T05:43:04.064101Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005505084991455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_company_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.064316Z", "completed_at": "2024-05-11T05:43:04.065281Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.066347Z", "completed_at": "2024-05-11T05:43:04.066350Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0036628246307373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_contact_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.067698Z", "completed_at": "2024-05-11T05:43:04.068635Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.069547Z", "completed_at": "2024-05-11T05:43:04.069550Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00444483757019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.069758Z", "completed_at": "2024-05-11T05:43:04.070649Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.071672Z", "completed_at": "2024-05-11T05:43:04.071675Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0034961700439453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_deal_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.073060Z", "completed_at": "2024-05-11T05:43:04.074073Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.075099Z", "completed_at": "2024-05-11T05:43:04.075103Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005571126937866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_engagement_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.075308Z", "completed_at": "2024-05-11T05:43:04.077062Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.078156Z", "completed_at": "2024-05-11T05:43:04.078159Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00448298454284668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.079511Z", "completed_at": "2024-05-11T05:43:04.080473Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.081492Z", "completed_at": "2024-05-11T05:43:04.081496Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004837751388549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_pipeline_stage_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.081715Z", "completed_at": "2024-05-11T05:43:04.082752Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:04.083954Z", "completed_at": "2024-05-11T05:43:04.083957Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004019975662231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.hubspot_integration_tests.ticket_property_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:02.678607Z", "completed_at": "2024-05-11T05:43:03.995930Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:03.997032Z", "completed_at": "2024-05-11T05:43:03.997034Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4263510704040527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_start\",\n  \"name\",\n  \"ticket_id\",\n  \"_fivetran_active\",\n  \"_fivetran_end\",\n  \"_fivetran_synced\",\n  \"source\",\n  \"source_id\",\n  \"timestamp_instant\",\n  \"value\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_property_history_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_property_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:03.855728Z", "completed_at": "2024-05-11T05:43:05.773064Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:05.774431Z", "completed_at": "2024-05-11T05:43:05.774444Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.0670928955078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_tmp", "compiled": true, "compiled_code": "\n\nselect \"_fivetran_synced\",\n  \"id\",\n  \"is_deleted\",\n  \"property_closed_date\",\n  \"property_createdate\",\n  \"property_first_agent_reply_date\",\n  \"property_hs_pipeline\",\n  \"property_hs_pipeline_stage\",\n  \"property_hs_ticket_category\",\n  \"property_hs_ticket_priority\",\n  \"property_hubspot_owner_id\",\n  \"property_subject\",\n  \"property_content\"\nfrom \"postgres\".\"hubspot_integration_tests_57\".\"ticket_data\"", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.090622Z", "completed_at": "2024-05-11T05:43:06.302568Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:06.304381Z", "completed_at": "2024-05-11T05:43:06.304384Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.3135697841644287, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    deleteable\n    \n as \n    \n    deleteable\n    \n, \n    \n    \n    dynamic\n    \n as \n    \n    dynamic\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metadata_error\n    \n as \n    \n    metadata_error\n    \n, \n    \n    \n    metadata_last_processing_state_change_at\n    \n as \n    \n    metadata_last_processing_state_change_at\n    \n, \n    \n    \n    metadata_last_size_change_at\n    \n as \n    \n    metadata_last_size_change_at\n    \n, \n    \n    \n    metadata_processing\n    \n as \n    \n    metadata_processing\n    \n, \n    \n    \n    metadata_size\n    \n as \n    \n    metadata_size\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        deleteable as is_deletable,\n        dynamic as is_dynamic,\n        id as contact_list_id,\n        metadata_error,\n        cast(metadata_last_processing_state_change_at as timestamp) as metadata_last_processing_state_change_at,\n        cast(metadata_last_size_change_at as timestamp) as metadata_last_size_change_at,\n        metadata_processing,\n        metadata_size,\n        name as contact_list_name,\n        portal_id,\n        cast(updated_at as timestamp) as updated_timestamp\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.104924Z", "completed_at": "2024-05-11T05:43:06.302221Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:06.304068Z", "completed_at": "2024-05-11T05:43:06.304072Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.314384937286377, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_list_member", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list_member_tmp\" \n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    added_at\n    \n as \n    \n    added_at\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    contact_list_id\n    \n as \n    \n    contact_list_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_contact_list_member_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(added_at as timestamp) as added_timestamp,\n        contact_id,\n        contact_list_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list_member\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:04.085472Z", "completed_at": "2024-05-11T05:43:06.301814Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:06.303743Z", "completed_at": "2024-05-11T05:43:06.303751Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.346573829650879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_company_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:05.924916Z", "completed_at": "2024-05-11T05:43:07.569102Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:07.569772Z", "completed_at": "2024-05-11T05:43:07.569780Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7604279518127441, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    id\n    \n as company_id , \n    \n    \n    is_deleted\n    \n as is_company_deleted , \n    cast(null as TEXT) as company_name , \n    cast(null as TEXT) as description , \n    cast(null as timestamp) as created_date , \n    cast(null as TEXT) as industry , \n    cast(null as TEXT) as street_address , \n    cast(null as TEXT) as street_address_2 , \n    cast(null as TEXT) as city , \n    cast(null as TEXT) as state , \n    cast(null as TEXT) as country , \n    cast(null as integer) as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_company_columns.sql macro\n        company_id,\n        is_company_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        company_name,\n        description,\n        created_date,\n        industry,\n        street_address,\n        street_address_2,\n        city,\n        state,\n        country,\n        company_annual_revenue\n        \n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__company_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:06.432606Z", "completed_at": "2024-05-11T05:43:08.139560Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:08.141429Z", "completed_at": "2024-05-11T05:43:08.141433Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8343141078948975, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_company_tmp\"\n\n), macro as (\n\n    select \n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        company_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:06.420460Z", "completed_at": "2024-05-11T05:43:08.139913Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:08.141760Z", "completed_at": "2024-05-11T05:43:08.141765Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8471870422363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as is_contact_deleted , \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as contact_id , \n    \n    \n    property_hs_calculated_merged_vids\n    \n as calculated_merged_vids , \n    \n    \n    property_email\n    \n as email , \n    \n    \n    property_company\n    \n as contact_company , \n    \n    \n    property_firstname\n    \n as first_name , \n    \n    \n    property_lastname\n    \n as last_name , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_jobtitle\n    \n as job_title , \n    \n    \n    property_annualrevenue\n    \n as company_annual_revenue \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns.\n        -- a few columns below are aliased within the macros/get_contact_columns.sql macro\n        contact_id,\n        is_contact_deleted,\n        calculated_merged_vids, -- will be null for BigQuery users until v3 api is rolled out to them\n        email,\n        contact_company,\n        first_name,\n        last_name,\n        cast(created_date as timestamp) as created_date,\n        job_title,\n        company_annual_revenue,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n\n        --The below macro adds the fields defined within your hubspot__contact_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__contact_calculated_fields variable.\n        \n\n\n\n    from macro\n    \n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:06.405514Z", "completed_at": "2024-05-11T05:43:08.139119Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:08.141097Z", "completed_at": "2024-05-11T05:43:08.141108Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.8634607791900635, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__contact_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        contact_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_contact_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:07.687503Z", "completed_at": "2024-05-11T05:43:09.318892Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:09.321647Z", "completed_at": "2024-05-11T05:43:09.321673Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.7623732089996338, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_contact_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    type_id\n    \n as \n    \n    type_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        contact_id,\n        deal_id,\n        type_id,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced\n        \n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:08.279453Z", "completed_at": "2024-05-11T05:43:09.800899Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:09.801587Z", "completed_at": "2024-05-11T05:43:09.801608Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6508958339691162, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_active\n    \n as \n    \n    _fivetran_active\n    \n, \n    \n    \n    _fivetran_end\n    \n as \n    \n    _fivetran_end\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    date_entered\n    \n as \n    \n    date_entered\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date_entered as timestamp) as date_entered,\n        deal_id,\n        source,\n        source_id,\n        value as deal_stage_name,\n        _fivetran_active,\n        cast(_fivetran_end as timestamp) as _fivetran_end,\n        cast(_fivetran_start as timestamp) as _fivetran_start\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:08.270950Z", "completed_at": "2024-05-11T05:43:09.803009Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:09.803421Z", "completed_at": "2024-05-11T05:43:09.803427Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6580862998962402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage_tmp\"\n\n), macro as (\n\n    select \n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    closed_won\n    \n as \n    \n    closed_won\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    probability\n    \n as \n    \n    probability\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        closed_won as is_closed_won,\n        display_order,\n        label as pipeline_stage_label,\n        pipeline_id as deal_pipeline_id,\n        probability,\n        cast(stage_id as TEXT) as deal_pipeline_stage_id,\n        created_at as deal_pipeline_stage_created_at,\n        updated_at as deal_pipeline_stage_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:08.287296Z", "completed_at": "2024-05-11T05:43:09.802127Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:09.802593Z", "completed_at": "2024-05-11T05:43:09.802597Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6579489707946777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_deleted as is_deal_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        cast(pipeline_id as TEXT) as deal_pipeline_id,\n        created_at as deal_pipeline_created_at,\n        updated_at as deal_pipeline_updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:09.452958Z", "completed_at": "2024-05-11T05:43:10.833880Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:10.834743Z", "completed_at": "2024-05-11T05:43:10.834751Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5114319324493408, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    source_id\n    \n as \n    \n    source_id\n    \n, \n    \n    \n    timestamp\n    \n as change_timestamp , \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        name as field_name,\n        source as change_source,\n        source_id as change_source_id,\n        cast(change_timestamp as timestamp) as change_timestamp, -- source field name = timestamp ; alias declared in macros/get_deal_property_history_columns.sql\n        value as new_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:09.938562Z", "completed_at": "2024-05-11T05:43:11.248931Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:11.249796Z", "completed_at": "2024-05-11T05:43:11.249816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4158847332000732, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_click", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_click_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    referer\n    \n as \n    \n    referer\n    \n, \n    \n    \n    url\n    \n as \n    \n    url\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        referer as referer_url,\n        url as click_url,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_click\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:09.928599Z", "completed_at": "2024-05-11T05:43:11.250231Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:11.251808Z", "completed_at": "2024-05-11T05:43:11.251813Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4400818347930908, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_tmp\"\n\n), macro as (\n\n    select\n        \n    cast(null as timestamp) as \n    \n    _fivetran_synced\n    \n , \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    deal_pipeline_id\n    \n as \n    \n    deal_pipeline_id\n    \n, \n    \n    \n    deal_pipeline_stage_id\n    \n as \n    \n    deal_pipeline_stage_id\n    \n, \n    \n    \n    is_deleted\n    \n as is_deal_deleted , \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    cast(null as integer) as \n    \n    portal_id\n    \n , \n    cast(null as TEXT) as deal_name , \n    cast(null as TEXT) as description , \n    cast(null as integer) as amount , \n    cast(null as timestamp) as closed_date , \n    cast(null as timestamp) as created_date \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_deal_columns.sql macro\n        deal_name,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        is_deal_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        deal_id,\n        cast(deal_pipeline_id as TEXT) as deal_pipeline_id,\n        cast(deal_pipeline_stage_id as TEXT) as deal_pipeline_stage_id,\n        owner_id,\n        portal_id,\n        description,\n        amount\n\n        --The below macro adds the fields defined within your hubspot__deal_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__deal_calculated_fields variable.\n        \n\n\n\n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:09.943977Z", "completed_at": "2024-05-11T05:43:11.250909Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:11.252154Z", "completed_at": "2024-05-11T05:43:11.252158Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.427422046661377, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_campaign", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_campaign_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    content_id\n    \n as \n    \n    content_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    num_included\n    \n as \n    \n    num_included\n    \n, \n    \n    \n    num_queued\n    \n as \n    \n    num_queued\n    \n, \n    \n    \n    sub_type\n    \n as \n    \n    sub_type\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        app_name,\n        content_id,\n        id as email_campaign_id,\n        name as email_campaign_name,\n        num_included,\n        num_queued,\n        sub_type as email_campaign_sub_type,\n        subject as email_campaign_subject,\n        type as email_campaign_type\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:10.965938Z", "completed_at": "2024-05-11T05:43:12.193313Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:12.193931Z", "completed_at": "2024-05-11T05:43:12.193938Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3926050662994385, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_bounce_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    category\n    \n as \n    \n    category\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n\n\n\n    from base\n    \n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        category as bounce_category,\n        id as event_id,\n        response as returned_response,\n        status as returned_status\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:11.355110Z", "completed_at": "2024-05-11T05:43:12.516691Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:12.517693Z", "completed_at": "2024-05-11T05:43:12.517709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2974131107330322, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_deferred_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    attempt\n    \n as \n    \n    attempt\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        attempt as attempt_number,\n        id as event_id,\n        response as returned_response\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:11.374626Z", "completed_at": "2024-05-11T05:43:12.685290Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:12.686256Z", "completed_at": "2024-05-11T05:43:12.686261Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.4597582817077637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_forward_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:11.368324Z", "completed_at": "2024-05-11T05:43:12.684322Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:12.684971Z", "completed_at": "2024-05-11T05:43:12.684979Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4608891010284424, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_dropped_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    drop_message\n    \n as \n    \n    drop_message\n    \n, \n    \n    \n    drop_reason\n    \n as \n    \n    drop_reason\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        drop_message,\n        drop_reason,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_dropped_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:12.360442Z", "completed_at": "2024-05-11T05:43:13.629293Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:13.629959Z", "completed_at": "2024-05-11T05:43:13.629966Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4117870330810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_delivered_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    response\n    \n as \n    \n    response\n    \n, \n    \n    \n    smtp_id\n    \n as \n    \n    smtp_id\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        response as returned_response,\n        smtp_id\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:12.655692Z", "completed_at": "2024-05-11T05:43:14.180013Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:14.180513Z", "completed_at": "2024-05-11T05:43:14.180519Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6166789531707764, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_open", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_open_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    duration\n    \n as \n    \n    duration\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        duration as duration_open,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_open\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:12.831424Z", "completed_at": "2024-05-11T05:43:14.298264Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:14.299364Z", "completed_at": "2024-05-11T05:43:14.299372Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5834150314331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_sent_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bcc\n    \n as \n    \n    bcc\n    \n, \n    \n    \n    cc\n    \n as \n    \n    cc\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    reply_to\n    \n as \n    \n    reply_to\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n        \n            \n            \"from\"\n            \n        \n    \n as from_email \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bcc as bcc_emails,\n        cc as cc_emails,\n        from_email, -- source field name = from ; alias declared in macros/get_email_event_sent_columns.sql\n        id as event_id,\n        reply_to as reply_to_email,\n        subject as email_subject\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:12.839426Z", "completed_at": "2024-05-11T05:43:14.298589Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:14.299643Z", "completed_at": "2024-05-11T05:43:14.299647Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.6747970581054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_print", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_print_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    browser\n    \n as \n    \n    browser\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    location\n    \n as \n    \n    location\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        browser,\n        id as event_id,\n        ip_address,\n        location as geo_location,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:13.772731Z", "completed_at": "2024-05-11T05:43:15.079257Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:15.079751Z", "completed_at": "2024-05-11T05:43:15.079759Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4383139610290527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_spam_report_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ip_address\n    \n as \n    \n    ip_address\n    \n, \n    \n    \n    user_agent\n    \n as \n    \n    user_agent\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as event_id,\n        ip_address,\n        user_agent\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:14.272414Z", "completed_at": "2024-05-11T05:43:15.469202Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:15.469887Z", "completed_at": "2024-05-11T05:43:15.469898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3403210639953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_status_change_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    bounced\n    \n as \n    \n    bounced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    portal_subscription_status\n    \n as \n    \n    portal_subscription_status\n    \n, \n    \n    \n    requested_by\n    \n as \n    \n    requested_by\n    \n, \n    \n    \n    source\n    \n as \n    \n    source\n    \n, \n    \n    \n    subscriptions\n    \n as \n    \n    subscriptions\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        bounced as is_bounced,\n        id as event_id,\n        portal_subscription_status as subscription_status,\n        requested_by as requested_by_email,\n        source as change_source,\n        subscriptions\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:14.507783Z", "completed_at": "2024-05-11T05:43:15.765279Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:15.766555Z", "completed_at": "2024-05-11T05:43:15.766558Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.4123351573944092, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_call", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_call_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_call\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:14.416092Z", "completed_at": "2024-05-11T05:43:15.764871Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:15.766227Z", "completed_at": "2024-05-11T05:43:15.766235Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.504746913909912, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__email_event", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    caused_by_created\n    \n as \n    \n    caused_by_created\n    \n, \n    \n    \n    caused_by_id\n    \n as \n    \n    caused_by_id\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_campaign_id\n    \n as \n    \n    email_campaign_id\n    \n, \n    \n    \n    filtered_event\n    \n as \n    \n    filtered_event\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    obsoleted_by_created\n    \n as \n    \n    obsoleted_by_created\n    \n, \n    \n    \n    obsoleted_by_id\n    \n as \n    \n    obsoleted_by_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    recipient\n    \n as \n    \n    recipient\n    \n, \n    \n    \n    sent_by_created\n    \n as \n    \n    sent_by_created\n    \n, \n    \n    \n    sent_by_id\n    \n as \n    \n    sent_by_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        app_id,\n        cast(caused_by_created as timestamp) as caused_timestamp,\n        caused_by_id as caused_by_event_id,\n        cast(created as timestamp) as created_timestamp,\n        email_campaign_id,\n        filtered_event as is_filtered_event,\n        id as event_id,\n        cast(obsoleted_by_created as timestamp) as obsoleted_timestamp,\n        obsoleted_by_id as obsoleted_by_event_id,\n        portal_id,\n        recipient as recipient_email_address,\n        cast(sent_by_created as timestamp) as sent_timestamp,\n        sent_by_id as sent_by_event_id,\n        type as event_type\n    from macro\n    \n)\n\nselect *\nfrom fields\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:15.213374Z", "completed_at": "2024-05-11T05:43:16.468425Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:16.469446Z", "completed_at": "2024-05-11T05:43:16.469462Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.381775140762329, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_company_tmp\"\n\n), macro as (\n\n    select \n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:15.614418Z", "completed_at": "2024-05-11T05:43:17.036060Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:17.036519Z", "completed_at": "2024-05-11T05:43:17.036526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5965168476104736, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:15.932718Z", "completed_at": "2024-05-11T05:43:17.524563Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:17.525054Z", "completed_at": "2024-05-11T05:43:17.525059Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7840840816497803, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_meeting", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_meeting_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_deleted\n    \n , \n    cast(null as TEXT) as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    cast(null as timestamp) as created_timestamp , \n    cast(null as timestamp) as occurred_timestamp , \n    cast(null as integer) as owner_id , \n    cast(null as integer) as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"created_from_link_id\"\n        , \"end_time\"\n        , \"pre_meeting_prospect_reminders\"\n        , \"source\"\n        , \"source_id\"\n        , \"start_time\"\n        , \"web_conference_meeting_id\"\n        , \"meeting_outcome\"\n        , \"body\"\n        , \"external_url\"\n        , \"title\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_meeting\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:15.923329Z", "completed_at": "2024-05-11T05:43:17.515744Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:17.516609Z", "completed_at": "2024-05-11T05:43:17.516616Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7853140830993652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_deal", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_deal_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    deal_id\n    \n as \n    \n    deal_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"engagement_type\"\n        , \"type_id\"\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_deal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:16.598759Z", "completed_at": "2024-05-11T05:43:18.043568Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:18.044061Z", "completed_at": "2024-05-11T05:43:18.044070Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.589768886566162, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_email", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_email_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_all_owner_ids\" as all_owner_ids\n        , \"property_hs_all_team_ids\" as all_team_ids\n        , \"property_hs_email_subject\" as email_subject\n        , \"property_hs_email_text\" as email_text\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_modified_by\" as modified_by\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_email\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:17.214215Z", "completed_at": "2024-05-11T05:43:18.521330Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:18.522367Z", "completed_at": "2024-05-11T05:43:18.522379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4498350620269775, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_note", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_note_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    cast(null as TEXT) as note , \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        \n        \n        \n\n        \n        \n        , \"property_hs_body_preview\" as body_preview\n        , \"property_hs_lastmodifieddate\" as lastmodifieddate\n        , \"property_hs_note_body\" as note_body\n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_note\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:17.714701Z", "completed_at": "2024-05-11T05:43:19.129437Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:19.130895Z", "completed_at": "2024-05-11T05:43:19.130904Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5875928401947021, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__owner", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__owner_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    owner_id\n    \n as \n    \n    owner_id\n    \n, \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(created_at as timestamp) as created_timestamp,\n        email as email_address,\n        first_name,\n        last_name,\n        owner_id,\n        portal_id,\n        type as owner_type,\n        cast(updated_at as timestamp) as updated_timestamp,\n        trim( first_name || ' ' || last_name ) as full_name\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__owner\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:17.709181Z", "completed_at": "2024-05-11T05:43:19.129877Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:19.131252Z", "completed_at": "2024-05-11T05:43:19.131256Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5920910835266113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement_task", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_task_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n, \n    \n    \n    type\n    \n as engagement_type , \n    \n    \n    property_hs_createdate\n    \n as created_timestamp , \n    \n    \n    property_hs_timestamp\n    \n as occurred_timestamp , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_hubspot_team_id\n    \n as team_id \n\n\n         \n            \n        \n        \n        , \"property_hs_task_type\" as task_type\n        \n        \n        \n\n        \n        \n        , \"property_hs_object_id\" as object_id\n        , \"property_hs_engagement_source\" as engagement_source\n\n \n        \n    from base\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_task\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:18.191340Z", "completed_at": "2024-05-11T05:43:19.564460Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:19.565118Z", "completed_at": "2024-05-11T05:43:19.565135Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5346741676330566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    cast(null as boolean) as is_active , \n    cast(null as timestamp) as created_timestamp , \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    cast(null as integer) as \n    \n    owner_id\n    \n , \n    \n    \n    portal_id\n    \n as \n    \n    portal_id\n    \n, \n    cast(null as timestamp) as occurred_timestamp , \n    \n    \n    type\n    \n as engagement_type \n\n\n    from base\n\n), fields as (\n\n    select\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        id as engagement_id,\n        created_timestamp,\n        owner_id,\n        occurred_timestamp,\n        portal_id,\n        engagement_type,\n        is_active\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:18.665978Z", "completed_at": "2024-05-11T05:43:20.039730Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:20.040344Z", "completed_at": "2024-05-11T05:43:20.040352Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.642164945602417, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    calculated\n    \n as \n    \n    calculated\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    description\n    \n as \n    \n    description\n    \n, \n    \n    \n    field_type\n    \n as \n    \n    field_type\n    \n, \n    \n    \n    group_name\n    \n as \n    \n    group_name\n    \n, \n    \n    \n    hubspot_defined\n    \n as \n    \n    hubspot_defined\n    \n, \n    \n    \n    hubspot_object\n    \n as \n    \n    hubspot_object\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    show_currency_symbol\n    \n as \n    \n    show_currency_symbol\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        _fivetran_id,\n        _fivetran_synced,\n        calculated,\n        created_at,\n        description,\n        field_type,\n        group_name,\n        hubspot_defined,\n        hubspot_object,\n        label as property_label,\n        name as property_name,\n        type as property_type,\n        updated_at\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:19.300920Z", "completed_at": "2024-05-11T05:43:20.835762Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:20.836369Z", "completed_at": "2024-05-11T05:43:20.836376Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.686488151550293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__property_option", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property_option_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    property_id\n    \n as \n    \n    property_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    hidden\n    \n as \n    \n    hidden\n    \n, \n    \n    \n    value\n    \n as \n    \n    value\n    \n\n\n\n    from base\n\n), fields as (\n\n    select\n        label as property_option_label,\t\n        property_id,\n        _fivetran_synced,\n        display_order,\n        hidden,\n        value as property_option_value\n    from macro\n    \n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property_option\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:19.313569Z", "completed_at": "2024-05-11T05:43:21.070542Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:21.071023Z", "completed_at": "2024-05-11T05:43:21.071029Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.019174814224243, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_company", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_company_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    company_id\n    \n as \n    \n    company_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_company\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:19.726575Z", "completed_at": "2024-05-11T05:43:21.880814Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:21.881447Z", "completed_at": "2024-05-11T05:43:21.881454Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.311000108718872, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_contact", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_contact_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    contact_id\n    \n as \n    \n    contact_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_contact\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:20.310629Z", "completed_at": "2024-05-11T05:43:22.052370Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:22.052857Z", "completed_at": "2024-05-11T05:43:22.052863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8842718601226807, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_engagement", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_engagement_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    engagement_id\n    \n as \n    \n    engagement_id\n    \n\n\n\n         \n            \n        \n        \n\n        \n        \n\n \n        \n    from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_engagement\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:20.988330Z", "completed_at": "2024-05-11T05:43:22.851347Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:22.851906Z", "completed_at": "2024-05-11T05:43:22.851913Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.0493662357330322, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline_stage", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    is_closed\n    \n as \n    \n    is_closed\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    stage_id\n    \n as \n    \n    stage_id\n    \n, \n    \n    \n    ticket_state\n    \n as \n    \n    ticket_state\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        _fivetran_deleted as is_ticket_pipeline_stage_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        is_closed,\n        label as pipeline_stage_label,\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        cast(stage_id as integer ) as ticket_pipeline_stage_id,\n        ticket_state,\n        created_at as ticket_pipeline_stage_created_at,\n        updated_at as ticket_pipeline_stage_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.038075Z", "completed_at": "2024-05-11T05:43:23.046327Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.046862Z", "completed_at": "2024-05-11T05:43:23.046869Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010013818740844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_list_contact_list_id.ff8e4cc29a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.048473Z", "completed_at": "2024-05-11T05:43:23.053094Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.053684Z", "completed_at": "2024-05-11T05:43:23.053691Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006271839141845703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_list_contact_list_id.036739c1b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.055390Z", "completed_at": "2024-05-11T05:43:23.071159Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.072037Z", "completed_at": "2024-05-11T05:43:23.072043Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017962932586669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__company_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company_property_history\"\n\n), windows as (\n\n    select\n        company_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by company_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(company_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__company_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.074878Z", "completed_at": "2024-05-11T05:43:23.078469Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.079049Z", "completed_at": "2024-05-11T05:43:23.079056Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005342960357666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__company_company_id.0d0a080d43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.080849Z", "completed_at": "2024-05-11T05:43:23.084352Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.084859Z", "completed_at": "2024-05-11T05:43:23.084864Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005071878433227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__company_company_id.394a2a4ba0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company\"\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.086489Z", "completed_at": "2024-05-11T05:43:23.093583Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.094161Z", "completed_at": "2024-05-11T05:43:23.094167Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008810997009277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_company_company_id__deal_id__type_id.59d48f3923", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, deal_id, type_id\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_company\"\n    group by company_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.095945Z", "completed_at": "2024-05-11T05:43:23.101686Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.102155Z", "completed_at": "2024-05-11T05:43:23.102160Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0072138309478759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__contact_merge_adjust", "compiled": true, "compiled_code": "\n\nwith contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact\"\n), contact_merge_audit as (\n\n    \n    select\n        contacts.contact_id,\n        split_part(merges, ':', 1) as vid_to_merge\n\n    from contacts\n    cross join \n        unnest(string_to_array(calculated_merged_vids, ';')) as merges\n\n\n\n\n\n\n), contact_merge_removal as (\n    select \n        contacts.*\n    from contacts\n    \n    left join contact_merge_audit\n        on cast(contacts.contact_id as TEXT) = cast(contact_merge_audit.vid_to_merge as TEXT)\n    \n    where contact_merge_audit.vid_to_merge is null\n)\n\nselect *\nfrom contact_merge_removal", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.103753Z", "completed_at": "2024-05-11T05:43:23.106720Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.107166Z", "completed_at": "2024-05-11T05:43:23.107172Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0043141841888427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__contact_contact_id.9f112f8944", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.108583Z", "completed_at": "2024-05-11T05:43:23.111462Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.111957Z", "completed_at": "2024-05-11T05:43:23.111962Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004270076751708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__contact_contact_id.b9135eb03a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact\"\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.113359Z", "completed_at": "2024-05-11T05:43:23.117101Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.117525Z", "completed_at": "2024-05-11T05:43:23.117529Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0050470829010009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_property_history\"\n\n), windows as (\n\n    select\n        contact_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by contact_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(contact_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contact_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.119128Z", "completed_at": "2024-05-11T05:43:23.122327Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.122789Z", "completed_at": "2024-05-11T05:43:23.122794Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004693031311035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__deal_contact_contact_id__deal_id__type_id.37de71798b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, deal_id, type_id\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_contact\"\n    group by contact_id, deal_id, type_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.124239Z", "completed_at": "2024-05-11T05:43:23.127969Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.128415Z", "completed_at": "2024-05-11T05:43:23.128419Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005071163177490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.d53656553e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_stage_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.129839Z", "completed_at": "2024-05-11T05:43:23.132549Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.132982Z", "completed_at": "2024-05-11T05:43:23.132987Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004024028778076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_stage_deal_pipeline_stage_id.ba90fa6113", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\nwhere deal_pipeline_stage_id is not null\ngroup by deal_pipeline_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.134349Z", "completed_at": "2024-05-11T05:43:23.137450Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.137906Z", "completed_at": "2024-05-11T05:43:23.137911Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0044629573822021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_pipeline_deal_pipeline_id.8a0e3cd7a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_pipeline_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.139337Z", "completed_at": "2024-05-11T05:43:23.141979Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.142414Z", "completed_at": "2024-05-11T05:43:23.142418Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.003941059112548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_pipeline_deal_pipeline_id.dff6c45403", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_pipeline_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\nwhere deal_pipeline_id is not null\ngroup by deal_pipeline_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.143754Z", "completed_at": "2024-05-11T05:43:23.148534Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.148982Z", "completed_at": "2024-05-11T05:43:23.148986Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006078958511352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_property_history\"\n\n), windows as (\n\n    select\n        deal_id,\n        field_name,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        new_value,\n        lead(change_timestamp) over (partition by deal_id, field_name order by change_timestamp) as valid_to\n    from history\n\n), surrogate as (\n\n    select \n        windows.*,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(deal_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(valid_from as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from windows\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deal_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.150422Z", "completed_at": "2024-05-11T05:43:23.153171Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.153593Z", "completed_at": "2024-05-11T05:43:23.153597Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0040209293365478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_click_event_id.8a1be931c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_click\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.154933Z", "completed_at": "2024-05-11T05:43:23.157798Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.158246Z", "completed_at": "2024-05-11T05:43:23.158251Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0041790008544921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_click_event_id.da8d8487a1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_click\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.159787Z", "completed_at": "2024-05-11T05:43:23.162595Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.163037Z", "completed_at": "2024-05-11T05:43:23.163041Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004312038421630859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__deal_deal_id.ff48693e20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.164913Z", "completed_at": "2024-05-11T05:43:23.170102Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.170556Z", "completed_at": "2024-05-11T05:43:23.170561Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0068471431732177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__deal_deal_id.ac1628ac69", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal\"\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:21.332220Z", "completed_at": "2024-05-11T05:43:23.071727Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.073108Z", "completed_at": "2024-05-11T05:43:23.073113Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.8448340892791748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_pipeline", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active\n    \n as \n    \n    active\n    \n, \n    \n    \n    display_order\n    \n as \n    \n    display_order\n    \n, \n    \n    \n    label\n    \n as \n    \n    label\n    \n, \n    \n    \n    object_type_id\n    \n as \n    \n    object_type_id\n    \n, \n    \n    \n    pipeline_id\n    \n as \n    \n    pipeline_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(pipeline_id as integer ) as ticket_pipeline_id,\n        _fivetran_deleted as is_ticket_pipeline_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        active as is_active,\n        display_order,\n        label as pipeline_label,\n        object_type_id,\n        created_at as ticket_pipeline_created_at,\n        updated_at as ticket_pipeline_updated_at\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.172018Z", "completed_at": "2024-05-11T05:43:23.176706Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.177720Z", "completed_at": "2024-05-11T05:43:23.177724Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009105920791625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_campaign_email_campaign_id.79921899a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.177949Z", "completed_at": "2024-05-11T05:43:23.184953Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.185549Z", "completed_at": "2024-05-11T05:43:23.185554Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008975982666015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_campaign_email_campaign_id.9820d33f2e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_campaign\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.181860Z", "completed_at": "2024-05-11T05:43:23.186441Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.187561Z", "completed_at": "2024-05-11T05:43:23.187565Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009469032287597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_bounce_event_id.71b13d26d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.187817Z", "completed_at": "2024-05-11T05:43:23.194436Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.194911Z", "completed_at": "2024-05-11T05:43:23.194915Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008599042892456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_bounce_event_id.0341ffa8e9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.191903Z", "completed_at": "2024-05-11T05:43:23.195781Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.196772Z", "completed_at": "2024-05-11T05:43:23.196776Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009543895721435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_deferred_event_id.80293078e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.197116Z", "completed_at": "2024-05-11T05:43:23.251122Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.254573Z", "completed_at": "2024-05-11T05:43:23.254580Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05897331237792969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_deferred_event_id.2f779e2912", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.202222Z", "completed_at": "2024-05-11T05:43:23.259226Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.259826Z", "completed_at": "2024-05-11T05:43:23.259833Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.058676958084106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_forward_event_id.b9a8bf63b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.256298Z", "completed_at": "2024-05-11T05:43:23.260880Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.261950Z", "completed_at": "2024-05-11T05:43:23.261954Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010220050811767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_forward_event_id.7f133d2dd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_forward\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.262208Z", "completed_at": "2024-05-11T05:43:23.267057Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.270876Z", "completed_at": "2024-05-11T05:43:23.270888Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010384082794189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_dropped_event_id.c92d449f52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.267754Z", "completed_at": "2024-05-11T05:43:23.272893Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.278098Z", "completed_at": "2024-05-11T05:43:23.278107Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012005090713500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_dropped_event_id.40706bbf71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.273184Z", "completed_at": "2024-05-11T05:43:23.279294Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.280666Z", "completed_at": "2024-05-11T05:43:23.280671Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012446880340576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_delivered_event_id.87c8eb3f20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.280947Z", "completed_at": "2024-05-11T05:43:23.286367Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.289882Z", "completed_at": "2024-05-11T05:43:23.289890Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010797977447509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_delivered_event_id.f818bf03fc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.286708Z", "completed_at": "2024-05-11T05:43:23.291018Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.292200Z", "completed_at": "2024-05-11T05:43:23.292205Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009898900985717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_open_event_id.a2e658fe16", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_open\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.292452Z", "completed_at": "2024-05-11T05:43:23.296634Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.300117Z", "completed_at": "2024-05-11T05:43:23.300125Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00929570198059082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_open_event_id.3a369549b1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_open\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.296869Z", "completed_at": "2024-05-11T05:43:23.301217Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.302278Z", "completed_at": "2024-05-11T05:43:23.302282Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010131120681762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_sent_event_id.cf77d9f15d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.302511Z", "completed_at": "2024-05-11T05:43:23.307641Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.310843Z", "completed_at": "2024-05-11T05:43:23.310848Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009769916534423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_sent_event_id.122cb22272", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_sent\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.307908Z", "completed_at": "2024-05-11T05:43:23.312044Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.313512Z", "completed_at": "2024-05-11T05:43:23.313516Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00997471809387207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_print_event_id.94d4e09b3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.313745Z", "completed_at": "2024-05-11T05:43:23.318272Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.321886Z", "completed_at": "2024-05-11T05:43:23.321892Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010059118270874023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_print_event_id.40a8ccd3f3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_print\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.318669Z", "completed_at": "2024-05-11T05:43:23.322938Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.324056Z", "completed_at": "2024-05-11T05:43:23.324060Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009525060653686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_spam_report_event_id.2a56aced8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.324299Z", "completed_at": "2024-05-11T05:43:23.328618Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.333073Z", "completed_at": "2024-05-11T05:43:23.333078Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01032114028930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_spam_report_event_id.448320447a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.328871Z", "completed_at": "2024-05-11T05:43:23.334041Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.335137Z", "completed_at": "2024-05-11T05:43:23.335141Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010284185409545898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_status_change_event_id.c5e80297b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.335360Z", "completed_at": "2024-05-11T05:43:23.339255Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.342943Z", "completed_at": "2024-05-11T05:43:23.342949Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009058952331542969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_status_change_event_id.13105203e0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.339958Z", "completed_at": "2024-05-11T05:43:23.347118Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.347587Z", "completed_at": "2024-05-11T05:43:23.347592Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009081125259399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_call_engagement_id.5ceb3917bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.344529Z", "completed_at": "2024-05-11T05:43:23.348266Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.349399Z", "completed_at": "2024-05-11T05:43:23.349402Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006036996841430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_call_engagement_id.43b4413603", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_call\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.353763Z", "completed_at": "2024-05-11T05:43:23.359225Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.362477Z", "completed_at": "2024-05-11T05:43:23.362482Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009721040725708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__email_event_event_id.4f287f3531", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.359474Z", "completed_at": "2024-05-11T05:43:23.363481Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.364546Z", "completed_at": "2024-05-11T05:43:23.364550Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009206056594848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__email_event_event_id.734683460d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.364792Z", "completed_at": "2024-05-11T05:43:23.368942Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.371977Z", "completed_at": "2024-05-11T05:43:23.371981Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008643865585327148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_meeting_engagement_id.18dd11dc28", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.369188Z", "completed_at": "2024-05-11T05:43:23.372900Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.373920Z", "completed_at": "2024-05-11T05:43:23.373924Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008583307266235352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_meeting_engagement_id.70721fb830", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.374168Z", "completed_at": "2024-05-11T05:43:23.378224Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.382519Z", "completed_at": "2024-05-11T05:43:23.382524Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009789228439331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_email_engagement_id.175561ecca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.378627Z", "completed_at": "2024-05-11T05:43:23.383468Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.384451Z", "completed_at": "2024-05-11T05:43:23.384455Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009716987609863281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_email_engagement_id.5eeb06dcfc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_email\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.384687Z", "completed_at": "2024-05-11T05:43:23.388486Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.391592Z", "completed_at": "2024-05-11T05:43:23.391597Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008347272872924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_note_engagement_id.244059891e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.388720Z", "completed_at": "2024-05-11T05:43:23.392354Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.393405Z", "completed_at": "2024-05-11T05:43:23.393409Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0060269832611083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_note_engagement_id.e2eaf5256e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_note\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.400535Z", "completed_at": "2024-05-11T05:43:23.404185Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.405223Z", "completed_at": "2024-05-11T05:43:23.405227Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009167194366455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_task_engagement_id.0bbd752d82", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.405450Z", "completed_at": "2024-05-11T05:43:23.410287Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.418653Z", "completed_at": "2024-05-11T05:43:23.418660Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014622926712036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_task_engagement_id.0f578bc80c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_task\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.410528Z", "completed_at": "2024-05-11T05:43:23.420032Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.423431Z", "completed_at": "2024-05-11T05:43:23.423436Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01411890983581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagements", "compiled": true, "compiled_code": "\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement\"\n\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), contacts_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(contact_id)\n as contact_ids\n    from contacts\n    group by 1\n\n\n\n\n\n), deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_deal\"\n \n), deals_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(deal_id)\n as deal_ids\n    from deals\n    group by 1\n\n\n\n\n\n), companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_company\"\n\n), companies_agg as (\n\n    select \n        engagement_id,\n        \n    array_agg(company_id)\n as company_ids\n    from companies\n    group by 1\n\n\n\n), joined as (\n\n    select \n         contacts_agg.contact_ids, \n         deals_agg.deal_ids, \n         companies_agg.company_ids, \n        engagements.*\n    from engagements\n     left join contacts_agg using (engagement_id) \n     left join deals_agg using (engagement_id) \n     left join companies_agg using (engagement_id) \n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.420667Z", "completed_at": "2024-05-11T05:43:23.424939Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.428163Z", "completed_at": "2024-05-11T05:43:23.428169Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00895071029663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__engagement_engagement_id.b26f4d328f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.425555Z", "completed_at": "2024-05-11T05:43:23.429480Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.432991Z", "completed_at": "2024-05-11T05:43:23.433000Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00894784927368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__engagement_engagement_id.4f054187b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.430121Z", "completed_at": "2024-05-11T05:43:23.434726Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.439461Z", "completed_at": "2024-05-11T05:43:23.439470Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010823249816894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__property__fivetran_id.37b6ec5db1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _fivetran_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property\"\nwhere _fivetran_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.434982Z", "completed_at": "2024-05-11T05:43:23.440671Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.441713Z", "completed_at": "2024-05-11T05:43:23.441717Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011425018310546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__property__fivetran_id.1d41a2aa95", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    _fivetran_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property\"\nwhere _fivetran_id is not null\ngroup by _fivetran_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.441940Z", "completed_at": "2024-05-11T05:43:23.446729Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.450458Z", "completed_at": "2024-05-11T05:43:23.450463Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009945154190063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.dbt_utils_unique_combination_of_columns_stg_hubspot__property_option_property_id__property_option_label.2792c4669b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        property_id, property_option_label\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__property_option\"\n    group by property_id, property_option_label\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.446978Z", "completed_at": "2024-05-11T05:43:23.451986Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.455089Z", "completed_at": "2024-05-11T05:43:23.455095Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009324789047241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__company_history_company_id__field_name__valid_to.654ef778b1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__company_history\"\n    group by company_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.452222Z", "completed_at": "2024-05-11T05:43:23.456704Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.459975Z", "completed_at": "2024-05-11T05:43:23.459981Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008978843688964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__company_history_id.33035793ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__company_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.456963Z", "completed_at": "2024-05-11T05:43:23.460923Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.461890Z", "completed_at": "2024-05-11T05:43:23.461894Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012161016464233398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__company_history_id.f1af964b1f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__company_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.462115Z", "completed_at": "2024-05-11T05:43:23.475291Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.477213Z", "completed_at": "2024-05-11T05:43:23.477218Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016876935958862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_bounce", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_bounce\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_bounce\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.478378Z", "completed_at": "2024-05-11T05:43:23.483427Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.487055Z", "completed_at": "2024-05-11T05:43:23.487063Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010946989059448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_clicks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_click\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_clicks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.483669Z", "completed_at": "2024-05-11T05:43:23.488396Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.492192Z", "completed_at": "2024-05-11T05:43:23.492197Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009865999221801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_deferred", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_deferred\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_deferred\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.489107Z", "completed_at": "2024-05-11T05:43:23.493289Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.494284Z", "completed_at": "2024-05-11T05:43:23.494288Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010722875595092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_delivered", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_delivered\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_delivered\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.494642Z", "completed_at": "2024-05-11T05:43:23.500070Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.503698Z", "completed_at": "2024-05-11T05:43:23.503705Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010703325271606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_dropped", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_dropped\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_dropped\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.500318Z", "completed_at": "2024-05-11T05:43:23.504908Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.506041Z", "completed_at": "2024-05-11T05:43:23.506045Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010350227355957031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_forward", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_forward\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_forward\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.506477Z", "completed_at": "2024-05-11T05:43:23.514247Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.514820Z", "completed_at": "2024-05-11T05:43:23.514826Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010052204132080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_opens", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_open\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_opens\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.511129Z", "completed_at": "2024-05-11T05:43:23.515927Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.516982Z", "completed_at": "2024-05-11T05:43:23.516987Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00980997085571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_print", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_print\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_print\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.517233Z", "completed_at": "2024-05-11T05:43:23.521574Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.525989Z", "completed_at": "2024-05-11T05:43:23.525993Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010251045227050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_sent", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_sent\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_sent\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.521815Z", "completed_at": "2024-05-11T05:43:23.526955Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.527920Z", "completed_at": "2024-05-11T05:43:23.527924Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010183095932006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_spam_report", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_spam_report\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_spam_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.528149Z", "completed_at": "2024-05-11T05:43:23.535512Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.535997Z", "completed_at": "2024-05-11T05:43:23.536005Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009219884872436523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_event_status_change", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event_status_change\"\n\n), events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), events_joined as (\n\n    select \n        base.*,\n        events.created_timestamp,\n        events.email_campaign_id,\n        events.recipient_email_address,\n        events.sent_timestamp as email_send_timestamp,\n        events.sent_by_event_id as email_send_id\n    from base\n    left join events\n        using (event_id)\n\n\n), contacts_joined as (\n\n    select \n        events_joined.*,\n        contacts.contact_id,\n        coalesce(contacts.is_contact_deleted, false) as is_contact_deleted\n    from events_joined\n    left join contacts\n        on events_joined.recipient_email_address = contacts.email\n\n)\n\nselect *\nfrom contacts_joined\n\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_status_change\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.532639Z", "completed_at": "2024-05-11T05:43:23.537547Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.540811Z", "completed_at": "2024-05-11T05:43:23.540817Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009328842163085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__contact_history_contact_id__field_name__valid_to.42ccfb8329", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        contact_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contact_history\"\n    group by contact_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.537787Z", "completed_at": "2024-05-11T05:43:23.541882Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.542981Z", "completed_at": "2024-05-11T05:43:23.542986Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009972095489501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_history_id.eaae22e088", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contact_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.543226Z", "completed_at": "2024-05-11T05:43:23.548140Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.551333Z", "completed_at": "2024-05-11T05:43:23.551338Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009594202041625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_history_id.aef69ae1ec", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contact_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.548395Z", "completed_at": "2024-05-11T05:43:23.552634Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.555755Z", "completed_at": "2024-05-11T05:43:23.555760Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008759021759033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.dbt_utils_unique_combination_of_columns_hubspot__deal_history_deal_id__field_name__valid_to.f55c724804", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        deal_id, field_name, valid_to\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deal_history\"\n    group by deal_id, field_name, valid_to\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.553247Z", "completed_at": "2024-05-11T05:43:23.557104Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.558378Z", "completed_at": "2024-05-11T05:43:23.558383Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009174823760986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_history_id.a1c6cd6a75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deal_history\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.558637Z", "completed_at": "2024-05-11T05:43:23.562670Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.566358Z", "completed_at": "2024-05-11T05:43:23.566363Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009413957595825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_history_id.1cb93fca79", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deal_history\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:22.038296Z", "completed_at": "2024-05-11T05:43:23.476918Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.481937Z", "completed_at": "2024-05-11T05:43:23.481942Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.5358641147613525, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket_property_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_property_history_tmp\"\n\n), macro as (\n\n    select\n        \n        \n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _fivetran_start\n    \n as \n    \n    _fivetran_start\n    \n, \n    \n    \n    ticket_id\n    \n as \n    \n    ticket_id\n    \n, \n    \n    \n    name\n    \n as field_name , \n    \n    \n    source\n    \n as change_source , \n    \n    \n    source_id\n    \n as change_source_id , \n    \n    \n    timestamp_instant\n    \n as change_timestamp , \n    \n    \n    value\n    \n as new_value \n\n\n         \n            \n        \n        \n        \n        \n\n        \n        \n        , \"_fivetran_active\"\n        , \"_fivetran_end\"\n\n \n        \n        from base\n\n)\n\nselect *\nfrom macro", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_property_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.562896Z", "completed_at": "2024-05-11T05:43:23.572080Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.572856Z", "completed_at": "2024-05-11T05:43:23.572861Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011909961700439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_event_aggregates_email_send_id.ac29e6997a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n) select email_send_id\nfrom __dbt__cte__int_hubspot__email_event_aggregates\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.567846Z", "completed_at": "2024-05-11T05:43:23.573083Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.575113Z", "completed_at": "2024-05-11T05:43:23.575119Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008893013000488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_event_aggregates_email_send_id.4deec238f9", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n) select\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__email_event_aggregates\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.577093Z", "completed_at": "2024-05-11T05:43:23.604002Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.622406Z", "completed_at": "2024-05-11T05:43:23.622413Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.048326730728149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deal_stages", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal\"\n\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n), deal_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_stage\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), final as (\n\n    select\n        deal_stage.deal_id || '-' || row_number() over(partition by deal_stage.deal_id order by deal_stage.date_entered asc) as deal_stage_id,\n        deals_enhanced.deal_id,\n        deals_enhanced.deal_name,\n\n        \n        \n        deal_stage._fivetran_start as date_stage_entered,\n        deal_stage._fivetran_end as date_stage_exited,\n        deal_stage._fivetran_active as is_stage_active,\n        deal_stage.deal_stage_name as pipeline_stage_id,\n        pipeline_stage.pipeline_stage_label,\n        pipeline_stage.deal_pipeline_id as pipeline_id,\n        pipeline.pipeline_label,\n        deal_stage.source,\n        deal_stage.source_id,\n        pipeline_stage.is_active as is_pipeline_stage_active,\n        pipeline.is_active as is_pipeline_active,\n        pipeline_stage.is_closed_won as is_pipeline_stage_closed_won,\n        pipeline_stage.display_order as pipeline_stage_display_order,\n        pipeline.display_order as pipeline_display_order,\n        pipeline_stage.probability as pipeline_stage_probability,\n        coalesce(pipeline.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        coalesce(pipeline_stage.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        coalesce(deals_enhanced.is_deal_deleted, false) as is_deal_deleted,\n        pipeline_stage.deal_pipeline_stage_created_at,\n        pipeline_stage.deal_pipeline_stage_updated_at\n\n    from deal_stage\n\n    left join pipeline_stage\n        on deal_stage.deal_stage_name = pipeline_stage.deal_pipeline_stage_id\n    \n    left join pipeline\n        on pipeline_stage.deal_pipeline_id = pipeline.deal_pipeline_id\n\n    left join deals_enhanced\n        on deal_stage.deal_id = deals_enhanced.deal_id\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deal_stages\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.589323Z", "completed_at": "2024-05-11T05:43:23.610916Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.622930Z", "completed_at": "2024-05-11T05:43:23.622935Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.048722267150878906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__companies", "compiled": true, "compiled_code": "\n\nwith companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company\"\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), engagement_companies as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_company\"\n\n), engagement_companies_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_companies.company_id\n    from engagements\n    inner join engagement_companies\n        using (engagement_id)\n\n), engagement_companies_agg as (\n\n    \n\n    select\n        company_id,\n        count(case when engagement_type = 'NOTE' then company_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then company_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then company_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then company_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then company_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then company_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then company_id end) as count_engagement_forwarded_emails\n    from engagement_companies_joined\n    group by 1\n\n\n\n), joined as (\n\n    select \n        companies.*,\n        \n        coalesce(engagement_companies_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_companies_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_companies_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_companies_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_companies_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_companies_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from companies\n    left join engagement_companies_agg\n        using (company_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__companies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.604600Z", "completed_at": "2024-05-11T05:43:23.623213Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.625746Z", "completed_at": "2024-05-11T05:43:23.625749Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03191804885864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__deals", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__deals_enhanced as (\n\n\nwith deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal\"\n\n\n\n), pipelines as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline\"\n\n), pipeline_stages as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__deal_pipeline_stage\"\n\n\n), owners as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n), deal_fields_joined as (\n\n    select \n        deals.*,\n\n        \n\n        coalesce(pipelines.is_deal_pipeline_deleted, false) as is_deal_pipeline_deleted,\n        pipelines.pipeline_label,\n        pipelines.is_active as is_pipeline_active,\n        coalesce(pipeline_stages.is_deal_pipeline_stage_deleted, false) as is_deal_pipeline_stage_deleted,\n        pipelines.deal_pipeline_created_at,\n        pipelines.deal_pipeline_updated_at,\n        pipeline_stages.pipeline_stage_label\n\n        \n        , owners.email_address as owner_email_address\n        , owners.full_name as owner_full_name\n        \n\n    from deals    \n    left join pipelines \n        on deals.deal_pipeline_id = pipelines.deal_pipeline_id\n    left join pipeline_stages \n        on deals.deal_pipeline_stage_id = pipeline_stages.deal_pipeline_stage_id\n\n    \n    left join owners \n        on deals.owner_id = owners.owner_id\n    \n\n    \n)   \n\nselect *\nfrom deal_fields_joined\n), deals_enhanced as (\n\n    select *\n    from __dbt__cte__int_hubspot__deals_enhanced\n\n\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), engagement_deals as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_deal\"\n\n), engagement_deal_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_deals.deal_id\n    from engagements\n    inner join engagement_deals\n        on cast(engagements.engagement_id as bigint) = cast(engagement_deals.engagement_id as bigint )\n\n), engagement_deal_agg as (\n\n    \n\n    select\n        deal_id,\n        count(case when engagement_type = 'NOTE' then deal_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then deal_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then deal_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then deal_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then deal_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then deal_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then deal_id end) as count_engagement_forwarded_emails\n    from engagement_deal_joined\n    group by 1\n\n\n\n), engagements_joined as (\n\n    select \n        deals_enhanced.*,\n        \n        coalesce(engagement_deal_agg.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagement_deal_agg.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagement_deal_agg.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagement_deal_agg.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagement_deal_agg.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagement_deal_agg.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from deals_enhanced\n    left join engagement_deal_agg\n        on cast(deals_enhanced.deal_id as bigint) = cast(engagement_deal_agg.deal_id as bigint )\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deals\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:22.195180Z", "completed_at": "2024-05-11T05:43:23.621849Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:23.623991Z", "completed_at": "2024-05-11T05:43:23.623995Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.580367088317871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot_source.stg_hubspot__ticket", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_tmp\"\n\n), macro as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as ticket_id , \n    cast(null as boolean) as _fivetran_ticket_deleted , \n    \n    \n    is_deleted\n    \n as is_ticket_deleted , \n    \n    \n    property_closed_date\n    \n as closed_date , \n    \n    \n    property_createdate\n    \n as created_date , \n    \n    \n    property_first_agent_reply_date\n    \n as first_agent_reply_at , \n    \n    \n    property_hs_pipeline\n    \n as ticket_pipeline_id , \n    \n    \n    property_hs_pipeline_stage\n    \n as ticket_pipeline_stage_id , \n    \n    \n    property_hs_ticket_category\n    \n as ticket_category , \n    \n    \n    property_hs_ticket_priority\n    \n as ticket_priority , \n    \n    \n    property_hubspot_owner_id\n    \n as owner_id , \n    \n    \n    property_subject\n    \n as ticket_subject , \n    \n    \n    property_content\n    \n as ticket_content \n\n\n    from base\n\n), fields as (\n\n    select\n\n\n        -- just default columns + explicitly configured passthrough columns\n        -- a few columns below are aliased within the macros/get_ticket_columns.sql macro\n        ticket_id,\n        coalesce(_fivetran_ticket_deleted, is_ticket_deleted) as is_ticket_deleted,\n        cast(_fivetran_synced as timestamp) as _fivetran_synced,\n        cast(closed_date as timestamp) as closed_date,\n        cast(created_date as timestamp) as created_date,\n        first_agent_reply_at,\n        ticket_pipeline_id,\n        ticket_pipeline_stage_id,\n        ticket_category,\n        ticket_priority,\n        owner_id,\n        ticket_subject,\n        ticket_content\n\n        --The below macro adds the fields defined within your hubspot__ticket_pass_through_columns variable into the staging model\n        \n\n\n\n\n\n        -- The below macro add the ability to create calculated fields using the hubspot__ticket_calculated_fields variable.\n        \n\n\n        \n    from macro\n\n\n), joined as (\n    \n\nselect fields.*\n\nfrom fields\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.633673Z", "completed_at": "2024-05-11T05:43:25.061513Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.061987Z", "completed_at": "2024-05-11T05:43:25.061993Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5844650268554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_emails", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_email\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"all_owner_ids\",\n  base.\"all_team_ids\",\n  base.\"email_subject\",\n  base.\"email_text\",\n  base.\"lastmodifieddate\",\n  base.\"modified_by\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_emails\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.627798Z", "completed_at": "2024-05-11T05:43:25.073328Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.073751Z", "completed_at": "2024-05-11T05:43:25.073754Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6026549339294434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_calls", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_call\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_calls\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.639268Z", "completed_at": "2024-05-11T05:43:25.067555Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.067984Z", "completed_at": "2024-05-11T05:43:25.067987Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.59401273727417, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_meetings", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_meeting\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"created_from_link_id\",\n  base.\"end_time\",\n  base.\"pre_meeting_prospect_reminders\",\n  base.\"source\",\n  base.\"source_id\",\n  base.\"start_time\",\n  base.\"web_conference_meeting_id\",\n  base.\"meeting_outcome\",\n  base.\"body\",\n  base.\"external_url\",\n  base.\"title\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_meetings\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.241343Z", "completed_at": "2024-05-11T05:43:25.251628Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.252264Z", "completed_at": "2024-05-11T05:43:25.252270Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01787710189819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagements_engagement_id.59b32bc0d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.248138Z", "completed_at": "2024-05-11T05:43:25.253102Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.254347Z", "completed_at": "2024-05-11T05:43:25.254351Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007808685302734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagements_engagement_id.01d5c3ee5d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.255444Z", "completed_at": "2024-05-11T05:43:25.264322Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.265000Z", "completed_at": "2024-05-11T05:43:25.265007Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011823892593383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_bounce_event_id.39d8daa6f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_bounce\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.261053Z", "completed_at": "2024-05-11T05:43:25.265268Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.266611Z", "completed_at": "2024-05-11T05:43:25.266615Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007024288177490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_bounce_event_id.7a1c6704e1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_bounce\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.268263Z", "completed_at": "2024-05-11T05:43:25.275328Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.276114Z", "completed_at": "2024-05-11T05:43:25.276119Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00990605354309082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_clicks_event_id.f603501ca0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_clicks\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.272068Z", "completed_at": "2024-05-11T05:43:25.275855Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.277059Z", "completed_at": "2024-05-11T05:43:25.277062Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0063800811767578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_clicks_event_id.60d3912846", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_clicks\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.279140Z", "completed_at": "2024-05-11T05:43:25.285523Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.285989Z", "completed_at": "2024-05-11T05:43:25.285994Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008600234985351562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_deferred_event_id.2c6decaa91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_deferred\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.282021Z", "completed_at": "2024-05-11T05:43:25.286201Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.287364Z", "completed_at": "2024-05-11T05:43:25.287368Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009433984756469727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_deferred_event_id.bb75dcb83a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_deferred\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.288994Z", "completed_at": "2024-05-11T05:43:25.294702Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.295172Z", "completed_at": "2024-05-11T05:43:25.295176Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00816798210144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_delivered_event_id.0609870be3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_delivered\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.292092Z", "completed_at": "2024-05-11T05:43:25.295374Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.296497Z", "completed_at": "2024-05-11T05:43:25.296500Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005728960037231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_delivered_event_id.242e838cce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_delivered\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.298013Z", "completed_at": "2024-05-11T05:43:25.303550Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.304212Z", "completed_at": "2024-05-11T05:43:25.304216Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00807499885559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_dropped_event_id.5cfe4eeb95", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_dropped\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.301100Z", "completed_at": "2024-05-11T05:43:25.303999Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.305067Z", "completed_at": "2024-05-11T05:43:25.305070Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0051479339599609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_dropped_event_id.093040860b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_dropped\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.307012Z", "completed_at": "2024-05-11T05:43:25.313331Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.313840Z", "completed_at": "2024-05-11T05:43:25.313845Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00850820541381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_forward_event_id.417a73da08", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_forward\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.310683Z", "completed_at": "2024-05-11T05:43:25.314057Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.315227Z", "completed_at": "2024-05-11T05:43:25.315230Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009234189987182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_forward_event_id.064956aaa7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_forward\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.316646Z", "completed_at": "2024-05-11T05:43:25.323755Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.324270Z", "completed_at": "2024-05-11T05:43:25.324277Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009643077850341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_opens_event_id.a9fe279ee1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_opens\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.320504Z", "completed_at": "2024-05-11T05:43:25.324505Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.326013Z", "completed_at": "2024-05-11T05:43:25.326018Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007475852966308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_opens_event_id.d7963f4eb0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_opens\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.327856Z", "completed_at": "2024-05-11T05:43:25.384266Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.384866Z", "completed_at": "2024-05-11T05:43:25.384873Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05939507484436035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_print_event_id.9dac8a147e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_print\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:23.775748Z", "completed_at": "2024-05-11T05:43:25.235555Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.244958Z", "completed_at": "2024-05-11T05:43:25.244965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6111030578613281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_notes", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_note\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"note\",\n  base.\"engagement_type\",\n  base.\"engagement_id\",\n  base.\"team_id\",\n  base.\"body_preview\",\n  base.\"lastmodifieddate\",\n  base.\"note_body\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_notes\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.331920Z", "completed_at": "2024-05-11T05:43:25.387395Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.389217Z", "completed_at": "2024-05-11T05:43:25.389222Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06476688385009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_print_event_id.548f6cece7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_print\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.389479Z", "completed_at": "2024-05-11T05:43:25.399857Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.401043Z", "completed_at": "2024-05-11T05:43:25.401050Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01424098014831543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_sent_event_id.5507dcc5b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_sent\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.392627Z", "completed_at": "2024-05-11T05:43:25.400220Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.401514Z", "completed_at": "2024-05-11T05:43:25.401518Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014490127563476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_sent_event_id.68076270f8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_sent\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.397322Z", "completed_at": "2024-05-11T05:43:25.401271Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.403326Z", "completed_at": "2024-05-11T05:43:25.403329Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007699012756347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_spam_report_event_id.5ddca8771a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_spam_report\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.405819Z", "completed_at": "2024-05-11T05:43:25.416089Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.416540Z", "completed_at": "2024-05-11T05:43:25.416546Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013113975524902344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_spam_report_event_id.20aab81ec6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_spam_report\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.413180Z", "completed_at": "2024-05-11T05:43:25.418150Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.422099Z", "completed_at": "2024-05-11T05:43:25.422103Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013988971710205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_event_status_change_event_id.a1737e44b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_status_change\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.419529Z", "completed_at": "2024-05-11T05:43:25.423645Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.433919Z", "completed_at": "2024-05-11T05:43:25.433925Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02011394500732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_event_status_change_event_id.2e5b2b72e2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_status_change\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.423874Z", "completed_at": "2024-05-11T05:43:25.437484Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.438962Z", "completed_at": "2024-05-11T05:43:25.438966Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017563343048095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__daily_ticket_history", "compiled": true, "compiled_code": "\n\nwith history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_property_history\"\n\n    -- should we include an option pivot out ALL properties? in the same vein as our passthrough-all-columns var\n    where lower(field_name) in \n        ('hs_pipeline', 'hs_pipeline_stage'\n    )\n\n    \n    and change_timestamp >= (select cast(max(date_day) as timestamp) from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__daily_ticket_history\" )\n    \n\n), windows as (\n\n    select\n        cast(date_trunc('day', change_timestamp) as date) as date_day,\n        ticket_id,\n        field_name,\n        new_value,\n        change_source,\n        change_source_id,\n        change_timestamp as valid_from,\n        _fivetran_end as valid_to\n        -- if it is currently active fivetran_end = 9999-12-31 23:59:59, but the calendar_spine will end at the current_date\n    from history\n\n), order_daily_changes as (\n\n    select \n        *,\n        row_number() over (\n            partition by date_day, ticket_id, field_name\n            order by valid_from desc\n            ) as row_num\n    from windows\n\n), extract_latest as (\n    \n    select \n        date_day,\n        ticket_id,\n        field_name,\n        case when new_value is null then 'is_null' else new_value end as new_value,\n        change_source,\n        change_source_id,\n        valid_from,\n        valid_to\n\n    from order_daily_changes\n    where row_num = 1\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(field_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from extract_latest\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.434168Z", "completed_at": "2024-05-11T05:43:25.438719Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.440378Z", "completed_at": "2024-05-11T05:43:25.440382Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010590314865112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deal_stages_deal_stage_id.162d2d204b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_stage_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deal_stages\"\nwhere deal_stage_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.440904Z", "completed_at": "2024-05-11T05:43:25.447627Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.450839Z", "completed_at": "2024-05-11T05:43:25.450844Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012293100357055664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deal_stages_deal_stage_id.7fd3732373", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_stage_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deal_stages\" where not coalesce(is_deal_pipeline_stage_deleted, false)) dbt_subquery\nwhere deal_stage_id is not null\ngroup by deal_stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.445131Z", "completed_at": "2024-05-11T05:43:25.451071Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.452468Z", "completed_at": "2024-05-11T05:43:25.452472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009435176849365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__companies_company_id.687ec98e97", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__companies\"\nwhere company_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.448337Z", "completed_at": "2024-05-11T05:43:25.452237Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.453864Z", "completed_at": "2024-05-11T05:43:25.453868Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012217998504638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__companies_company_id.a58ceac3f2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__companies\" where not coalesce(is_company_deleted, false)) dbt_subquery\nwhere company_id is not null\ngroup by company_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.454322Z", "completed_at": "2024-05-11T05:43:25.461898Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.469205Z", "completed_at": "2024-05-11T05:43:25.469212Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01745295524597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__deals_deal_id.bdbfe47fcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deals\"\nwhere deal_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.458570Z", "completed_at": "2024-05-11T05:43:25.468952Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.470738Z", "completed_at": "2024-05-11T05:43:25.470742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014248847961425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__deals_deal_id.d728fe5f71", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__deals\" where not coalesce(is_deal_deleted, false)) dbt_subquery\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.473022Z", "completed_at": "2024-05-11T05:43:25.478818Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.479680Z", "completed_at": "2024-05-11T05:43:25.479685Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008451700210571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.not_null_stg_hubspot__ticket_ticket_id.299e7c4c53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.476134Z", "completed_at": "2024-05-11T05:43:25.479046Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.479904Z", "completed_at": "2024-05-11T05:43:25.479907Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008109092712402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot_source.unique_stg_hubspot__ticket_ticket_id.78c6fbfcaf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.495745Z", "completed_at": "2024-05-11T05:43:25.499807Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.500264Z", "completed_at": "2024-05-11T05:43:25.500270Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01878809928894043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_emails_engagement_id.13a39d1e09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_emails\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.482590Z", "completed_at": "2024-05-11T05:43:25.504711Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.505223Z", "completed_at": "2024-05-11T05:43:25.505229Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024302005767822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__tickets", "compiled": true, "compiled_code": "\n\nwith ticket as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket\"\n\n), ticket_pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline\"\n\n), ticket_pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\"\n\n\n\n\n), ticket_company as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_company\"\n\n), company as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__company\"\n\n), join_companies as (\n    \n    select\n        ticket_company.ticket_id,\n        ticket_company.company_id,\n        company.company_name\n\n    from ticket_company\n    left join company \n        on ticket_company.company_id = company.company_id\n\n), agg_companies as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when company_id is null then '' else cast(company_id as TEXT) end)\n as company_ids,\n        \n    array_agg(case when company_name is null then '' else company_name end)\n as company_names\n\n    from join_companies\n    group by 1\n\n\n\n\n), ticket_contact as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_contact\"\n\n), contact as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact\"\n\n), join_contacts as (\n    \n    select\n        ticket_contact.ticket_id,\n        ticket_contact.contact_id,\n        contact.email\n\n    from ticket_contact\n    left join contact \n        on ticket_contact.contact_id = contact.contact_id\n\n), agg_contacts as (\n\n    select\n        ticket_id,\n        \n    array_agg(case when contact_id is null then '' else cast(contact_id as TEXT) end)\n as contact_ids,\n        \n    array_agg(case when email is null then '' else email end)\n as contact_emails\n\n    from join_contacts\n    group by 1\n\n\n\n\n), owner as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__owner\"\n\n\n\n\n), engagement as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), ticket_engagement as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_engagement\"\n\n), join_engagements as (\n\n    select \n        engagement.engagement_type,\n        ticket_engagement.ticket_id\n    from engagement\n    inner join ticket_engagement\n        on cast(engagement.engagement_id as bigint) = cast(ticket_engagement.engagement_id as bigint )\n\n), agg_engagements as (\n\n    \n\n    select\n        ticket_id,\n        count(case when engagement_type = 'NOTE' then ticket_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then ticket_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then ticket_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then ticket_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then ticket_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then ticket_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then ticket_id end) as count_engagement_forwarded_emails\n    from join_engagements\n    group by 1\n\n\n\n\n\n), final_join as (\n\n    select\n        ticket.*,\n        ticket_pipeline_stage.ticket_state,\n        ticket_pipeline_stage.is_closed,\n        ticket_pipeline_stage.pipeline_stage_label,\n        ticket_pipeline.pipeline_label,\n        ticket_pipeline_stage.display_order as pipeline_stage_order,\n        ticket_pipeline.is_ticket_pipeline_deleted,\n        ticket_pipeline_stage.is_ticket_pipeline_stage_deleted\n\n    \n        , owner.email_address as owner_email\n        , owner.full_name as owner_full_name\n    \n\n    \n\n    \n        , agg_contacts.contact_ids\n        , agg_contacts.contact_emails\n    \n\n    \n        , agg_companies.company_ids\n        , agg_companies.company_names\n    \n\n    \n        \n        , coalesce(agg_engagements.count_engagement_notes,0) as count_engagement_notes\n        \n        , coalesce(agg_engagements.count_engagement_tasks,0) as count_engagement_tasks\n        \n        , coalesce(agg_engagements.count_engagement_calls,0) as count_engagement_calls\n        \n        , coalesce(agg_engagements.count_engagement_meetings,0) as count_engagement_meetings\n        \n        , coalesce(agg_engagements.count_engagement_emails,0) as count_engagement_emails\n        \n        , coalesce(agg_engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails\n        \n        , coalesce(agg_engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails\n        \n    \n\n    from ticket\n\n    left join ticket_pipeline \n        on ticket.ticket_pipeline_id = ticket_pipeline.ticket_pipeline_id \n    \n    left join ticket_pipeline_stage \n        on ticket.ticket_pipeline_stage_id = ticket_pipeline_stage.ticket_pipeline_stage_id\n        and ticket_pipeline.ticket_pipeline_id = ticket_pipeline_stage.ticket_pipeline_id\n\n    \n    left join owner \n        on ticket.owner_id = owner.owner_id\n    \n\n    \n\n    \n    left join agg_contacts\n        on ticket.ticket_id = agg_contacts.ticket_id \n    \n\n    \n    left join agg_companies\n        on ticket.ticket_id = agg_companies.ticket_id \n    \n\n    \n    left join agg_engagements\n        on ticket.ticket_id = agg_engagements.ticket_id\n    \n)\n\nselect *\nfrom final_join", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.501783Z", "completed_at": "2024-05-11T05:43:25.505432Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.506671Z", "completed_at": "2024-05-11T05:43:25.506674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006209850311279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_emails_engagement_id.b18e2acbde", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_emails\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.508117Z", "completed_at": "2024-05-11T05:43:25.514372Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.514883Z", "completed_at": "2024-05-11T05:43:25.514889Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008398294448852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_calls_engagement_id.00f8d8357f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_calls\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.511648Z", "completed_at": "2024-05-11T05:43:25.515792Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.516821Z", "completed_at": "2024-05-11T05:43:25.516824Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009662389755249023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_calls_engagement_id.972572ce6c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_calls\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.517072Z", "completed_at": "2024-05-11T05:43:25.521735Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.524758Z", "completed_at": "2024-05-11T05:43:25.524763Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009103059768676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_meetings_engagement_id.83a791c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_meetings\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.521957Z", "completed_at": "2024-05-11T05:43:25.525690Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.526638Z", "completed_at": "2024-05-11T05:43:25.526641Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008668899536132812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_meetings_engagement_id.3098aabcd1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_meetings\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.526854Z", "completed_at": "2024-05-11T05:43:25.531004Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.534931Z", "completed_at": "2024-05-11T05:43:25.534935Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009416818618774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__engagement_metrics__by_contact_contact_id.4a800df06b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n) select contact_id\nfrom __dbt__cte__int_hubspot__engagement_metrics__by_contact\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.531235Z", "completed_at": "2024-05-11T05:43:25.535844Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.536794Z", "completed_at": "2024-05-11T05:43:25.536797Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009126901626586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__engagement_metrics__by_contact_contact_id.1c156b64ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n) select\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__engagement_metrics__by_contact\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.537014Z", "completed_at": "2024-05-11T05:43:25.540731Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.544474Z", "completed_at": "2024-05-11T05:43:25.544479Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008831024169921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_notes_engagement_id.76434ac965", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_notes\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.540950Z", "completed_at": "2024-05-11T05:43:25.545425Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.546450Z", "completed_at": "2024-05-11T05:43:25.546454Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017001867294311523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_notes_engagement_id.c9864b5001", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_notes\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.546683Z", "completed_at": "2024-05-11T05:43:25.558389Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.561935Z", "completed_at": "2024-05-11T05:43:25.561940Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01669025421142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_sends", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_hubspot__email_event_aggregates as (\n\n\nwith events as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_event\"\n\n), aggregates as (\n\n    select\n        sent_by_event_id as email_send_id,\n        count(case when event_type = 'OPEN' then sent_by_event_id end) as opens,\n        count(case when event_type = 'SENT' then sent_by_event_id end) as sends,\n        count(case when event_type = 'DELIVERED' then sent_by_event_id end) as deliveries,\n        count(case when event_type = 'DROPPED' then sent_by_event_id end) as drops,\n        count(case when event_type = 'CLICK' then sent_by_event_id end) as clicks,\n        count(case when event_type = 'FORWARD' then sent_by_event_id end) as forwards,\n        count(case when event_type = 'DEFERRED' then sent_by_event_id end) as deferrals,\n        count(case when event_type = 'BOUNCE' then sent_by_event_id end) as bounces,\n        count(case when event_type = 'SPAMREPORT' then sent_by_event_id end) as spam_reports,\n        count(case when event_type = 'PRINT' then sent_by_event_id end) as prints\n    from events\n    where sent_by_event_id is not null\n    group by 1\n\n)\n\nselect *\nfrom aggregates\n),  __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n), sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_sent\"\n\n), metrics as (\n\n    select *\n    from __dbt__cte__int_hubspot__email_event_aggregates\n\n), joined as (\n\n    select\n        sends.*,\n        coalesce(metrics.bounces,0) as bounces,\n        coalesce(metrics.clicks,0) as clicks,\n        coalesce(metrics.deferrals,0) as deferrals,\n        coalesce(metrics.deliveries,0) as deliveries,\n        coalesce(metrics.drops,0) as drops,\n        coalesce(metrics.forwards,0) as forwards,\n        coalesce(metrics.opens,0) as opens,\n        coalesce(metrics.prints,0) as prints,\n        coalesce(metrics.spam_reports,0) as spam_reports\n    from sends\n    left join metrics using (email_send_id)\n\n), booleans as (\n\n    select \n        *,\n        bounces > 0 as was_bounced,\n        clicks > 0 as was_clicked,\n        deferrals > 0 as was_deferred,\n        deliveries > 0 as was_delivered,\n        forwards > 0 as was_forwarded,\n        opens > 0 as was_opened,\n        prints > 0 as was_printed,\n        spam_reports > 0 as was_spam_reported\n    from joined\n\n\n\n), unsubscribes as (\n\n    select *\n    from __dbt__cte__int_hubspot__email_aggregate_status_change\n\n), unsubscribes_joined as (\n\n    select \n        booleans.*,\n        coalesce(unsubscribes.unsubscribes,0) as unsubscribes,\n        coalesce(unsubscribes.unsubscribes,0) > 0 as was_unsubcribed\n    from booleans\n    left join unsubscribes using (email_send_id)\n\n)\n\nselect *\nfrom unsubscribes_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_sends\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.558627Z", "completed_at": "2024-05-11T05:43:25.562891Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.563974Z", "completed_at": "2024-05-11T05:43:25.563978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010003805160522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_aggregate_status_change_email_send_id.16bf74a3bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n) select email_send_id\nfrom __dbt__cte__int_hubspot__email_aggregate_status_change\nwhere email_send_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.564232Z", "completed_at": "2024-05-11T05:43:25.569038Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.575496Z", "completed_at": "2024-05-11T05:43:25.575502Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012775182723999023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_aggregate_status_change_email_send_id.7c03e87c05", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__int_hubspot__email_aggregate_status_change as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_event_status_change\"\n\n), aggregates as (\n\n    select\n        email_campaign_id,\n        email_send_id,\n        count(case when subscription_status = 'UNSUBSCRIBED' then 1 end) as unsubscribes\n    from base\n    where email_send_id is not null\n    group by 1,2\n\n)\n\nselect *\nfrom aggregates\n) select\n    email_send_id as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__int_hubspot__email_aggregate_status_change\nwhere email_send_id is not null\ngroup by email_send_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.569274Z", "completed_at": "2024-05-11T05:43:25.576768Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.580102Z", "completed_at": "2024-05-11T05:43:25.580107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012070178985595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__pivot_daily_ticket_history", "compiled": true, "compiled_code": "\n\n\n\nwith daily_history as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__daily_ticket_history\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__pivot_daily_ticket_history\" )\n    \n\n), pivot_out as (\n\n    select \n        date_day, \n        ticket_id\n\n        -- should we remove the `hs_` prefix? could introduce some duplicates if people already have something like `hs_owner` and `owner`\n        , max(case when lower(field_name) = 'hs_pipeline' then new_value end) as hs_pipeline\n        , max(case when lower(field_name) = 'hs_pipeline_stage' then new_value end) as hs_pipeline_stage\n        from daily_history\n\n    group by 1,2\n\n), surrogate as (\n\n    select \n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from pivot_out\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__pivot_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.577390Z", "completed_at": "2024-05-11T05:43:25.584285Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.584739Z", "completed_at": "2024-05-11T05:43:25.584743Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00890493392944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__tickets_ticket_id.259c6846d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.581800Z", "completed_at": "2024-05-11T05:43:25.584949Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:25.586093Z", "completed_at": "2024-05-11T05:43:25.586095Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005621910095214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__tickets_ticket_id.4b54466361", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.214840Z", "completed_at": "2024-05-11T05:43:26.685215Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:26.685851Z", "completed_at": "2024-05-11T05:43:26.685859Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5898919105529785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__engagement_tasks", "compiled": true, "compiled_code": "\n\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_task\"\n\n), engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), joined as (\n\n    select \n        base.\"_fivetran_synced\",\n  base.\"engagement_id\",\n  base.\"engagement_type\",\n  base.\"team_id\",\n  base.\"task_type\",\n  base.\"object_id\",\n  base.\"engagement_source\",\n         engagements.contact_ids, \n         engagements.deal_ids, \n         engagements.company_ids, \n        coalesce(engagements.is_active, not base._fivetran_deleted) as is_active,\n        coalesce(engagements.created_timestamp, base.created_timestamp) as created_timestamp,\n        coalesce(engagements.occurred_timestamp, base.occurred_timestamp) as occurred_timestamp,\n        coalesce(engagements.owner_id, base.owner_id) as owner_id\n    from base\n    left join engagements\n        on base.engagement_id = engagements.engagement_id\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_tasks\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.596550Z", "completed_at": "2024-05-11T05:43:26.989602Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:26.990781Z", "completed_at": "2024-05-11T05:43:26.990785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5401787757873535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__email_campaigns", "compiled": true, "compiled_code": "\n\n\nwith campaigns as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__email_campaign\"\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        email_campaign_id,\n        \n        sum(email_sends.bounces) as total_bounces,\n        count(distinct case when email_sends.bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(email_sends.clicks) as total_clicks,\n        count(distinct case when email_sends.clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(email_sends.deferrals) as total_deferrals,\n        count(distinct case when email_sends.deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(email_sends.deliveries) as total_deliveries,\n        count(distinct case when email_sends.deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(email_sends.drops) as total_drops,\n        count(distinct case when email_sends.drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(email_sends.forwards) as total_forwards,\n        count(distinct case when email_sends.forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(email_sends.opens) as total_opens,\n        count(distinct case when email_sends.opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(email_sends.prints) as total_prints,\n        count(distinct case when email_sends.prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(email_sends.spam_reports) as total_spam_reports,\n        count(distinct case when email_sends.spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(email_sends.unsubscribes) as total_unsubscribes,\n        count(distinct case when email_sends.unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), joined as (\n\n    select \n        campaigns.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from campaigns\n    left join email_metrics\n        on campaigns.email_campaign_id = email_metrics.email_campaign_id\n\n)\n\nselect *\nfrom joined", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_campaigns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.587504Z", "completed_at": "2024-05-11T05:43:26.990479Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:26.991541Z", "completed_at": "2024-05-11T05:43:26.991545Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.550318956375122, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contacts", "compiled": true, "compiled_code": "\n\n\n\nwith  __dbt__cte__int_hubspot__engagement_metrics__by_contact as (\n\n\nwith engagements as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagements\"\n\n), engagement_contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__engagement_contact\"\n\n), engagement_contacts_joined as (\n\n    select\n        engagements.engagement_type,\n        engagement_contacts.contact_id\n    from engagements\n    inner join engagement_contacts\n        using (engagement_id)\n\n), engagement_contacts_agg as (\n\n    \n\n    select\n        contact_id,\n        count(case when engagement_type = 'NOTE' then contact_id end) as count_engagement_notes,\n        count(case when engagement_type = 'TASK' then contact_id end) as count_engagement_tasks,\n        count(case when engagement_type = 'CALL' then contact_id end) as count_engagement_calls,\n        count(case when engagement_type = 'MEETING' then contact_id end) as count_engagement_meetings,\n        count(case when engagement_type = 'EMAIL' then contact_id end) as count_engagement_emails,\n        count(case when engagement_type = 'INCOMING_EMAIL' then contact_id end) as count_engagement_incoming_emails,\n        count(case when engagement_type = 'FORWARDED_EMAIL' then contact_id end) as count_engagement_forwarded_emails\n    from engagement_contacts_joined\n    group by 1\n\n\n\n)\n\nselect *\nfrom engagement_contacts_agg\n), contacts as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__contact_merge_adjust\" \n\n\n), email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_sends\"\n\n), email_metrics as (\n    \n    select \n        recipient_email_address,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from email_sends\n    group by 1\n\n), email_joined as (\n\n    select \n        contacts.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contacts\n    left join email_metrics\n        on contacts.email = email_metrics.recipient_email_address\n\n\n\n\n\n\n\n), engagements as (\n\n    select *\n    from __dbt__cte__int_hubspot__engagement_metrics__by_contact\n\n), engagements_joined as (\n\n    select \n        email_joined.*,\n        \n        coalesce(engagements.count_engagement_notes,0) as count_engagement_notes ,\n        \n        coalesce(engagements.count_engagement_tasks,0) as count_engagement_tasks ,\n        \n        coalesce(engagements.count_engagement_calls,0) as count_engagement_calls ,\n        \n        coalesce(engagements.count_engagement_meetings,0) as count_engagement_meetings ,\n        \n        coalesce(engagements.count_engagement_emails,0) as count_engagement_emails ,\n        \n        coalesce(engagements.count_engagement_incoming_emails,0) as count_engagement_incoming_emails ,\n        \n        coalesce(engagements.count_engagement_forwarded_emails,0) as count_engagement_forwarded_emails \n        \n    from email_joined\n    left join engagements\n        using (contact_id)\n\n)\n\nselect *\nfrom engagements_joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contacts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:25.462627Z", "completed_at": "2024-05-11T05:43:26.976545Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:26.989234Z", "completed_at": "2024-05-11T05:43:26.989246Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6791110038757324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__ticket_calendar_spine", "compiled": true, "compiled_code": "\n\nwith calendar as (\n\n    \n    \n    \n    \n    \n\n    select * \n    from (\n        \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1493\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2020-04-16' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= \n\n    \n    (current_timestamp at time zone 'utc')::timestamp\n + ((interval '1 week') * (1))\n\n\n\n)\n\nselect * from filtered\n\n \n    ) as date_spine\n\n    \n    where date_day >= (select min(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__ticket_calendar_spine\" )\n    \n\n), ticket as (\n\n    select \n        *,\n        cast( date_trunc('day', case when closed_date is null then \n    current_timestamp::timestamp\n else closed_date end) as date) as open_until\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket\"\n    where not coalesce(is_ticket_deleted, false)\n\n), joined as (\n\n    select \n        cast(calendar.date_day as date) as date_day,\n        ticket.ticket_id\n    from calendar \n    inner join ticket\n        on cast(calendar.date_day as date) >= cast(ticket.created_date as date)\n        -- use this variable to extend the ticket's history past its close date (for reporting/data viz purposes :-)\n        and cast(calendar.date_day as date) <= \n\n    ticket.open_until + ((interval '1 day') * (0))\n\n\n\n), surrogate as (\n\n    select\n        *,\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id\n    from joined\n\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__ticket_calendar_spine\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.146855Z", "completed_at": "2024-05-11T05:43:27.159634Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:27.160503Z", "completed_at": "2024-05-11T05:43:27.160510Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021176815032958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_sends_event_id.b01306228f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_sends\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.142280Z", "completed_at": "2024-05-11T05:43:27.160199Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:27.161614Z", "completed_at": "2024-05-11T05:43:27.161618Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023014307022094727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_sends_event_id.9fc8a8bef3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_sends\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.164220Z", "completed_at": "2024-05-11T05:43:27.170836Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:27.171411Z", "completed_at": "2024-05-11T05:43:27.171416Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009359121322631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__engagement_tasks_engagement_id.67738794ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect engagement_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_tasks\"\nwhere engagement_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.167800Z", "completed_at": "2024-05-11T05:43:27.171689Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:27.173011Z", "completed_at": "2024-05-11T05:43:27.173016Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010131120681762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__engagement_tasks_engagement_id.754d36b939", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    engagement_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__engagement_tasks\"\nwhere engagement_id is not null\ngroup by engagement_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.174824Z", "completed_at": "2024-05-11T05:43:27.181429Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:27.181986Z", "completed_at": "2024-05-11T05:43:27.181992Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009146928787231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contacts_contact_id.e28e88dce3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contacts\"\nwhere contact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.178529Z", "completed_at": "2024-05-11T05:43:27.182765Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:27.184006Z", "completed_at": "2024-05-11T05:43:27.184010Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006850004196166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__email_campaigns_email_campaign_id.6b2d6f43c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email_campaign_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.185173Z", "completed_at": "2024-05-11T05:43:27.193781Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:27.194388Z", "completed_at": "2024-05-11T05:43:27.194398Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011212825775146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contacts_contact_id.8f627121df", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contacts\" where not coalesce(is_contact_deleted, false)) dbt_subquery\nwhere contact_id is not null\ngroup by contact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.190851Z", "completed_at": "2024-05-11T05:43:27.195117Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:27.195639Z", "completed_at": "2024-05-11T05:43:27.195642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005988121032714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__email_campaigns_email_campaign_id.2470fabe62", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email_campaign_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_campaigns\"\nwhere email_campaign_id is not null\ngroup by email_campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:26.805824Z", "completed_at": "2024-05-11T05:43:28.036296Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:28.037248Z", "completed_at": "2024-05-11T05:43:28.037287Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3777449131011963, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__email_metrics__by_contact_list", "compiled": true, "compiled_code": "\n\nwith email_sends as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__email_sends\"\n\n), contact_list_member as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list_member\"\n\n), joined as (\n\n    select\n        email_sends.*,\n        contact_list_member.contact_list_id\n    from email_sends\n    left join contact_list_member\n        using (contact_id)\n    where contact_list_member.contact_list_id is not null\n\n), email_metrics as (\n    \n    select \n        contact_list_id,\n        \n        sum(bounces) as total_bounces,\n        count(distinct case when bounces > 0 then email_send_id end) as total_unique_bounces\n        ,\n        \n        sum(clicks) as total_clicks,\n        count(distinct case when clicks > 0 then email_send_id end) as total_unique_clicks\n        ,\n        \n        sum(deferrals) as total_deferrals,\n        count(distinct case when deferrals > 0 then email_send_id end) as total_unique_deferrals\n        ,\n        \n        sum(deliveries) as total_deliveries,\n        count(distinct case when deliveries > 0 then email_send_id end) as total_unique_deliveries\n        ,\n        \n        sum(drops) as total_drops,\n        count(distinct case when drops > 0 then email_send_id end) as total_unique_drops\n        ,\n        \n        sum(forwards) as total_forwards,\n        count(distinct case when forwards > 0 then email_send_id end) as total_unique_forwards\n        ,\n        \n        sum(opens) as total_opens,\n        count(distinct case when opens > 0 then email_send_id end) as total_unique_opens\n        ,\n        \n        sum(prints) as total_prints,\n        count(distinct case when prints > 0 then email_send_id end) as total_unique_prints\n        ,\n        \n        sum(spam_reports) as total_spam_reports,\n        count(distinct case when spam_reports > 0 then email_send_id end) as total_unique_spam_reports\n        ,\n        \n        sum(unsubscribes) as total_unsubscribes,\n        count(distinct case when unsubscribes > 0 then email_send_id end) as total_unique_unsubscribes\n        \n        \n    from joined\n    group by 1\n\n)\n\nselect *\nfrom email_metrics", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__email_metrics__by_contact_list\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:28.194760Z", "completed_at": "2024-05-11T05:43:28.204101Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:28.205291Z", "completed_at": "2024-05-11T05:43:28.205298Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020975828170776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_int_hubspot__email_metrics__by_contact_list_contact_list_id.1d3cf4caf2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:28.198497Z", "completed_at": "2024-05-11T05:43:28.204492Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:28.205584Z", "completed_at": "2024-05-11T05:43:28.205588Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021147966384887695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_int_hubspot__email_metrics__by_contact_list_contact_list_id.095d72d5b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:27.150748Z", "completed_at": "2024-05-11T05:43:28.541460Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:28.542029Z", "completed_at": "2024-05-11T05:43:28.542046Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4983360767364502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.int_hubspot__scd_daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__pivot_daily_ticket_history\"\n\n), set_values as (\n\n    select \n        date_day, \n        ticket_id,\n        id\n\n         \n        , hs_pipeline as hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_field_partition\n\n         \n        , hs_pipeline_stage as hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum( case when hs_pipeline_stage is null then 0 else 1 end) over (partition by ticket_id \n            order by date_day rows unbounded preceding) as hs_pipeline_stage_field_partition\n\n        \n    \n    from change_data\n\n), fill_values as (\n\n-- each row of the pivoted table includes ticket property values if that property was updated on that day\n-- we need to backfill to persist values that have been previously updated and are still valid \n    select \n        date_day, \n        ticket_id,\n        id\n        \n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n\n         \n\n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_field_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n\n        \n\n    from set_values\n\n)\n\nselect *\nfrom fill_values", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__scd_daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:28.186693Z", "completed_at": "2024-05-11T05:43:29.548524Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:29.549029Z", "completed_at": "2024-05-11T05:43:29.549036Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5088422298431396, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__contact_lists", "compiled": true, "compiled_code": "\n\nwith contact_lists as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__contact_list\"\n\n\n\n), email_metrics as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__email_metrics__by_contact_list\"\n\n), joined as (\n    \n    select \n        contact_lists.*,\n        \n        coalesce(email_metrics.total_bounces, 0) as total_bounces,\n        coalesce(email_metrics.total_unique_bounces, 0) as total_unique_bounces\n        ,\n        \n        coalesce(email_metrics.total_clicks, 0) as total_clicks,\n        coalesce(email_metrics.total_unique_clicks, 0) as total_unique_clicks\n        ,\n        \n        coalesce(email_metrics.total_deferrals, 0) as total_deferrals,\n        coalesce(email_metrics.total_unique_deferrals, 0) as total_unique_deferrals\n        ,\n        \n        coalesce(email_metrics.total_deliveries, 0) as total_deliveries,\n        coalesce(email_metrics.total_unique_deliveries, 0) as total_unique_deliveries\n        ,\n        \n        coalesce(email_metrics.total_drops, 0) as total_drops,\n        coalesce(email_metrics.total_unique_drops, 0) as total_unique_drops\n        ,\n        \n        coalesce(email_metrics.total_forwards, 0) as total_forwards,\n        coalesce(email_metrics.total_unique_forwards, 0) as total_unique_forwards\n        ,\n        \n        coalesce(email_metrics.total_opens, 0) as total_opens,\n        coalesce(email_metrics.total_unique_opens, 0) as total_unique_opens\n        ,\n        \n        coalesce(email_metrics.total_prints, 0) as total_prints,\n        coalesce(email_metrics.total_unique_prints, 0) as total_unique_prints\n        ,\n        \n        coalesce(email_metrics.total_spam_reports, 0) as total_spam_reports,\n        coalesce(email_metrics.total_unique_spam_reports, 0) as total_unique_spam_reports\n        ,\n        \n        coalesce(email_metrics.total_unsubscribes, 0) as total_unsubscribes,\n        coalesce(email_metrics.total_unique_unsubscribes, 0) as total_unique_unsubscribes\n        \n        \n    from contact_lists\n    left join email_metrics\n        using (contact_list_id)\n\n)\n\nselect *\nfrom joined\n\n", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contact_lists\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:29.696890Z", "completed_at": "2024-05-11T05:43:29.703478Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:29.703928Z", "completed_at": "2024-05-11T05:43:29.703934Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00863790512084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__contact_lists_contact_list_id.3bde1bb891", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contact_list_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contact_lists\"\nwhere contact_list_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:29.700625Z", "completed_at": "2024-05-11T05:43:29.704684Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:29.705177Z", "completed_at": "2024-05-11T05:43:29.705180Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009447813034057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__contact_lists_contact_list_id.ea9ef03bac", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    contact_list_id as unique_field,\n    count(*) as n_records\n\nfrom (select * from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__contact_lists\" where not coalesce(is_contact_list_deleted, false)) dbt_subquery\nwhere contact_list_id is not null\ngroup by contact_list_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:28.642683Z", "completed_at": "2024-05-11T05:43:29.968045Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:29.968648Z", "completed_at": "2024-05-11T05:43:29.968655Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.441274881362915, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.hubspot.hubspot__daily_ticket_history", "compiled": true, "compiled_code": "with change_data as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__scd_daily_ticket_history\"\n\n\n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__daily_ticket_history\")\n\n-- If no issue fields have been updated since the last incremental run, the pivoted_daily_history CTE will return no record/rows.\n-- When this is the case, we need to grab the most recent day's records from the previously built table so that we can persist \n-- those values into the future.\n\n), most_recent_data as ( \n\n    select \n        *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__daily_ticket_history\"\n    where date_day = (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__daily_ticket_history\" )\n\n\n), calendar as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"int_hubspot__ticket_calendar_spine\"\n\n    \n    where date_day >= (select max(date_day) from \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__daily_ticket_history\")\n    \n\n), pipeline as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline\"\n\n), pipeline_stage as (\n\n    select *\n    from \"postgres\".\"hubspot_integration_tests_57_stg_hubspot\".\"stg_hubspot__ticket_pipeline_stage\"\n\n), joined as (\n\n    select \n        calendar.date_day,\n        calendar.ticket_id\n            \n             \n            , coalesce(change_data.hs_pipeline, most_recent_data.hs_pipeline) as hs_pipeline\n             \n            , coalesce(change_data.hs_pipeline_stage, most_recent_data.hs_pipeline_stage) as hs_pipeline_stage\n            \n        \n        \n\n    from calendar\n    left join change_data\n        on calendar.ticket_id = change_data.ticket_id\n        and calendar.date_day = change_data.date_day\n    \n    \n    left join most_recent_data\n        on calendar.ticket_id = most_recent_data.ticket_id\n        and calendar.date_day = most_recent_data.date_day\n    \n\n), set_values as (\n\n    select \n        date_day,\n        ticket_id\n        \n        \n        , hs_pipeline\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_partition\n        \n        , hs_pipeline_stage\n        -- create a batch/partition once a new value is provided\n        , sum(case when joined.hs_pipeline_stage is null then 0 else 1 end) over (\n                partition by ticket_id\n                order by date_day rows unbounded preceding) as hs_pipeline_stage_partition\n        \n\n    from joined\n\n), fill_values as (\n\n    select \n        date_day,\n        ticket_id\n\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline ) over (\n            partition by ticket_id, hs_pipeline_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline\n        \n        -- grab the value that started this batch/partition\n        , first_value( hs_pipeline_stage ) over (\n            partition by ticket_id, hs_pipeline_stage_partition \n            order by date_day asc rows between unbounded preceding and current row) as hs_pipeline_stage\n        \n\n    from set_values\n\n), fix_null_values as (\n\n    select \n        date_day,\n        ticket_id,\n        pipeline_stage.ticket_state,\n        pipeline.pipeline_label as hs_pipeline_label,\n        pipeline_stage.pipeline_stage_label as hs_pipeline_stage_label\n\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline as TEXT ) = 'is_null' then null else hs_pipeline end as hs_pipeline\n         \n        -- we de-nulled the true null values earlier in order to differentiate them from nulls that just needed to be backfilled\n        , case when  cast( hs_pipeline_stage as TEXT ) = 'is_null' then null else hs_pipeline_stage end as hs_pipeline_stage\n        \n\n    from fill_values\n\n    left join pipeline \n        on cast(fill_values.hs_pipeline as integer) = pipeline.ticket_pipeline_id\n    left join pipeline_stage \n        on cast(fill_values.hs_pipeline_stage as integer) = pipeline_stage.ticket_pipeline_stage_id\n        and pipeline.ticket_pipeline_id = pipeline_stage.ticket_pipeline_id\n\n), surrogate as (\n\n    select\n        md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(ticket_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as ticket_day_id,\n        *\n\n    from fix_null_values\n)\n\nselect *\nfrom surrogate", "relation_name": "\"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__daily_ticket_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:30.084484Z", "completed_at": "2024-05-11T05:43:30.090836Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:30.091543Z", "completed_at": "2024-05-11T05:43:30.091549Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008874893188476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.not_null_hubspot__daily_ticket_history_ticket_day_id.087496580e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_day_id\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-11T05:43:30.087932Z", "completed_at": "2024-05-11T05:43:30.091324Z"}, {"name": "execute", "started_at": "2024-05-11T05:43:30.092420Z", "completed_at": "2024-05-11T05:43:30.092423Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008807897567749023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.hubspot.unique_hubspot__daily_ticket_history_ticket_day_id.294440dc9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_day_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"hubspot_integration_tests_57_hubspot\".\"hubspot__daily_ticket_history\"\nwhere ticket_day_id is not null\ngroup by ticket_day_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 49.676149129867554, "args": {"version_check": true, "select": [], "static_parser": true, "empty_catalog": false, "indirect_selection": "eager", "exclude": [], "invocation_command": "dbt docs generate -t postgres", "printer_width": 80, "which": "generate", "partial_parse": true, "log_level": "info", "log_level_file": "debug", "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests/logs", "defer": false, "target": "postgres", "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": false, "show_resource_report": false, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/hubspot/dbt_hubspot/integration_tests", "send_anonymous_usage_stats": true, "compile": true, "partial_parse_file_diff": true, "strict_mode": false, "log_format": "default", "vars": {}, "profiles_dir": "/Users/avinash.kunnath/.dbt", "use_colors_file": true, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "populate_cache": true, "quiet": false, "favor_state": false, "write_json": true, "warn_error_options": {"include": [], "exclude": []}, "static": false, "macro_debugging": false, "introspect": true, "log_format_file": "debug", "print": true, "use_colors": true}}